!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(require("@firebase/app")):"function"==typeof define&&define.amd?define(["@firebase/app"],e):e((t=t||self).firebase)}(this,function(Nf){"use strict";try{(function(){Nf=Nf&&Object.prototype.hasOwnProperty.call(Nf,"default")?Nf.default:Nf;var t,u,e,i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};function n(t,e){function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}function c(t,s,u,a){return new(u=u||Promise)(function(n,e){function i(t){try{o(a.next(t))}catch(t){e(t)}}function r(t){try{o(a.throw(t))}catch(t){e(t)}}function o(t){var e;t.done?n(t.value):((e=t.value)instanceof u?e:new u(function(t){t(e)})).then(i,r)}o((a=a.apply(t,s||[])).next())})}function f(n,i){var r,o,s,t,u={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return t={next:e(0),throw:e(1),return:e(2)},"function"==typeof Symbol&&(t[Symbol.iterator]=function(){return this}),t;function e(e){return function(t){return function(e){if(r)throw new TypeError("Generator is already executing.");for(;u;)try{if(r=1,o&&(s=2&e[0]?o.return:e[0]?o.throw||((s=o.return)&&s.call(o),0):o.next)&&!(s=s.call(o,e[1])).done)return s;switch(o=0,s&&(e=[2&e[0],s.value]),e[0]){case 0:case 1:s=e;break;case 4:return u.label++,{value:e[1],done:!1};case 5:u.label++,o=e[1],e=[0];continue;case 7:e=u.ops.pop(),u.trys.pop();continue;default:if(!(s=0<(s=u.trys).length&&s[s.length-1])&&(6===e[0]||2===e[0])){u=0;continue}if(3===e[0]&&(!s||e[1]>s[0]&&e[1]<s[3])){u.label=e[1];break}if(6===e[0]&&u.label<s[1]){u.label=s[1],s=e;break}if(s&&u.label<s[2]){u.label=s[2],u.ops.push(e);break}s[2]&&u.ops.pop(),u.trys.pop();continue}e=i.call(n,u)}catch(t){e=[6,t],o=0}finally{r=s=0}if(5&e[0])throw e[1];return{value:e[0]?e[1]:void 0,done:!0}}([e,t])}}}function r(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var i=Array(t),r=0;for(e=0;e<n;e++)for(var o=arguments[e],s=0,u=o.length;s<u;s++,r++)i[r]=o[s];return i}function s(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var i=Array(t),r=0;for(e=0;e<n;e++)for(var o=arguments[e],s=0,u=o.length;s<u;s++,r++)i[r]=o[s];return i}(e=u=u||{})[e.DEBUG=0]="DEBUG",e[e.VERBOSE=1]="VERBOSE",e[e.INFO=2]="INFO",e[e.WARN=3]="WARN",e[e.ERROR=4]="ERROR",e[e.SILENT=5]="SILENT";u.DEBUG,u.VERBOSE,u.INFO,u.WARN,u.ERROR,u.SILENT;function o(t,e){for(var n=[],i=2;i<arguments.length;i++)n[i-2]=arguments[i];if(!(e<t.logLevel)){var r=(new Date).toISOString(),o=h[e];if(!o)throw new Error("Attempted to log a message with an invalid logType (value: "+e+")");console[o].apply(console,s(["["+r+"]  "+t.name+":"],n))}}var a=u.INFO,h=((t={})[u.DEBUG]="log",t[u.VERBOSE]="log",t[u.INFO]="info",t[u.WARN]="warn",t[u.ERROR]="error",t),l=(Object.defineProperty(p.prototype,"logLevel",{get:function(){return this._logLevel},set:function(t){if(!(t in u))throw new TypeError("Invalid value assigned to `logLevel`");this._logLevel=t},enumerable:!0,configurable:!0}),Object.defineProperty(p.prototype,"logHandler",{get:function(){return this._logHandler},set:function(t){if("function"!=typeof t)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t},enumerable:!0,configurable:!0}),Object.defineProperty(p.prototype,"userLogHandler",{get:function(){return this._userLogHandler},set:function(t){this._userLogHandler=t},enumerable:!0,configurable:!0}),p.prototype.debug=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,u.DEBUG],t)),this._logHandler.apply(this,s([this,u.DEBUG],t))},p.prototype.log=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,u.VERBOSE],t)),this._logHandler.apply(this,s([this,u.VERBOSE],t))},p.prototype.info=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,u.INFO],t)),this._logHandler.apply(this,s([this,u.INFO],t))},p.prototype.warn=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,u.WARN],t)),this._logHandler.apply(this,s([this,u.WARN],t))},p.prototype.error=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,u.ERROR],t)),this._logHandler.apply(this,s([this,u.ERROR],t))},p);function p(t){this.name=t,this._logLevel=a,this._logHandler=o,this._userLogHandler=null}function d(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""}var y,v=(n(g,y=Error),g);function g(t,e){var n=y.call(this,e)||this;return n.code=t,n.name="FirebaseError",Object.setPrototypeOf(n,g.prototype),Error.captureStackTrace&&Error.captureStackTrace(n,m.prototype.create),n}var m=(w.prototype.create=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];for(var i,r=e[0]||{},o=this.service+"/"+t,s=this.errors[t],u=s?(i=r,s.replace(b,function(t,e){var n=i[e];return null!=n?n.toString():"<"+e+"?>"})):"Error",a=this.serviceName+": "+u+" ("+o+").",h=new v(o,a),c=0,f=Object.keys(r);c<f.length;c++){var l=f[c];"_"!==l.slice(-1)&&(l in h&&console.warn('Overwriting FirebaseError base field "'+l+'" can cause unexpected behavior.'),h[l]=r[l])}return h},w);function w(t,e,n){this.service=t,this.serviceName=e,this.errors=n}var b=/\{\$([^}]+)}/g,E=(A.prototype.setInstantiationMode=function(t){return this.instantiationMode=t,this},A.prototype.setMultipleInstances=function(t){return this.multipleInstances=t,this},A.prototype.setServiceProps=function(t){return this.serviceProps=t,this},A);function A(t,e,n){this.name=t,this.instanceFactory=e,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY"}var I,N="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},T=T||{},_=N;function S(t){return"string"==typeof t}function R(t){return"number"==typeof t}function k(t,e){t=t.split("."),e=e||_;for(var n=0;n<t.length;n++)if(null==(e=e[t[n]]))return null;return e}function O(){}function L(t){var e=typeof t;if("object"==e){if(!t)return"null";if(t instanceof Array)return"array";if(t instanceof Object)return e;var n=Object.prototype.toString.call(t);if("[object Window]"==n)return"object";if("[object Array]"==n||"number"==typeof t.length&&void 0!==t.splice&&void 0!==t.propertyIsEnumerable&&!t.propertyIsEnumerable("splice"))return"array";if("[object Function]"==n||void 0!==t.call&&void 0!==t.propertyIsEnumerable&&!t.propertyIsEnumerable("call"))return"function"}else if("function"==e&&void 0===t.call)return"object";return e}function D(t){return"array"==L(t)}function V(t){var e=L(t);return"array"==e||"object"==e&&"number"==typeof t.length}function C(t){var e=typeof t;return"object"==e&&null!=t||"function"==e}var P="closure_uid_"+(1e9*Math.random()>>>0),U=0;function M(t,e,n){return t.call.apply(t.bind,arguments)}function x(e,n,t){if(!e)throw Error();if(2<arguments.length){var i=Array.prototype.slice.call(arguments,2);return function(){var t=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(t,i),e.apply(n,t)}}return function(){return e.apply(n,arguments)}}function F(t,e,n){return(F=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?M:x).apply(null,arguments)}function q(e,t){var n=Array.prototype.slice.call(arguments,1);return function(){var t=n.slice();return t.push.apply(t,arguments),e.apply(this,t)}}var G=Date.now||function(){return+new Date};function j(t,o){function e(){}e.prototype=o.prototype,t.N=o.prototype,t.prototype=new e,(t.prototype.constructor=t).yb=function(t,e,n){for(var i=Array(arguments.length-2),r=2;r<arguments.length;r++)i[r-2]=arguments[r];return o.prototype[e].apply(t,i)}}function B(){this.j=this.j,this.i=this.i}B.prototype.j=!1,B.prototype.la=function(){if(!this.j&&(this.j=!0,this.G(),0))this[P]||(this[P]=++U)},B.prototype.G=function(){if(this.i)for(;this.i.length;)this.i.shift()()};var z=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if(S(t))return S(e)&&1==e.length?t.indexOf(e,0):-1;for(var n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1},H=Array.prototype.forEach?function(t,e,n){Array.prototype.forEach.call(t,e,n)}:function(t,e,n){for(var i=t.length,r=S(t)?t.split(""):t,o=0;o<i;o++)o in r&&e.call(n,r[o],o,t)};function Y(t){return Array.prototype.concat.apply([],arguments)}function Q(t){var e=t.length;if(0<e){for(var n=Array(e),i=0;i<e;i++)n[i]=t[i];return n}return[]}function W(t){return/^[\s\xa0]*$/.test(t)}var X,K=String.prototype.trim?function(t){return t.trim()}:function(t){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(t)[1]};function $(t,e){return-1!=t.indexOf(e)}function Z(t,e){return t<e?-1:e<t?1:0}t:{var J=_.navigator;if(J){var tt=J.userAgent;if(tt){X=tt;break t}}X=""}function et(t,e,n){for(var i in t)e.call(n,t[i],i,t)}function nt(t){var e,n={};for(e in t)n[e]=t[e];return n}var it="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function rt(t,e){for(var n,i,r=1;r<arguments.length;r++){for(n in i=arguments[r])t[n]=i[n];for(var o=0;o<it.length;o++)n=it[o],Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}}function ot(t){return ot[" "](t),t}ot[" "]=O;var st,ut,at=$(X,"Opera"),ht=$(X,"Trident")||$(X,"MSIE"),ct=$(X,"Edge"),ft=ct||ht,lt=$(X,"Gecko")&&!($(X.toLowerCase(),"webkit")&&!$(X,"Edge"))&&!($(X,"Trident")||$(X,"MSIE"))&&!$(X,"Edge"),pt=$(X.toLowerCase(),"webkit")&&!$(X,"Edge");function dt(){var t=_.document;return t?t.documentMode:void 0}t:{var yt="",vt=(ut=X,lt?/rv:([^\);]+)(\)|;)/.exec(ut):ct?/Edge\/([\d\.]+)/.exec(ut):ht?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(ut):pt?/WebKit\/(\S+)/.exec(ut):at?/(?:Version)[ \/]?(\S+)/.exec(ut):void 0);if(vt&&(yt=vt?vt[1]:""),ht){var gt=dt();if(null!=gt&&gt>parseFloat(yt)){st=String(gt);break t}}st=yt}var mt,wt={};function bt(u){return t=u,e=function(){for(var t=0,e=K(String(st)).split("."),n=K(String(u)).split("."),i=Math.max(e.length,n.length),r=0;0==t&&r<i;r++){var o=e[r]||"",s=n[r]||"";do{if(o=/(\d*)(\D*)(.*)/.exec(o)||["","","",""],s=/(\d*)(\D*)(.*)/.exec(s)||["","","",""],0==o[0].length&&0==s[0].length)break;t=Z(0==o[1].length?0:parseInt(o[1],10),0==s[1].length?0:parseInt(s[1],10))||Z(0==o[2].length,0==s[2].length)||Z(o[2],s[2]),o=o[3],s=s[3]}while(0==t)}return 0<=t},n=wt,Object.prototype.hasOwnProperty.call(n,t)?n[t]:n[t]=e(t);var t,e,n}var Et=_.document;mt=Et&&ht?dt()||("CSS1Compat"==Et.compatMode?parseInt(st,10):5):void 0;var At=!ht||9<=Number(mt),It=ht&&!bt("9"),Nt=function(){if(!_.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{_.addEventListener("test",O,e),_.removeEventListener("test",O,e)}catch(t){}return t}();function Tt(t,e){this.type=t,this.a=this.target=e,this.Ia=!0}function _t(t,e){if(Tt.call(this,t?t.type:""),this.relatedTarget=this.a=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.pointerId=0,this.pointerType="",this.c=null,t){var n=this.type=t.type,i=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.a=e,e=t.relatedTarget){if(lt){t:{try{ot(e.nodeName);var r=!0;break t}catch(t){}r=!1}r||(e=null)}}else"mouseover"==n?e=t.fromElement:"mouseout"==n&&(e=t.toElement);this.relatedTarget=e,i?(this.clientX=void 0!==i.clientX?i.clientX:i.pageX,this.clientY=void 0!==i.clientY?i.clientY:i.pageY,this.screenX=i.screenX||0,this.screenY=i.screenY||0):(this.clientX=void 0!==t.clientX?t.clientX:t.pageX,this.clientY=void 0!==t.clientY?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType=S(t.pointerType)?t.pointerType:St[t.pointerType]||"",(this.c=t).defaultPrevented&&this.b()}}Tt.prototype.b=function(){this.Ia=!1},j(_t,Tt);var St={2:"touch",3:"pen",4:"mouse"};_t.prototype.b=function(){_t.N.b.call(this);var t=this.c;if(t.preventDefault)t.preventDefault();else if(t.returnValue=!1,It)try{(t.ctrlKey||112<=t.keyCode&&t.keyCode<=123)&&(t.keyCode=-1)}catch(t){}};var Rt="closure_listenable_"+(1e6*Math.random()|0),kt=0;function Ot(t,e,n,i,r){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!i,this.da=r,this.key=++kt,this.X=this.Z=!1}function Lt(t){t.X=!0,t.listener=null,t.proxy=null,t.src=null,t.da=null}function Dt(t){this.src=t,this.a={},this.b=0}function Vt(t,e){var n=e.type;if(n in t.a){var i,r=t.a[n],o=z(r,e);(i=0<=o)&&Array.prototype.splice.call(r,o,1),i&&(Lt(e),0==t.a[n].length&&(delete t.a[n],t.b--))}}function Ct(t,e,n,i){for(var r=0;r<t.length;++r){var o=t[r];if(!o.X&&o.listener==e&&o.capture==!!n&&o.da==i)return r}return-1}Dt.prototype.add=function(t,e,n,i,r){var o=t.toString();(t=this.a[o])||(t=this.a[o]=[],this.b++);var s=Ct(t,e,i,r);return-1<s?(e=t[s],n||(e.Z=!1)):((e=new Ot(e,this.src,o,!!i,r)).Z=n,t.push(e)),e};var Pt="closure_lm_"+(1e6*Math.random()|0),Ut={};function Mt(t,e,n,i,r){if(i&&i.once)return function t(e,n,i,r,o){if(D(n)){for(var s=0;s<n.length;s++)t(e,n[s],i,r,o);return null}i=Ht(i);return e&&e[Rt]?e.Aa(n,i,C(r)?!!r.capture:!!r,o):xt(e,n,i,!0,r,o)}(t,e,n,i,r);if(D(e)){for(var o=0;o<e.length;o++)Mt(t,e[o],n,i,r);return null}return n=Ht(n),t&&t[Rt]?t.za(e,n,C(i)?!!i.capture:!!i,r):xt(t,e,n,!1,i,r)}function xt(t,e,n,i,r,o){if(!e)throw Error("Invalid event type");var s=C(r)?!!r.capture:!!r;if(s&&!At)return null;var u,a,h=Bt(t);if(h||(t[Pt]=h=new Dt(t)),(n=h.add(e,n,i,s,o)).proxy)return n;if(u=jt,i=a=At?function(t){return u.call(a.src,a.listener,t)}:function(t){if(!(t=u.call(a.src,a.listener,t)))return t},(n.proxy=i).src=t,i.listener=n,t.addEventListener)Nt||(r=s),void 0===r&&(r=!1),t.addEventListener(e.toString(),i,r);else if(t.attachEvent)t.attachEvent(qt(e.toString()),i);else{if(!t.addListener||!t.removeListener)throw Error("addEventListener and attachEvent are unavailable.");t.addListener(i)}return n}function Ft(t){if(!R(t)&&t&&!t.X){var e=t.src;if(e&&e[Rt])Vt(e.c,t);else{var n=t.type,i=t.proxy;e.removeEventListener?e.removeEventListener(n,i,t.capture):e.detachEvent?e.detachEvent(qt(n),i):e.addListener&&e.removeListener&&e.removeListener(i),(n=Bt(e))?(Vt(n,t),0==n.b&&(n.src=null,e[Pt]=null)):Lt(t)}}}function qt(t){return t in Ut?Ut[t]:Ut[t]="on"+t}function Gt(t,e){var n=t.listener,i=t.da||t.src;return t.Z&&Ft(t),n.call(i,e)}function jt(t,e){return!!t.X||(At?Gt(t,new _t(e,this)):Gt(t,e=new _t(e||k("window.event"),this)))}function Bt(t){return(t=t[Pt])instanceof Dt?t:null}var zt="__closure_events_fn_"+(1e9*Math.random()>>>0);function Ht(e){return"function"==L(e)?e:(e[zt]||(e[zt]=function(t){return e.handleEvent(t)}),e[zt])}function Yt(){B.call(this),this.c=new Dt(this),(this.J=this).B=null}function Qt(t,e,n,i){if(!(e=t.c.a[String(e)]))return!0;e=e.concat();for(var r=!0,o=0;o<e.length;++o){var s=e[o];if(s&&!s.X&&s.capture==n){var u=s.listener,a=s.da||s.src;s.Z&&Vt(t.c,s),r=!1!==u.call(a,i)&&r}}return r&&0!=i.Ia}j(Yt,B),Yt.prototype[Rt]=!0,(I=Yt.prototype).addEventListener=function(t,e,n,i){Mt(this,t,e,n,i)},I.removeEventListener=function(t,e,n,i){!function t(e,n,i,r,o){if(D(n))for(var s=0;s<n.length;s++)t(e,n[s],i,r,o);else r=C(r)?!!r.capture:!!r,i=Ht(i),e&&e[Rt]?(e=e.c,(n=String(n).toString())in e.a&&-1<(i=Ct(s=e.a[n],i,r,o))&&(Lt(s[i]),Array.prototype.splice.call(s,i,1),0==s.length&&(delete e.a[n],e.b--))):(e=e&&Bt(e))&&(n=e.a[n.toString()],e=-1,n&&(e=Ct(n,i,r,o)),(i=-1<e?n[e]:null)&&Ft(i))}(this,t,e,n,i)},I.dispatchEvent=function(t){var e,n=this.B;if(n)for(e=[];n;n=n.B)e.push(n);n=this.J;var i=t.type||t;if(S(t))t=new Tt(t,n);else if(t instanceof Tt)t.target=t.target||n;else{var r=t;rt(t=new Tt(i,n),r)}if(r=!0,e)for(var o=e.length-1;0<=o;o--){var s=t.a=e[o];r=Qt(s,i,!0,t)&&r}if(r=Qt(s=t.a=n,i,!0,t)&&r,r=Qt(s,i,!1,t)&&r,e)for(o=0;o<e.length;o++)r=Qt(s=t.a=e[o],i,!1,t)&&r;return r},I.G=function(){if(Yt.N.G.call(this),this.c){var t,e=this.c;for(t in e.a){for(var n=e.a[t],i=0;i<n.length;i++)Lt(n[i]);delete e.a[t],e.b--}}this.B=null},I.za=function(t,e,n,i){return this.c.add(String(t),e,!1,n,i)},I.Aa=function(t,e,n,i){return this.c.add(String(t),e,!0,n,i)};var Wt=_.JSON.stringify;function Xt(t,e){this.c=t,this.f=e,this.b=0,this.a=null}function Kt(){this.b=this.a=null}Xt.prototype.get=function(){if(0<this.b){this.b--;var t=this.a;this.a=t.next,t.next=null}else t=this.c();return t};var $t,Zt=new Xt(function(){return new Jt},function(t){t.reset()});function Jt(){this.next=this.b=this.a=null}function te(t){_.setTimeout(function(){throw t},0)}function ee(t,e){var n;$t||(n=_.Promise.resolve(void 0),$t=function(){n.then(re)}),ne||($t(),ne=!0),ie.add(t,e)}Kt.prototype.add=function(t,e){var n=Zt.get();n.set(t,e),this.b?this.b.next=n:this.a=n,this.b=n},Jt.prototype.set=function(t,e){this.a=t,this.b=e,this.next=null};var ne=!(Jt.prototype.reset=function(){this.next=this.b=this.a=null}),ie=new Kt;function re(){for(var t;i=n=void 0,i=null,(n=ie).a&&(i=n.a,n.a=n.a.next,n.a||(n.b=null),i.next=null),t=i;){try{t.a.call(t.b)}catch(t){te(t)}var e=Zt;e.f(t),e.b<100&&(e.b++,t.next=e.a,e.a=t)}var n,i;ne=!1}function oe(t,e){Yt.call(this),this.b=t||1,this.a=e||_,this.f=F(this.gb,this),this.g=G()}function se(t){t.ba=!1,t.L&&(t.a.clearTimeout(t.L),t.L=null)}function ue(t,e,n){if("function"==L(t))n&&(t=F(t,n));else{if(!t||"function"!=typeof t.handleEvent)throw Error("Invalid listener argument");t=F(t.handleEvent,t)}return 2147483647<Number(e)?-1:_.setTimeout(t,e||0)}function ae(t,e,n){B.call(this),this.f=null!=n?F(t,n):t,this.c=e,this.b=F(this.$a,this),this.a=[]}function he(t){t.U=ue(t.b,t.c),t.f.apply(null,t.a)}function ce(t){B.call(this),this.b=t,this.a={}}j(oe,Yt),(I=oe.prototype).ba=!1,I.L=null,I.gb=function(){if(this.ba){var t=G()-this.g;0<t&&t<.8*this.b?this.L=this.a.setTimeout(this.f,this.b-t):(this.L&&(this.a.clearTimeout(this.L),this.L=null),this.dispatchEvent("tick"),this.ba&&(se(this),this.start()))}},I.start=function(){this.ba=!0,this.L||(this.L=this.a.setTimeout(this.f,this.b),this.g=G())},I.G=function(){oe.N.G.call(this),se(this),delete this.a},j(ae,B),(I=ae.prototype).ea=!1,I.U=null,I.Ta=function(t){this.a=arguments,this.U?this.ea=!0:he(this)},I.G=function(){ae.N.G.call(this),this.U&&(_.clearTimeout(this.U),this.U=null,this.ea=!1,this.a=[])},I.$a=function(){this.U=null,this.ea&&(this.ea=!1,he(this))},j(ce,B);var fe=[];function le(t,e,n,i){D(n)||(n&&(fe[0]=n.toString()),n=fe);for(var r=0;r<n.length;r++){var o=Mt(e,n[r],i||t.handleEvent,!1,t.b||t);if(!o)break;t.a[o.key]=o}}function pe(t){et(t.a,function(t,e){this.a.hasOwnProperty(e)&&Ft(t)},t),t.a={}}function de(){}ce.prototype.G=function(){ce.N.G.call(this),pe(this)},ce.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var ye=new Yt;function ve(t){Tt.call(this,"serverreachability",t)}function ge(t){ye.dispatchEvent(new ve(ye))}function me(t){Tt.call(this,"statevent",t)}function we(t){ye.dispatchEvent(new me(ye))}function be(t){Tt.call(this,"timingevent",t)}function Ee(t,e){if("function"!=L(t))throw Error("Fn must not be null and must be a function");return _.setTimeout(function(){t()},e)}j(ve,Tt),j(me,Tt),j(be,Tt);var Ae={NO_ERROR:0,hb:1,ob:2,nb:3,kb:4,mb:5,pb:6,La:7,TIMEOUT:8,sb:9},Ie={jb:"complete",wb:"success",Ma:"error",La:"abort",ub:"ready",vb:"readystatechange",TIMEOUT:"timeout",qb:"incrementaldata",tb:"progress",lb:"downloadprogress",xb:"uploadprogress"};function Ne(){}function Te(t){var e;return(e=t.a)||(e=t.a={}),e}function _e(){}Ne.prototype.a=null;var Se,Re={OPEN:"a",ib:"b",Ma:"c",rb:"d"};function ke(){Tt.call(this,"d")}function Oe(){Tt.call(this,"c")}function Le(){}function De(t,e,n){this.g=t,this.W=e,this.V=n||1,this.I=new ce(this),this.O=Ve,t=ft?125:void 0,this.P=new oe(t),this.h=null,this.b=!1,this.l=this.D=this.f=this.F=this.v=this.R=this.i=null,this.j=[],this.a=null,this.A=0,this.c=this.w=null,this.o=-1,this.m=!1,this.J=0,this.B=null,this.s=this.S=this.H=!1}j(ke,Tt),j(Oe,Tt),j(Le,Ne),Se=new Le;var Ve=45e3,Ce={},Pe={};function Ue(t,e,n){t.F=1,t.f=an(tn(e)),t.l=n,t.H=!0,xe(t,null)}function Me(t,e,n,i){t.F=1,t.f=an(tn(e)),t.l=null,t.H=n,xe(t,i)}function xe(t,e){t.v=G(),Ge(t),t.D=tn(t.f),un(t.D,"t",t.V),t.A=0,t.a=t.g.$(t.g.Y()?e:null),0<t.J&&(t.B=new ae(F(t.Ja,t,t.a),t.J)),le(t.I,t.a,"readystatechange",t.cb),e=t.h?nt(t.h):{},t.l?(t.w||(t.w="POST"),e["Content-Type"]="application/x-www-form-urlencoded",t.a.ca(t.D,t.w,t.l,e)):(t.w="GET",t.a.ca(t.D,t.w,null,e)),ge(1)}function Fe(t,e,n){for(var i=!0;!t.m&&t.A<n.length;){var r=qe(t,n);if(r==Pe){4==e&&(t.c=4,we(14),i=!1);break}if(r==Ce){t.c=4,we(15),i=!1;break}Ye(t,r)}4==e&&0==n.length&&(t.c=1,we(16),i=!1),t.b=t.b&&i,i||(He(t),ze(t))}function qe(t,e){var n=t.A,i=e.indexOf("\n",n);return-1==i?Pe:(n=Number(e.substring(n,i)),isNaN(n)?Ce:(i+=1)+n>e.length?Pe:(e=e.substr(i,n),t.A=i+n,e))}function Ge(t){t.R=G()+t.O,je(t,t.O)}function je(t,e){if(null!=t.i)throw Error("WatchDog timer not null");t.i=Ee(F(t.ab,t),e)}function Be(t){t.i&&(_.clearTimeout(t.i),t.i=null)}function ze(t){t.g.Ca()||t.m||t.g.na(t)}function He(t){Be(t);var e=t.B;e&&"function"==typeof e.la&&e.la(),t.B=null,se(t.P),pe(t.I),t.a&&(e=t.a,t.a=null,e.abort(),e.la())}function Ye(t,e){try{t.g.Fa(t,e),ge(4)}catch(t){}}function Qe(t,e){if(t.forEach&&"function"==typeof t.forEach)t.forEach(e,void 0);else if(V(t)||S(t))H(t,e,void 0);else{if(t.K&&"function"==typeof t.K)var n=t.K();else if(t.C&&"function"==typeof t.C)n=void 0;else if(V(t)||S(t)){n=[];for(var i=t.length,r=0;r<i;r++)n.push(r)}else for(r in n=[],i=0,t)n[i++]=r;r=(i=function(t){if(t.C&&"function"==typeof t.C)return t.C();if(S(t))return t.split("");if(V(t)){for(var e=[],n=t.length,i=0;i<n;i++)e.push(t[i]);return e}for(i in e=[],n=0,t)e[n++]=t[i];return e}(t)).length;for(var o=0;o<r;o++)e.call(void 0,i[o],n&&n[o],t)}}function We(t,e){this.b={},this.a=[],this.c=0;var n=arguments.length;if(1<n){if(n%2)throw Error("Uneven number of arguments");for(var i=0;i<n;i+=2)this.set(arguments[i],arguments[i+1])}else if(t)if(t instanceof We)for(n=t.K(),i=0;i<n.length;i++)this.set(n[i],t.get(n[i]));else for(i in t)this.set(i,t[i])}function Xe(t,e){$e(t.b,e)&&(delete t.b[e],t.c--,t.a.length>2*t.c&&Ke(t))}function Ke(t){if(t.c!=t.a.length){for(var e=0,n=0;e<t.a.length;){var i=t.a[e];$e(t.b,i)&&(t.a[n++]=i),e++}t.a.length=n}if(t.c!=t.a.length){var r={};for(n=e=0;e<t.a.length;)$e(r,i=t.a[e])||(r[t.a[n++]=i]=1),e++;t.a.length=n}}function $e(t,e){return Object.prototype.hasOwnProperty.call(t,e)}(I=De.prototype).setTimeout=function(t){this.O=t},I.cb=function(t){t=t.target;var e=this.B;e&&3==ti(t)?e.Ta():this.Ja(t)},I.Ja=function(t){try{if(t==this.a)t:{var e=ti(this.a),n=this.a.ya(),i=this.a.T();if(!(e<3||3==e&&!ft&&!this.a.aa())){this.m||4!=e||7==n||ge(8==n||i<=0?3:2),Be(this);var r=this.a.T();this.o=r;var o=this.a.aa();if(this.b=200==r){if(this.S&&!this.s){e:{if(this.a){var s=ei(this.a,"X-HTTP-Initial-Response");if(s&&!W(s)){var u=s;break e}}u=null}if(!u){this.b=!1,this.c=3,we(12),He(this),ze(this);break t}this.s=!0,Ye(this,u)}this.H?(Fe(this,e,o),ft&&this.b&&3==e&&(le(this.I,this.P,"tick",this.bb),this.P.start())):Ye(this,o),4==e&&He(this),this.b&&!this.m&&(4==e?this.g.na(this):(this.b=!1,Ge(this)))}else 400==r&&0<o.indexOf("Unknown SID")?(this.c=3,we(12)):(this.c=0,we(13)),He(this),ze(this)}}}catch(t){}},I.bb=function(){if(this.a){var t=ti(this.a),e=this.a.aa();this.A<e.length&&(Be(this),Fe(this,t,e),this.b&&4!=t&&Ge(this))}},I.cancel=function(){this.m=!0,He(this)},I.ab=function(){this.i=null;var t=G();0<=t-this.R?(2!=this.F&&(ge(3),we(17)),He(this),this.c=2,ze(this)):je(this,this.R-t)},(I=We.prototype).C=function(){Ke(this);for(var t=[],e=0;e<this.a.length;e++)t.push(this.b[this.a[e]]);return t},I.K=function(){return Ke(this),this.a.concat()},I.get=function(t,e){return $e(this.b,t)?this.b[t]:e},I.set=function(t,e){$e(this.b,t)||(this.c++,this.a.push(t)),this.b[t]=e},I.forEach=function(t,e){for(var n=this.K(),i=0;i<n.length;i++){var r=n[i],o=this.get(r);t.call(e,o,r,this)}};var Ze=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^/?#]*)@)?([^/#?]*?)(?::([0-9]+))?(?=[/#?]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function Je(t,e){var n;this.b=this.j=this.f="",this.i=null,this.g=this.a="",this.h=!1,t instanceof Je?(this.h=void 0!==e?e:t.h,en(this,t.f),this.j=t.j,nn(this,t.b),rn(this,t.i),this.a=t.a,on(this,An(t.c)),this.g=t.g):t&&(n=String(t).match(Ze))?(this.h=!!e,en(this,n[1]||"",!0),this.j=hn(n[2]||""),nn(this,n[3]||"",!0),rn(this,n[4]),this.a=hn(n[5]||"",!0),on(this,n[6]||"",!0),this.g=hn(n[7]||"")):(this.h=!!e,this.c=new gn(null,this.h))}function tn(t){return new Je(t)}function en(t,e,n){t.f=n?hn(e,!0):e,t.f&&(t.f=t.f.replace(/:$/,""))}function nn(t,e,n){t.b=n?hn(e,!0):e}function rn(t,e){if(e){if(e=Number(e),isNaN(e)||e<0)throw Error("Bad port number "+e);t.i=e}else t.i=null}function on(t,e,n){var i,r;e instanceof gn?(t.c=e,i=t.c,(r=t.h)&&!i.f&&(mn(i),i.c=null,i.a.forEach(function(t,e){var n=e.toLowerCase();e!=n&&(wn(this,e),En(this,n,t))},i)),i.f=r):(n||(e=cn(e,yn)),t.c=new gn(e,t.h))}function sn(t,e,n){t.c.set(e,n)}function un(t,e,n){D(n)||(n=[String(n)]),En(t.c,e,n)}function an(t){return sn(t,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^G()).toString(36)),t}function hn(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function cn(t,e,n){return S(t)?(t=encodeURI(t).replace(e,fn),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function fn(t){return"%"+((t=t.charCodeAt(0))>>4&15).toString(16)+(15&t).toString(16)}Je.prototype.toString=function(){var t=[],e=this.f;e&&t.push(cn(e,ln,!0),":");var n=this.b;return!n&&"file"!=e||(t.push("//"),(e=this.j)&&t.push(cn(e,ln,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.i)&&t.push(":",String(n))),(n=this.a)&&(this.b&&"/"!=n.charAt(0)&&t.push("/"),t.push(cn(n,"/"==n.charAt(0)?dn:pn,!0))),(n=this.c.toString())&&t.push("?",n),(n=this.g)&&t.push("#",cn(n,vn)),t.join("")},Je.prototype.resolve=function(t){var e=tn(this),n=!!t.f;n?en(e,t.f):n=!!t.j,n?e.j=t.j:n=!!t.b,n?nn(e,t.b):n=null!=t.i;var i=t.a;if(n)rn(e,t.i);else if(n=!!t.a){if("/"!=i.charAt(0))if(this.b&&!this.a)i="/"+i;else{var r=e.a.lastIndexOf("/");-1!=r&&(i=e.a.substr(0,r+1)+i)}if(".."==(r=i)||"."==r)i="";else if($(r,"./")||$(r,"/.")){i=0==r.lastIndexOf("/",0),r=r.split("/");for(var o=[],s=0;s<r.length;){var u=r[s++];"."==u?i&&s==r.length&&o.push(""):".."==u?((1<o.length||1==o.length&&""!=o[0])&&o.pop(),i&&s==r.length&&o.push("")):(o.push(u),i=!0)}i=o.join("/")}else i=r}return n?e.a=i:n=""!==t.c.toString(),n?on(e,An(t.c)):n=!!t.g,n&&(e.g=t.g),e};var ln=/[#\/\?@]/g,pn=/[#\?:]/g,dn=/[#\?]/g,yn=/[#\?@]/g,vn=/#/g;function gn(t,e){this.b=this.a=null,this.c=t||null,this.f=!!e}function mn(n){n.a||(n.a=new We,n.b=0,n.c&&function(t,e){if(t){t=t.split("&");for(var n=0;n<t.length;n++){var i=t[n].indexOf("="),r=null;if(0<=i){var o=t[n].substring(0,i);r=t[n].substring(i+1)}else o=t[n];e(o,r?decodeURIComponent(r.replace(/\+/g," ")):"")}}}(n.c,function(t,e){n.add(decodeURIComponent(t.replace(/\+/g," ")),e)}))}function wn(t,e){mn(t),e=In(t,e),$e(t.a.b,e)&&(t.c=null,t.b-=t.a.get(e).length,Xe(t.a,e))}function bn(t,e){return mn(t),e=In(t,e),$e(t.a.b,e)}function En(t,e,n){wn(t,e),0<n.length&&(t.c=null,t.a.set(In(t,e),Q(n)),t.b+=n.length)}function An(t){var e=new gn;return e.c=t.c,t.a&&(e.a=new We(t.a),e.b=t.b),e}function In(t,e){return e=String(e),t.f&&(e=e.toLowerCase()),e}function Nn(t){this.a=t,this.b=this.h=null,this.g=!1,this.i=null,this.c=-1,this.l=this.f=null}function Tn(t){var e=t.a.F.a;if(null!=e)we(4),e?(we(10),pi(t.a,t,!1)):(we(11),pi(t.a,t,!0));else{t.b=new De(t,void 0,void 0),t.b.h=t.h,e=mi(e=t.a,e.Y()?t.f:null,t.i),we(4),un(e,"TYPE","xmlhttp");var n=t.a.j,i=t.a.I;n&&i&&sn(e,n,i),Me(t.b,e,!1,t.f)}}function _n(){this.a=this.b=null}function Sn(){this.a=new We}function Rn(t){var e=typeof t;return"object"==e&&t||"function"==e?"o"+(t[P]||(t[P]=++U)):e.charAt(0)+t}function kn(t,e){this.b=t,this.a=e}function On(t){this.g=t||Ln,t=_.PerformanceNavigationTiming?0<(t=_.performance.getEntriesByType("navigation")).length&&("hq"==t[0].nextHopProtocol||"h2"==t[0].nextHopProtocol):!!(_.ka&&_.ka.Da&&_.ka.Da()&&_.ka.Da().zb),this.f=t?this.g:1,this.a=null,1<this.f&&(this.a=new Sn),this.b=null,this.c=[]}(I=gn.prototype).add=function(t,e){mn(this),this.c=null,t=In(this,t);var n=this.a.get(t);return n||this.a.set(t,n=[]),n.push(e),this.b+=1,this},I.forEach=function(n,i){mn(this),this.a.forEach(function(t,e){H(t,function(t){n.call(i,t,e,this)},this)},this)},I.K=function(){mn(this);for(var t=this.a.C(),e=this.a.K(),n=[],i=0;i<e.length;i++)for(var r=t[i],o=0;o<r.length;o++)n.push(e[i]);return n},I.C=function(t){mn(this);var e=[];if(S(t))bn(this,t)&&(e=Y(e,this.a.get(In(this,t))));else{t=this.a.C();for(var n=0;n<t.length;n++)e=Y(e,t[n])}return e},I.set=function(t,e){return mn(this),this.c=null,bn(this,t=In(this,t))&&(this.b-=this.a.get(t).length),this.a.set(t,[e]),this.b+=1,this},I.get=function(t,e){return t&&0<(t=this.C(t)).length?String(t[0]):e},I.toString=function(){if(this.c)return this.c;if(!this.a)return"";for(var t=[],e=this.a.K(),n=0;n<e.length;n++){var i=e[n],r=encodeURIComponent(String(i));i=this.C(i);for(var o=0;o<i.length;o++){var s=r;""!==i[o]&&(s+="="+encodeURIComponent(String(i[o]))),t.push(s)}}return this.c=t.join("&")},j(function(){},function(){}),(I=Nn.prototype).M=null,I.$=function(t){return this.a.$(t)},I.abort=function(){this.b&&(this.b.cancel(),this.b=null),this.c=-1},I.Ca=function(){return!1},I.Fa=function(t,e){if(this.c=t.o,0==this.M){if(!this.a.o&&(t=t.a)){var n=ei(t,"X-Client-Wire-Protocol");this.l=n||null,this.a.j&&(t=ei(t,"X-HTTP-Session-Id"))&&(this.a.I=t)}if(e){try{var i=this.a.ja.a.parse(e)}catch(t){return(e=this.a).m=this.c,void vi(e,2)}this.f=i[0]}else(e=this.a).m=this.c,vi(e,2)}else 1==this.M&&(this.g?we(6):"11111"==e?(we(5),this.g=!0,(!ht||10<=Number(mt))&&(this.c=200,this.b.cancel(),we(11),pi(this.a,this,!0))):(we(7),this.g=!1))},I.na=function(){if(this.c=this.b.o,this.b.b)0==this.M?(this.M=1,Tn(this)):1==this.M&&(this.g?(we(11),pi(this.a,this,!0)):(we(10),pi(this.a,this,!1)));else{0==this.M?we(8):1==this.M&&we(9);var t=this.a;t.m=this.c,vi(t,2)}},I.Y=function(){return this.a.Y()},I.ma=function(){return this.a.ma()},Sn.prototype.add=function(t){this.a.set(Rn(t),t)},Sn.prototype.C=function(){return this.a.C()};var Ln=10;function Dn(t,e){!t.a&&($(e,"spdy")||$(e,"quic")||$(e,"h2"))&&(t.f=t.g,t.a=new Sn,t.b&&(Un(t,t.b),t.b=null))}function Vn(t){return t.b||t.a&&t.a.a.c>=t.f}function Cn(t){return t.b?1:t.a?t.a.a.c:0}function Pn(t,e){return t=t.b?t.b==e:!!t.a&&(e=Rn(e),$e(t.a.a.b,e))}function Un(t,e){t.a?t.a.add(e):t.b=e}function Mn(t,e){var n;t.b&&t.b==e?t.b=null:((n=t.a)&&(n=Rn(e),n=$e(t.a.a.b,n)),n&&Xe(t.a.a,Rn(e)))}function xn(t){if(null!=t.b)return t.c.concat(t.b.j);if(null==t.a||0==t.a.a.c)return Q(t.c);var e=t.c;return H(t.a.C(),function(t){e=e.concat(t.j)}),e}function Fn(){}function qn(){this.a=new Fn}function Gn(t,i,e){var r=e||"";try{Qe(t,function(t,e){var n=t;C(t)&&(n=Wt(t)),i.push(r+e+"="+encodeURIComponent(n))})}catch(t){throw i.push(r+"type="+encodeURIComponent("_badmap")),t}}function jn(t,e,n,i,r){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,r(i)}catch(t){}}On.prototype.cancel=function(){var t;this.c=xn(this),this.b?(this.b.cancel(),this.b=null):this.a&&0!=this.a.a.c&&(H(this.a.C(),function(t){t.cancel()}),(t=this.a.a).b={},t.a.length=0,t.c=0)},Fn.prototype.stringify=function(t){return _.JSON.stringify(t,void 0)},Fn.prototype.parse=function(t){return _.JSON.parse(t,void 0)};var Bn=_.JSON.parse;function zn(t){Yt.call(this),this.headers=new We,this.H=t||null,this.b=!1,this.s=this.a=null,this.A="",this.h=0,this.f="",this.g=this.w=this.l=this.v=!1,this.o=0,this.m=null,this.I=Hn,this.D=this.F=!1}j(zn,Yt);var Hn="",Yn=/^https?$/i,Qn=["POST","PUT"];function Wn(t){return"content-type"==t.toLowerCase()}function Xn(t,e){t.b=!1,t.a&&(t.g=!0,t.a.abort(),t.g=!1),t.f=e,t.h=5,Kn(t),Zn(t)}function Kn(t){t.v||(t.v=!0,t.dispatchEvent("complete"),t.dispatchEvent("error"))}function $n(t){if(t.b&&void 0!==T&&(!t.s[1]||4!=ti(t)||2!=t.T()))if(t.l&&4==ti(t))ue(t.Ea,0,t);else if(t.dispatchEvent("readystatechange"),4==ti(t)){t.b=!1;try{var e,n=t.T();t:switch(n){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var i=!0;break t;default:i=!1}if(!(e=i)){var r;if(r=0===n){var o=String(t.A).match(Ze)[1]||null;if(!o&&_.self&&_.self.location){var s=_.self.location.protocol;o=s.substr(0,s.length-1)}r=!Yn.test(o?o.toLowerCase():"")}e=r}if(e)t.dispatchEvent("complete"),t.dispatchEvent("success");else{t.h=6;try{var u=2<ti(t)?t.a.statusText:""}catch(t){u=""}t.f=u+" ["+t.T()+"]",Kn(t)}}finally{Zn(t)}}}function Zn(t,e){if(t.a){Jn(t);var n=t.a,i=t.s[0]?O:null;t.a=null,t.s=null,e||t.dispatchEvent("ready");try{n.onreadystatechange=i}catch(t){}}}function Jn(t){t.a&&t.D&&(t.a.ontimeout=null),t.m&&(_.clearTimeout(t.m),t.m=null)}function ti(t){return t.a?t.a.readyState:0}function ei(t,e){return t.a?t.a.getResponseHeader(e):null}function ni(t,e,n){t:{for(i in n){var i=!1;break t}i=!0}if(i)return t;var r;if(r="",et(n,function(t,e){r+=e,r+=":",r+=t,r+="\r\n"}),n=r,S(t)){if(e=encodeURIComponent(String(e)),e+=n=null!=n?"="+encodeURIComponent(String(n)):""){if((n=t.indexOf("#"))<0&&(n=t.length),(i=t.indexOf("?"))<0||n<i){i=n;var o=""}else o=t.substring(i+1,n);n=(t=[t.substr(0,i),o,t.substr(n)])[1],t[1]=e?n?n+"&"+e:e:n,t=t[0]+(t[1]?"?"+t[1]:"")+t[2]}return t}return sn(t,e,n),t}function ii(t){this.f=[],this.F=new _n,this.ga=this.pa=this.B=this.ha=this.a=this.I=this.j=this.V=this.g=this.J=this.i=null,this.Qa=this.P=0,this.Oa=!!k("internalChannelParams.failFast",t),this.ia=this.w=this.s=this.l=this.h=this.c=null,this.oa=!0,this.m=this.ra=this.O=-1,this.S=this.v=this.A=0,this.Na=k("internalChannelParams.baseRetryDelayMs",t)||5e3,this.Ra=k("internalChannelParams.retryDelaySeedMs",t)||1e4,this.Pa=k("internalChannelParams.forwardChannelMaxRetries",t)||2,this.qa=k("internalChannelParams.forwardChannelRequestTimeoutMs",t)||2e4,this.Ka=t&&t.Ab||void 0,this.D=void 0,this.R=t&&t.supportsCrossDomainXhr||!1,this.H="",this.b=new On(t&&t.concurrentRequestLimit),this.ja=new qn,this.o=!t||void 0===t.backgroundChannelTest||t.backgroundChannelTest,(this.W=t&&t.fastHandshake||!1)&&!this.o&&(this.o=!0),t&&t.forceLongPolling&&(this.oa=!1),this.fa=void 0}function ri(t){if(oi(t),3==t.u){var e=t.P++,n=tn(t.B);sn(n,"SID",t.H),sn(n,"RID",e),sn(n,"TYPE","terminate"),hi(t,n),(e=new De(t,e,void 0)).F=2,e.f=an(tn(n)),n=!1,_.navigator&&_.navigator.sendBeacon&&(n=_.navigator.sendBeacon(e.f.toString(),"")),!n&&_.Image&&((new Image).src=e.f,n=!0),n||(e.a=e.g.$(null),e.a.ca(e.f)),e.v=G(),Ge(e)}gi(t)}function oi(t){t.w&&(t.w.abort(),t.w=null),t.a&&(t.a.cancel(),t.a=null),t.l&&(_.clearTimeout(t.l),t.l=null),di(t),t.b.cancel(),t.h&&(R(t.h)&&_.clearTimeout(t.h),t.h=null)}function si(t,e){t.f.push(new kn(t.Qa++,e)),3==t.u&&ui(t)}function ui(t){Vn(t.b)||t.h||(t.h=!0,ee(t.Ha,t),t.A=0)}function ai(t,e){var n;n=e?e.W:t.P++;var i=tn(t.B);sn(i,"SID",t.H),sn(i,"RID",n),sn(i,"AID",t.O),hi(t,i),t.g&&t.i&&ni(i,t.g,t.i),n=new De(t,n,t.A+1),null===t.g&&(n.h=t.i),e&&(t.f=e.j.concat(t.f)),e=ci(t,n,1e3),n.setTimeout(Math.round(.5*t.qa)+Math.round(.5*t.qa*Math.random())),Un(t.b,n),Ue(n,i,e)}function hi(t,n){t.c&&Qe({},function(t,e){sn(n,e,t)})}function ci(t,e,n){n=Math.min(t.f.length,n);var i=t.c?F(t.c.Sa,t.c,t):null;t:for(var r=t.f,o=-1;;){var s=["count="+n];-1==o?0<n?(o=r[0].b,s.push("ofs="+o)):o=0:s.push("ofs="+o);for(var u=!0,a=0;a<n;a++){var h=r[a].b,c=r[a].a;if((h-=o)<0)o=Math.max(0,r[a].b-100),u=!1;else try{Gn(c,s,"req"+h+"_")}catch(t){i&&i(c)}}if(u){i=s.join("&");break t}}return t=t.f.splice(0,n),e.j=t,i}function fi(t){t.a||t.l||(t.S=1,ee(t.Ga,t),t.v=0)}function li(t){return!(t.a||t.l||3<=t.v)&&(t.S++,t.l=Ee(F(t.Ga,t),yi(t,t.v)),t.v++,1)}function pi(t,e,n){var i=e.l;i&&Dn(t.b,i),t.ia=t.oa&&n,t.m=e.c,t.B=mi(t,null,t.ha),ui(t)}function di(t){null!=t.s&&(_.clearTimeout(t.s),t.s=null)}function yi(t,e){var n=t.Na+Math.floor(Math.random()*t.Ra);return t.ma()||(n*=2),n*e}function vi(t,e){if(2==e){var n=null;t.c&&(n=null);var i=F(t.eb,t);n||(n=new Je("//www.google.com/images/cleardot.gif"),_.location&&"http"==_.location.protocol||en(n,"https"),an(n)),function(t,e){var n=new de;if(_.Image){var i=new Image;i.onload=q(jn,n,i,"TestLoadImage: loaded",!0,e),i.onerror=q(jn,n,i,"TestLoadImage: error",!1,e),i.onabort=q(jn,n,i,"TestLoadImage: abort",!1,e),i.ontimeout=q(jn,n,i,"TestLoadImage: timeout",!1,e),_.setTimeout(function(){i.ontimeout&&i.ontimeout()},1e4),i.src=t}else e(!1)}(n.toString(),i)}else we(2);t.u=0,t.c&&t.c.ta(e),gi(t),oi(t)}function gi(t){t.u=0,t.m=-1,t.c&&(0==xn(t.b).length&&0==t.f.length||(t.b.c.length=0,Q(t.f),t.f.length=0),t.c.sa())}function mi(t,e,n){var i,r,o,s,u,a,h=(i=n)instanceof Je?tn(i):new Je(i,void 0);if(""!=h.b)e&&nn(h,e+"."+h.b),rn(h,h.i);else{var c,f=_.location;c=e?e+"."+f.hostname:f.hostname,r=f.protocol,o=c,s=+f.port,u=n,a=new Je(null,void 0),r&&en(a,r),o&&nn(a,o),s&&rn(a,s),u&&(a.a=u),h=a}return t.V&&et(t.V,function(t,e){sn(h,e,t)}),e=t.j,n=t.I,e&&n&&sn(h,e,n),sn(h,"VER",t.wa),hi(t,h),h}function wi(){}function bi(){if(ht&&!(10<=Number(mt)))throw Error("Environmental error: no available transport.")}function Ei(t,e){Yt.call(this),this.a=new ii(e),this.g=t,this.m=e&&e.fb?e.fb:function(t){for(var e=t,n=1;n<arguments.length;n++){var i,r=arguments[n];if(0==r.lastIndexOf("/",0))e=r;else(i=""==e)||(i=0<=(i=e.length-1)&&e.indexOf("/",i)==i),e+=i?r:"/"+r}return e}(this.g,"test"),this.b=e&&e.messageUrlParams||null,t=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(t?t["X-Client-Protocol"]="webchannel":t={"X-Client-Protocol":"webchannel"}),this.a.i=t,t=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(t?t["X-WebChannel-Content-Type"]=e.messageContentType:t={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.xa&&(t?t["X-WebChannel-Client-Profile"]=e.xa:t={"X-WebChannel-Client-Profile":e.xa}),this.a.J=t,(t=e&&e.httpHeadersOverwriteParam)&&!W(t)&&(this.a.g=t),this.l=e&&e.supportsCrossDomainXhr||!1,this.h=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!W(e)&&(this.a.j=e,null!==(t=this.b)&&e in t&&(e in(t=this.b)&&delete t[e])),this.f=new Ni(this)}function Ai(t){ke.call(this);var e=t.__sm__;if(e){t:{for(var n in e){t=n;break t}t=void 0}(this.c=t)?(t=this.c,this.data=null!==e&&t in e?e[t]:void 0):this.data=e}else this.data=t}function Ii(){Oe.call(this),this.status=1}function Ni(t){this.a=t}(I=zn.prototype).ca=function(t,e,n,i){if(this.a)throw Error("[goog.net.XhrIo] Object is active with another request="+this.A+"; newUri="+t);e=e?e.toUpperCase():"GET",this.A=t,this.f="",this.h=0,this.v=!1,this.b=!0,this.a=new XMLHttpRequest,this.s=this.H?Te(this.H):Te(Se),this.a.onreadystatechange=F(this.Ea,this);try{this.w=!0,this.a.open(e,String(t),!0),this.w=!1}catch(t){return void Xn(this,t)}t=n||"";var r,o=new We(this.headers);i&&Qe(i,function(t,e){o.set(e,t)}),i=function(t){t:{for(var e=Wn,n=t.length,i=S(t)?t.split(""):t,r=0;r<n;r++)if(r in i&&e.call(void 0,i[r],r,t)){e=r;break t}e=-1}return e<0?null:S(t)?t.charAt(e):t[e]}(o.K()),n=_.FormData&&t instanceof _.FormData,0<=z(Qn,e)&&!i&&!n&&o.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),o.forEach(function(t,e){this.a.setRequestHeader(e,t)},this),this.I&&(this.a.responseType=this.I),"withCredentials"in this.a&&this.a.withCredentials!==this.F&&(this.a.withCredentials=this.F);try{Jn(this),0<this.o&&((this.D=(r=this.a,ht&&bt(9)&&R(r.timeout)&&void 0!==r.ontimeout))?(this.a.timeout=this.o,this.a.ontimeout=F(this.Ba,this)):this.m=ue(this.Ba,this.o,this)),this.l=!0,this.a.send(t),this.l=!1}catch(t){Xn(this,t)}},I.Ba=function(){void 0!==T&&this.a&&(this.f="Timed out after "+this.o+"ms, aborting",this.h=8,this.dispatchEvent("timeout"),this.abort(8))},I.abort=function(t){this.a&&this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1,this.h=t||7,this.dispatchEvent("complete"),this.dispatchEvent("abort"),Zn(this))},I.G=function(){this.a&&(this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1),Zn(this,!0)),zn.N.G.call(this)},I.Ea=function(){this.j||(this.w||this.l||this.g?$n(this):this.Za())},I.Za=function(){$n(this)},I.T=function(){try{return 2<ti(this)?this.a.status:-1}catch(t){return-1}},I.aa=function(){try{return this.a?this.a.responseText:""}catch(t){return""}},I.Ua=function(t){if(this.a){var e=this.a.responseText;return t&&0==e.indexOf(t)&&(e=e.substring(t.length)),Bn(e)}},I.ya=function(){return this.h},I.Xa=function(){return S(this.f)?this.f:String(this.f)},(I=ii.prototype).wa=8,I.u=1,I.Ca=function(){return 0==this.u},I.Ha=function(t){if(this.h)if(this.h=null,1==this.u){if(!t){this.P=Math.floor(1e5*Math.random()),t=this.P++;var e,n=new De(this,t,void 0),i=this.i;if(this.J&&(i?rt(i=nt(i),this.J):i=this.J),null===this.g&&(n.h=i),this.W)t:{for(var r=e=0;r<this.f.length;r++){var o=this.f[r];if("__data__"in o.a&&S(o=o.a.__data__)?o=o.length:o=void 0,void 0===o)break;if(4096<(e+=o)){e=r;break t}if(4096===e||r===this.f.length-1){e=r+1;break t}}e=1e3}else e=1e3;e=ci(this,n,e),sn(r=tn(this.B),"RID",t),sn(r,"CVER",22),this.o&&this.j&&sn(r,"X-HTTP-Session-Id",this.j),hi(this,r),this.g&&i&&ni(r,this.g,i),Un(this.b,n),this.W?(sn(r,"$req",e),sn(r,"SID","null"),n.S=!0,Ue(n,r,null)):Ue(n,r,e),this.u=2}}else 3==this.u&&(t?ai(this,t):0==this.f.length||Vn(this.b)||ai(this))},I.Ga=function(){this.l=null,this.a=new De(this,"rpc",this.S),null===this.g&&(this.a.h=this.i),this.a.J=0;var t=tn(this.pa);sn(t,"RID","rpc"),sn(t,"SID",this.H),sn(t,"CI",this.ia?"0":"1"),sn(t,"AID",this.O),hi(this,t),sn(t,"TYPE","xmlhttp"),this.g&&this.i&&ni(t,this.g,this.i),this.D&&this.a.setTimeout(this.D),Me(this.a,t,!0,this.ga)},I.Fa=function(t,e){if(0!=this.u&&(this.a==t||Pn(this.b,t)))if(this.m=t.o,!t.s&&Pn(this.b,t)&&3==this.u){try{var n=this.ja.a.parse(e)}catch(t){n=null}if(D(n)&&3==n.length){if(0==(e=n)[0]){t:if(!this.l){if(this.a){if(!(this.a.v+3e3<t.v))break t;di(this),this.a.cancel(),this.a=null}li(this),we(18)}}else this.ra=e[1],0<this.ra-this.O&&e[2]<37500&&this.ia&&0==this.v&&!this.s&&(this.s=Ee(F(this.Ya,this),6e3));if(Cn(this.b)<=1&&this.fa){try{this.fa()}catch(t){}this.fa=void 0}}else vi(this,11)}else if(!t.s&&this.a!=t||di(this),!W(e))for(e=n=this.ja.a.parse(e),n=0;n<e.length;n++){var i=e[n];if(this.O=i[0],i=i[1],2==this.u)if("c"==i[0]){this.H=i[1],this.ga=i[2];var r=i[3];null!=r&&(this.wa=r),null!=(i=i[5])&&R(i)&&0<i&&(this.D=1.5*i),this.o&&(i=t.a)&&((r=ei(i,"X-Client-Wire-Protocol"))&&Dn(this.b,r),this.j&&(i=ei(i,"X-HTTP-Session-Id")))&&(this.I=i,sn(this.B,this.j,i)),this.u=3,this.c&&this.c.va(),i=t,this.pa=mi(this,this.Y()?this.ga:null,this.ha),i.s?(Mn(this.b,i),(r=this.D)&&i.setTimeout(r),i.i&&(Be(i),Ge(i)),this.a=i):fi(this),0<this.f.length&&ui(this)}else"stop"!=i[0]&&"close"!=i[0]||vi(this,7);else 3==this.u&&("stop"==i[0]||"close"==i[0]?"stop"==i[0]?vi(this,7):ri(this):"noop"!=i[0]&&this.c&&this.c.ua(i),this.v=0)}},I.Ya=function(){null!=this.s&&(this.s=null,this.a.cancel(),this.a=null,li(this),we(19))},I.na=function(t){var e=null;if(this.a==t){di(this),this.a=null;var n=2}else{if(!Pn(this.b,t))return;e=t.j,Mn(this.b,t),n=1}if(this.m=t.o,0!=this.u)if(t.b)1==n?(e=G()-t.v,ye.dispatchEvent(new be(ye,t.l&&t.l.length,this.A)),ui(this)):fi(this);else{var i=t.c;if(3==i||0==i&&0<this.m||!(1==n&&function(t,e){if(!(Cn(t.b)>=t.b.f-(t.h?1:0))){if(t.h)return t.f=e.j.concat(t.f),1;if(!(1==t.u||2==t.u||t.A>=(t.Oa?0:t.Pa)))return t.h=Ee(F(t.Ha,t,e),yi(t,t.A)),t.A++,1}}(this,t)||2==n&&li(this)))switch(e&&0<e.length&&(t=this.b,t.c=t.c.concat(e)),i){case 1:vi(this,5);break;case 4:vi(this,10);break;case 3:vi(this,6);break;default:vi(this,2)}}},I.eb=function(t){we(t?2:1)},I.$=function(t){if(t&&!this.R)throw Error("Can't create secondary domain capable XhrIo object.");return(t=new zn(this.Ka)).F=this.R,t},I.ma=function(){return!!this.c&&!0},I.Y=function(){return this.R},(I=wi.prototype).va=function(){},I.ua=function(){},I.ta=function(){},I.sa=function(){},I.Sa=function(){},bi.prototype.a=function(t,e){return new Ei(t,e)},j(Ei,Yt),(I=Ei.prototype).addEventListener=function(t,e,n,i){Ei.N.addEventListener.call(this,t,e,n,i)},I.removeEventListener=function(t,e,n,i){Ei.N.removeEventListener.call(this,t,e,n,i)},I.Va=function(){this.a.c=this.f,this.l&&(this.a.R=!0);var t=this.a,e=this.m,n=this.g,i=this.b||void 0;we(0),t.ha=n,t.V=i||{},t.o&&(t.F.b=[],t.F.a=!1),t.w=new Nn(t),null===t.g&&(t.w.h=t.i),n=e,t.g&&t.i&&(n=ni(e,t.g,t.i)),(t=t.w).i=n,e=mi(t.a,null,t.i),we(3),null!=(n=t.a.F.b)?(t.f=n[0],t.M=1,Tn(t)):(un(e,"MODE","init"),!t.a.o&&t.a.j&&un(e,"X-HTTP-Session-Id",t.a.j),t.b=new De(t,void 0,void 0),t.b.h=t.h,Me(t.b,e,!1,null),t.M=0)},I.close=function(){ri(this.a)},I.Wa=function(t){if(S(t)){var e={};e.__data__=t,si(this.a,e)}else this.h?((e={}).__data__=Wt(t),si(this.a,e)):si(this.a,t)},I.G=function(){this.a.c=null,delete this.f,ri(this.a),delete this.a,Ei.N.G.call(this)},j(Ai,ke),j(Ii,Oe),j(Ni,wi),Ni.prototype.va=function(){this.a.dispatchEvent("a")},Ni.prototype.ua=function(t){this.a.dispatchEvent(new Ai(t))},Ni.prototype.ta=function(t){this.a.dispatchEvent(new Ii)},Ni.prototype.sa=function(){this.a.dispatchEvent("b")};var Ti=q(function(t,e){function n(){}n.prototype=t.prototype;var i=new n;return t.apply(i,Array.prototype.slice.call(arguments,1)),i},bi);bi.prototype.createWebChannel=bi.prototype.a,Ei.prototype.send=Ei.prototype.Wa,Ei.prototype.open=Ei.prototype.Va,Ei.prototype.close=Ei.prototype.close,Ae.NO_ERROR=0,Ae.TIMEOUT=8,Ae.HTTP_ERROR=6,Ie.COMPLETE="complete",(_e.EventType=Re).OPEN="a",Re.CLOSE="b",Re.ERROR="c",Re.MESSAGE="d",Yt.prototype.listen=Yt.prototype.za,zn.prototype.listenOnce=zn.prototype.Aa,zn.prototype.getLastError=zn.prototype.Xa,zn.prototype.getLastErrorCode=zn.prototype.ya,zn.prototype.getStatus=zn.prototype.T,zn.prototype.getResponseJson=zn.prototype.Ua,zn.prototype.getResponseText=zn.prototype.aa,zn.prototype.send=zn.prototype.ca;var _i={createWebChannelTransport:Ti,ErrorCode:Ae,EventType:Ie,WebChannel:_e,XhrIo:zn},Si=_i.createWebChannelTransport,Ri=_i.ErrorCode,ki=_i.EventType,Oi=_i.WebChannel,Li=_i.XhrIo,Di=Nf.SDK_VERSION,Vi=(Ci.prototype.t=function(){return null!=this.uid},Ci.prototype.s=function(){return this.t()?"uid:"+this.uid:"anonymous-user"},Ci.prototype.isEqual=function(t){return t.uid===this.uid},Ci);function Ci(t){this.uid=t}Vi.UNAUTHENTICATED=new Vi(null),Vi.i=new Vi("google-credentials-uid"),Vi.h=new Vi("first-party-uid");function Pi(t,e){this.user=e,this.type="OAuth",this.o={},this.o.Authorization="Bearer "+t}var Ui,Mi={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},xi=(n($i,Ui=Error),$i),Fi=(Ki.prototype.getToken=function(){return Promise.resolve(null)},Ki.prototype.l=function(){},Ki.prototype._=function(t){(this.u=t)(Vi.UNAUTHENTICATED)},Ki.prototype.T=function(){this.u=null},Ki),qi=(Xi.prototype.getToken=function(){var e=this,n=this.R,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(function(t){if(e.R!==n)throw new xi(Mi.ABORTED,"getToken aborted due to token change.");return t?(gu("string"==typeof t.accessToken),new Pi(t.accessToken,e.currentUser)):null}):Promise.resolve(null)},Xi.prototype.l=function(){this.forceRefresh=!0},Xi.prototype._=function(t){this.u=t,this.m&&t(this.currentUser)},Xi.prototype.T=function(){this.auth&&this.auth.removeAuthTokenListener(this.I),this.I=null,this.u=null},Xi.prototype.A=function(){var t=this.auth&&this.auth.getUid();return gu(null===t||"string"==typeof t),new Vi(t)},Xi),Gi=(Object.defineProperty(Wi.prototype,"o",{get:function(){var t={"X-Goog-AuthUser":this.V},e=this.P.auth.p([]);return e&&(t.Authorization=e),t},enumerable:!0,configurable:!0}),Wi),ji=(Qi.prototype.getToken=function(){return Promise.resolve(new Gi(this.P,this.V))},Qi.prototype._=function(t){t(Vi.h)},Qi.prototype.T=function(){},Qi.prototype.l=function(){},Qi),Bi=(Yi.now=function(){return Yi.fromMillis(Date.now())},Yi.fromDate=function(t){return Yi.fromMillis(t.getTime())},Yi.fromMillis=function(t){var e=Math.floor(t/1e3);return new Yi(e,1e6*(t-1e3*e))},Yi.prototype.toDate=function(){return new Date(this.toMillis())},Yi.prototype.toMillis=function(){return 1e3*this.seconds+this.nanoseconds/1e6},Yi.prototype.g=function(t){return this.seconds===t.seconds?bu(this.nanoseconds,t.nanoseconds):bu(this.seconds,t.seconds)},Yi.prototype.isEqual=function(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds},Yi.prototype.toString=function(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"},Yi.prototype.valueOf=function(){var t=this.seconds- -62135596800;return String(t).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")},Yi),zi=(Hi.v=function(t){return new Hi(t)},Hi.S=function(){return Hi.MIN},Hi.prototype.D=function(t){return this.timestamp.g(t.timestamp)},Hi.prototype.isEqual=function(t){return this.timestamp.isEqual(t.timestamp)},Hi.prototype.C=function(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3},Hi.prototype.toString=function(){return"SnapshotVersion("+this.timestamp.toString()+")"},Hi.prototype.F=function(){return this.timestamp},Hi);function Hi(t){this.timestamp=t}function Yi(t,e){if(this.seconds=t,(this.nanoseconds=e)<0)throw new xi(Mi.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(1e9<=e)throw new xi(Mi.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(t<-62135596800)throw new xi(Mi.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(253402300800<=t)throw new xi(Mi.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}function Qi(t,e){this.P=t,this.V=e}function Wi(t,e){this.P=t,this.V=e,this.type="FirstParty",this.user=Vi.h}function Xi(t){var e=this;this.I=null,this.currentUser=Vi.UNAUTHENTICATED,this.m=!1,this.R=0,this.u=null,this.forceRefresh=!1,this.I=function(){e.R++,e.currentUser=e.A(),e.m=!0,e.u&&e.u(e.currentUser)},this.R=0,this.auth=t.getImmediate({optional:!0}),this.auth?this.auth.addAuthTokenListener(this.I):(this.I(null),t.get().then(function(t){e.auth=t,e.I&&e.auth.addAuthTokenListener(e.I)},function(){}))}function Ki(){this.u=null}function $i(t,e){var n=this;return(n=Ui.call(this,e)||this).code=t,n.message=e,n.name="FirebaseError",n.toString=function(){return n.name+": [code="+n.code+"]: "+n.message},n}zi.MIN=new zi(new Bi(0,0));var Zi,Ji=(Object.defineProperty(nr.prototype,"length",{get:function(){return this.N},enumerable:!0,configurable:!0}),nr.prototype.isEqual=function(t){return 0===nr.$(this,t)},nr.prototype.child=function(t){var e=this.segments.slice(this.offset,this.limit());return t instanceof nr?t.forEach(function(t){e.push(t)}):e.push(t),this.k(e)},nr.prototype.limit=function(){return this.offset+this.length},nr.prototype.L=function(t){return t=void 0===t?1:t,this.k(this.segments,this.offset+t,this.length-t)},nr.prototype.O=function(){return this.k(this.segments,this.offset,this.length-1)},nr.prototype.M=function(){return this.segments[this.offset]},nr.prototype.q=function(){return this.get(this.length-1)},nr.prototype.get=function(t){return this.segments[this.offset+t]},nr.prototype.B=function(){return 0===this.length},nr.prototype.U=function(t){if(t.length<this.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},nr.prototype.W=function(t){if(this.length+1!==t.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},nr.prototype.forEach=function(t){for(var e=this.offset,n=this.limit();e<n;e++)t(this.segments[e])},nr.prototype.j=function(){return this.segments.slice(this.offset,this.limit())},nr.$=function(t,e){for(var n=Math.min(t.length,e.length),i=0;i<n;i++){var r=t.get(i),o=e.get(i);if(r<o)return-1;if(o<r)return 1}return t.length<e.length?-1:t.length>e.length?1:0},nr),tr=(n(er,Zi=Ji),er.prototype.k=function(t,e,n){return new er(t,e,n)},er.prototype.G=function(){return this.j().join("/")},er.prototype.toString=function(){return this.G()},er.K=function(t){if(0<=t.indexOf("//"))throw new xi(Mi.INVALID_ARGUMENT,"Invalid path ("+t+"). Paths must not contain // in them.");return new er(t.split("/").filter(function(t){return 0<t.length}))},er);function er(){return null!==Zi&&Zi.apply(this,arguments)||this}function nr(t,e,n){void 0===e?e=0:e>t.length&&vu(),void 0===n?n=t.length-e:n>t.length-e&&vu(),this.segments=t,this.offset=e,this.N=n}tr.H=new tr([]);var ir,rr=/^[_a-zA-Z][_a-zA-Z0-9]*$/,or=(n(sr,ir=Ji),sr.prototype.k=function(t,e,n){return new sr(t,e,n)},sr.Y=function(t){return rr.test(t)},sr.prototype.G=function(){return this.j().map(function(t){return t=t.replace("\\","\\\\").replace("`","\\`"),sr.Y(t)||(t="`"+t+"`"),t}).join(".")},sr.prototype.toString=function(){return this.G()},sr.prototype.X=function(){return 1===this.length&&"__name__"===this.get(0)},sr.J=function(){return new sr(["__name__"])},sr.Z=function(t){for(var e=[],n="",i=0,r=function(){if(0===n.length)throw new xi(Mi.INVALID_ARGUMENT,"Invalid field path ("+t+"). Paths must not be empty, begin with '.', end with '.', or contain '..'");e.push(n),n=""},o=!1;i<t.length;){var s=t[i];if("\\"===s){if(i+1===t.length)throw new xi(Mi.INVALID_ARGUMENT,"Path has trailing escape character: "+t);var u=t[i+1];if("\\"!==u&&"."!==u&&"`"!==u)throw new xi(Mi.INVALID_ARGUMENT,"Path has invalid escape sequence: "+t);n+=u,i+=2}else"`"===s?o=!o:"."!==s||o?n+=s:r(),i++}if(r(),o)throw new xi(Mi.INVALID_ARGUMENT,"Unterminated ` in path: "+t);return new sr(e)},sr);function sr(){return null!==ir&&ir.apply(this,arguments)||this}or.H=new or([]);var ur=(ar.tt=function(t){return new ar(tr.K(t).L(5))},ar.prototype.et=function(t){return 2<=this.path.length&&this.path.get(this.path.length-2)===t},ar.prototype.isEqual=function(t){return null!==t&&0===tr.$(this.path,t.path)},ar.prototype.toString=function(){return this.path.toString()},ar.$=function(t,e){return tr.$(t.path,e.path)},ar.st=function(t){return t.length%2==0},ar.it=function(t){return new ar(new tr(t.slice()))},ar);function ar(t){this.path=t}ur.EMPTY=new ur(new tr([]));var hr=(dr.prototype.nt=function(t,e){return new dr(this.$,this.root.nt(t,e,this.$).rt(null,null,fr.ht,null,null))},dr.prototype.remove=function(t){return new dr(this.$,this.root.remove(t,this.$).rt(null,null,fr.ht,null,null))},dr.prototype.get=function(t){for(var e=this.root;!e.B();){var n=this.$(t,e.key);if(0===n)return e.value;n<0?e=e.left:0<n&&(e=e.right)}return null},dr.prototype.indexOf=function(t){for(var e=0,n=this.root;!n.B();){var i=this.$(t,n.key);if(0===i)return e+n.left.size;n=i<0?n.left:(e+=n.left.size+1,n.right)}return-1},dr.prototype.B=function(){return this.root.B()},Object.defineProperty(dr.prototype,"size",{get:function(){return this.root.size},enumerable:!0,configurable:!0}),dr.prototype.ot=function(){return this.root.ot()},dr.prototype.at=function(){return this.root.at()},dr.prototype.ut=function(t){return this.root.ut(t)},dr.prototype.forEach=function(n){this.ut(function(t,e){return n(t,e),!1})},dr.prototype.toString=function(){var n=[];return this.ut(function(t,e){return n.push(t+":"+e),!1}),"{"+n.join(", ")+"}"},dr.prototype.ct=function(t){return this.root.ct(t)},dr.prototype.lt=function(){return new cr(this.root,null,this.$,!1)},dr.prototype._t=function(t){return new cr(this.root,t,this.$,!1)},dr.prototype.ft=function(){return new cr(this.root,null,this.$,!0)},dr.prototype.dt=function(t){return new cr(this.root,t,this.$,!0)},dr),cr=(pr.prototype.Et=function(){var t=this.Tt.pop(),e={key:t.key,value:t.value};if(this.wt)for(t=t.left;!t.B();)this.Tt.push(t),t=t.right;else for(t=t.right;!t.B();)this.Tt.push(t),t=t.left;return e},pr.prototype.It=function(){return 0<this.Tt.length},pr.prototype.Rt=function(){if(0===this.Tt.length)return null;var t=this.Tt[this.Tt.length-1];return{key:t.key,value:t.value}},pr),fr=(lr.prototype.rt=function(t,e,n,i,r){return new lr(null!=t?t:this.key,null!=e?e:this.value,null!=n?n:this.color,null!=i?i:this.left,null!=r?r:this.right)},lr.prototype.B=function(){return!1},lr.prototype.ut=function(t){return this.left.ut(t)||t(this.key,this.value)||this.right.ut(t)},lr.prototype.ct=function(t){return this.right.ct(t)||t(this.key,this.value)||this.left.ct(t)},lr.prototype.min=function(){return this.left.B()?this:this.left.min()},lr.prototype.ot=function(){return this.min().key},lr.prototype.at=function(){return this.right.B()?this.key:this.right.at()},lr.prototype.nt=function(t,e,n){var i=this,r=n(t,i.key);return(i=r<0?i.rt(null,null,null,i.left.nt(t,e,n),null):0===r?i.rt(null,e,null,null,null):i.rt(null,null,null,null,i.right.nt(t,e,n))).At()},lr.prototype.Pt=function(){if(this.left.B())return lr.EMPTY;var t=this;return t.left.Vt()||t.left.left.Vt()||(t=t.pt()),(t=t.rt(null,null,null,t.left.Pt(),null)).At()},lr.prototype.remove=function(t,e){var n,i=this;if(e(t,i.key)<0)i.left.B()||i.left.Vt()||i.left.left.Vt()||(i=i.pt()),i=i.rt(null,null,null,i.left.remove(t,e),null);else{if(i.left.Vt()&&(i=i.gt()),i.right.B()||i.right.Vt()||i.right.left.Vt()||(i=i.yt()),0===e(t,i.key)){if(i.right.B())return lr.EMPTY;n=i.right.min(),i=i.rt(n.key,n.value,null,null,i.right.Pt())}i=i.rt(null,null,null,null,i.right.remove(t,e))}return i.At()},lr.prototype.Vt=function(){return this.color},lr.prototype.At=function(){var t=this;return t.right.Vt()&&!t.left.Vt()&&(t=t.bt()),t.left.Vt()&&t.left.left.Vt()&&(t=t.gt()),t.left.Vt()&&t.right.Vt()&&(t=t.vt()),t},lr.prototype.pt=function(){var t=this.vt();return t.right.left.Vt()&&(t=(t=(t=t.rt(null,null,null,null,t.right.gt())).bt()).vt()),t},lr.prototype.yt=function(){var t=this.vt();return t.left.left.Vt()&&(t=(t=t.gt()).vt()),t},lr.prototype.bt=function(){var t=this.rt(null,null,lr.RED,null,this.right.left);return this.right.rt(null,null,this.color,t,null)},lr.prototype.gt=function(){var t=this.rt(null,null,lr.RED,this.left.right,null);return this.left.rt(null,null,this.color,null,t)},lr.prototype.vt=function(){var t=this.left.rt(null,null,!this.left.color,null,null),e=this.right.rt(null,null,!this.right.color,null,null);return this.rt(null,null,!this.color,t,e)},lr.prototype.St=function(){var t=this.Dt();return Math.pow(2,t)<=this.size+1},lr.prototype.Dt=function(){if(this.Vt()&&this.left.Vt())throw vu();if(this.right.Vt())throw vu();var t=this.left.Dt();if(t!==this.right.Dt())throw vu();return t+(this.Vt()?0:1)},lr);function lr(t,e,n,i,r){this.key=t,this.value=e,this.color=null!=n?n:lr.RED,this.left=null!=i?i:lr.EMPTY,this.right=null!=r?r:lr.EMPTY,this.size=this.left.size+1+this.right.size}function pr(t,e,n,i){this.wt=i,this.Tt=[];for(var r=1;!t.B();)if(r=e?n(t.key,e):1,i&&(r*=-1),r<0)t=this.wt?t.left:t.right;else{if(0===r){this.Tt.push(t);break}this.Tt.push(t),t=this.wt?t.right:t.left}}function dr(t,e){this.$=t,this.root=e||fr.EMPTY}function yr(){this.size=0}fr.EMPTY=null,fr.RED=!0,fr.ht=!1,fr.EMPTY=(Object.defineProperty(yr.prototype,"key",{get:function(){throw vu()},enumerable:!0,configurable:!0}),Object.defineProperty(yr.prototype,"value",{get:function(){throw vu()},enumerable:!0,configurable:!0}),Object.defineProperty(yr.prototype,"color",{get:function(){throw vu()},enumerable:!0,configurable:!0}),Object.defineProperty(yr.prototype,"left",{get:function(){throw vu()},enumerable:!0,configurable:!0}),Object.defineProperty(yr.prototype,"right",{get:function(){throw vu()},enumerable:!0,configurable:!0}),yr.prototype.rt=function(t,e,n,i,r){return this},yr.prototype.nt=function(t,e,n){return new fr(t,e)},yr.prototype.remove=function(t,e){return this},yr.prototype.B=function(){return!0},yr.prototype.ut=function(t){return!1},yr.prototype.ct=function(t){return!1},yr.prototype.ot=function(){return null},yr.prototype.at=function(){return null},yr.prototype.Vt=function(){return!1},yr.prototype.St=function(){return!0},yr.prototype.Dt=function(){return 0},new yr);var vr=(wr.prototype.has=function(t){return null!==this.data.get(t)},wr.prototype.first=function(){return this.data.ot()},wr.prototype.last=function(){return this.data.at()},Object.defineProperty(wr.prototype,"size",{get:function(){return this.data.size},enumerable:!0,configurable:!0}),wr.prototype.indexOf=function(t){return this.data.indexOf(t)},wr.prototype.forEach=function(n){this.data.ut(function(t,e){return n(t),!1})},wr.prototype.Ct=function(t,e){for(var n=this.data._t(t[0]);n.It();){var i=n.Et();if(0<=this.$(i.key,t[1]))return;e(i.key)}},wr.prototype.Ft=function(t,e){var n;for(n=void 0!==e?this.data._t(e):this.data.lt();n.It();)if(!t(n.Et().key))return},wr.prototype.Nt=function(t){var e=this.data._t(t);return e.It()?e.Et().key:null},wr.prototype.lt=function(){return new gr(this.data.lt())},wr.prototype._t=function(t){return new gr(this.data._t(t))},wr.prototype.add=function(t){return this.rt(this.data.remove(t).nt(t,!0))},wr.prototype.delete=function(t){return this.has(t)?this.rt(this.data.remove(t)):this},wr.prototype.B=function(){return this.data.B()},wr.prototype.$t=function(t){var e=this;return e.size<t.size&&(e=t,t=this),t.forEach(function(t){e=e.add(t)}),e},wr.prototype.isEqual=function(t){if(!(t instanceof wr))return!1;if(this.size!==t.size)return!1;for(var e=this.data.lt(),n=t.data.lt();e.It();){var i=e.Et().key,r=n.Et().key;if(0!==this.$(i,r))return!1}return!0},wr.prototype.j=function(){var e=[];return this.forEach(function(t){e.push(t)}),e},wr.prototype.toString=function(){var e=[];return this.forEach(function(t){return e.push(t)}),"SortedSet("+e.toString()+")"},wr.prototype.rt=function(t){var e=new wr(this.$);return e.data=t,e},wr),gr=(mr.prototype.Et=function(){return this.kt.Et().key},mr.prototype.It=function(){return this.kt.It()},mr);function mr(t){this.kt=t}function wr(t){this.$=t,this.data=new hr(this.$)}function br(t){var e=0;for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function Er(t,e){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function Ar(t){for(var e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}var Ir=(Nr.fromBase64String=function(t){return new Nr(au.Ot().atob(t))},Nr.fromUint8Array=function(t){return new Nr(function(t){for(var e="",n=0;n<t.length;++n)e+=String.fromCharCode(t[n]);return e}(t))},Nr.prototype.toBase64=function(){return au.Ot().btoa(this.Lt)},Nr.prototype.toUint8Array=function(){return function(t){for(var e=new Uint8Array(t.length),n=0;n<t.length;n++)e[n]=t.charCodeAt(n);return e}(this.Lt)},Nr.prototype.Mt=function(){return 2*this.Lt.length},Nr.prototype.D=function(t){return bu(this.Lt,t.Lt)},Nr.prototype.isEqual=function(t){return this.Lt===t.Lt},Nr);function Nr(t){this.Lt=t}function Tr(t){return null==t}function _r(t){return-0===t&&1/t==-1/0}function Sr(t){var e,n;return"server_timestamp"===(null===(n=((null===(e=null==t?void 0:t.mapValue)||void 0===e?void 0:e.fields)||{}).__type__)||void 0===n?void 0:n.stringValue)}function Rr(t){var e=Ur(t.mapValue.fields.__local_write_time__.timestampValue);return new Bi(e.seconds,e.nanos)}Ir.qt=new Ir("");var kr=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Or(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?Sr(t)?4:10:vu()}function Lr(r,t){var e,n,i,o=Or(r);if(o!==Or(t))return!1;switch(o){case 0:return!0;case 1:return r.booleanValue===t.booleanValue;case 4:return Rr(r).isEqual(Rr(t));case 3:return function(t){if("string"==typeof r.timestampValue&&"string"==typeof t.timestampValue&&r.timestampValue.length===t.timestampValue.length)return r.timestampValue===t.timestampValue;var e=Ur(r.timestampValue),n=Ur(t.timestampValue);return e.seconds===n.seconds&&e.nanos===n.nanos}(t);case 5:return r.stringValue===t.stringValue;case 6:return i=t,xr(r.bytesValue).isEqual(xr(i.bytesValue));case 7:return r.referenceValue===t.referenceValue;case 8:return n=t,Mr((e=r).geoPointValue.latitude)===Mr(n.geoPointValue.latitude)&&Mr(e.geoPointValue.longitude)===Mr(n.geoPointValue.longitude);case 2:return function(t,e){if("integerValue"in t&&"integerValue"in e)return Mr(t.integerValue)===Mr(e.integerValue);if("doubleValue"in t&&"doubleValue"in e){var n=Mr(t.doubleValue),i=Mr(e.doubleValue);return n===i?_r(n)===_r(i):isNaN(n)&&isNaN(i)}return!1}(r,t);case 9:return Eu(r.arrayValue.values||[],t.arrayValue.values||[],Lr);case 10:return function(t){var e=r.mapValue.fields||{},n=t.mapValue.fields||{};if(br(e)!==br(n))return!1;for(var i in e)if(e.hasOwnProperty(i)&&(void 0===n[i]||!Lr(e[i],n[i])))return!1;return!0}(t);default:return vu()}}function Dr(t,e){return void 0!==(t.values||[]).find(function(t){return Lr(t,e)})}function Vr(t,e){var n,i,r,o,s,u,a,h,c,f,l=Or(t),p=Or(e);if(l!==p)return bu(l,p);switch(l){case 0:return 0;case 1:return bu(t.booleanValue,e.booleanValue);case 2:return h=e,c=Mr(t.integerValue||t.doubleValue),f=Mr(h.integerValue||h.doubleValue),c<f?-1:f<c?1:c===f?0:isNaN(c)?isNaN(f)?0:-1:1;case 3:return Cr(t.timestampValue,e.timestampValue);case 4:return Cr(Rr(t),Rr(e));case 5:return bu(t.stringValue,e.stringValue);case 6:return o=t.bytesValue,s=e.bytesValue,u=xr(o),a=xr(s),u.D(a);case 7:return function(t,e){for(var n=t.split("/"),i=e.split("/"),r=0;r<n.length&&r<i.length;r++){var o=bu(n[r],i[r]);if(0!==o)return o}return bu(n.length,i.length)}(t.referenceValue,e.referenceValue);case 8:return n=t.geoPointValue,i=e.geoPointValue,0!==(r=bu(Mr(n.latitude),Mr(i.latitude)))?r:bu(Mr(n.longitude),Mr(i.longitude));case 9:return function(t,e){for(var n=t.values||[],i=e.values||[],r=0;r<n.length&&r<i.length;++r){var o=Vr(n[r],i[r]);if(o)return o}return bu(n.length,i.length)}(t.arrayValue,e.arrayValue);case 10:return function(t,e){var n=t.fields||{},i=Object.keys(n),r=e.fields||{},o=Object.keys(r);i.sort(),o.sort();for(var s=0;s<i.length&&s<o.length;++s){var u=bu(i[s],o[s]);if(0!==u)return u;var a=Vr(n[i[s]],r[o[s]]);if(0!==a)return a}return bu(i.length,o.length)}(t.mapValue,e.mapValue);default:throw vu()}}function Cr(t,e){if("string"==typeof t&&"string"==typeof e&&t.length===e.length)return bu(t,e);var n=Ur(t),i=Ur(e),r=bu(n.seconds,i.seconds);return 0!==r?r:bu(n.nanos,i.nanos)}function Pr(t){return function s(r){return"nullValue"in r?"null":"booleanValue"in r?""+r.booleanValue:"integerValue"in r?""+r.integerValue:"doubleValue"in r?""+r.doubleValue:"timestampValue"in r?"time("+(t=Ur(r.timestampValue)).seconds+","+t.nanos+")":"stringValue"in r?r.stringValue:"bytesValue"in r?xr(r.bytesValue).toBase64():"referenceValue"in r?(n=r.referenceValue,ur.tt(n).toString()):"geoPointValue"in r?"geo("+(e=r.geoPointValue).latitude+","+e.longitude+")":"arrayValue"in r?function(){for(var t="[",e=!0,n=0,i=r.arrayValue.values||[];n<i.length;n++){e?e=!1:t+=",",t+=s(i[n])}return t+"]"}():"mapValue"in r?function(t){for(var e="{",n=!0,i=0,r=Object.keys(t.fields||{}).sort();i<r.length;i++){var o=r[i];n?n=!1:e+=",",e+=o+":"+s(t.fields[o])}return e+"}"}(r.mapValue):vu();var t,e,n}(t)}function Ur(t){if(gu(!!t),"string"!=typeof t)return{seconds:Mr(t.seconds),nanos:Mr(t.nanos)};var e=0,n=kr.exec(t);if(gu(!!n),n[1]){var i=n[1];i=(i+"000000000").substr(0,9),e=Number(i)}var r=new Date(t);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}function Mr(t){return"number"==typeof t?t:"string"==typeof t?Number(t):0}function xr(t){return"string"==typeof t?Ir.fromBase64String(t):Ir.fromUint8Array(t)}function Fr(t,e){return{referenceValue:"projects/"+t.projectId+"/databases/"+t.database+"/documents/"+e.path.G()}}function qr(t){return t&&"integerValue"in t}function Gr(t){return!!t&&"arrayValue"in t}function jr(t){return t&&"nullValue"in t}function Br(t){return t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function zr(t){return t&&"mapValue"in t}var Hr=(Yr.prototype.Bt=function(t,e){return n={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:e.seconds,nanos:e.nanoseconds}}}},t&&(n.fields.__previous_value__=t),{mapValue:n};var n},Yr.prototype.xt=function(t,e){return e},Yr.prototype.Ut=function(t){return null},Yr.prototype.isEqual=function(t){return t instanceof Yr},Yr);function Yr(){}Hr.instance=new Hr;var Qr=(Zr.prototype.Bt=function(t,e){return this.apply(t)},Zr.prototype.xt=function(t,e){return this.apply(t)},Zr.prototype.apply=function(t){for(var n=Jr(t),e=function(e){n.some(function(t){return Lr(t,e)})||n.push(e)},i=0,r=this.elements;i<r.length;i++)e(r[i]);return{arrayValue:{values:n}}},Zr.prototype.Ut=function(t){return null},Zr.prototype.isEqual=function(t){return t instanceof Zr&&Eu(this.elements,t.elements,Lr)},Zr),Wr=($r.prototype.Bt=function(t,e){return this.apply(t)},$r.prototype.xt=function(t,e){return this.apply(t)},$r.prototype.apply=function(t){for(var n=Jr(t),e=function(e){n=n.filter(function(t){return!Lr(t,e)})},i=0,r=this.elements;i<r.length;i++)e(r[i]);return{arrayValue:{values:n}}},$r.prototype.Ut=function(t){return null},$r.prototype.isEqual=function(t){return t instanceof $r&&Eu(this.elements,t.elements,Lr)},$r),Xr=(Kr.prototype.Bt=function(t,e){var n=this.Ut(t),i=this.asNumber(n)+this.asNumber(this.Qt);return qr(n)&&qr(this.Qt)?this.serializer.Wt(i):this.serializer.jt(i)},Kr.prototype.xt=function(t,e){return e},Kr.prototype.Ut=function(t){return qr(e=t)||e&&"doubleValue"in e?t:{integerValue:0};var e},Kr.prototype.isEqual=function(t){return t instanceof Kr&&Lr(this.Qt,t.Qt)},Kr.prototype.asNumber=function(t){return Mr(t.integerValue||t.doubleValue)},Kr);function Kr(t,e){this.serializer=t,this.Qt=e}function $r(t){this.elements=t}function Zr(t){this.elements=t}function Jr(t){return Gr(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}function to(t,e){this.version=t,this.transformResults=e}var eo=(so.Gt=function(t){return new so(t)},so.Kt=function(t){var e=new vr(or.$);return t.forEach(function(t){return e=e.add(t)}),new so(e)},so.prototype.Ht=function(e){var n=!1;return this.fields.forEach(function(t){t.U(e)&&(n=!0)}),n},so.prototype.isEqual=function(t){return this.fields.isEqual(t.fields)},so),no=(oo.prototype.isEqual=function(t){return this.field.isEqual(t.field)&&this.transform.isEqual(t.transform)},oo),io=(ro.exists=function(t){return new ro(void 0,t)},ro.updateTime=function(t){return new ro(t)},Object.defineProperty(ro.prototype,"zt",{get:function(){return void 0===this.updateTime&&void 0===this.exists},enumerable:!0,configurable:!0}),ro.prototype.Yt=function(t){return void 0!==this.updateTime?t instanceof Do&&t.version.isEqual(this.updateTime):void 0===this.exists||this.exists===t instanceof Do},ro.prototype.isEqual=function(t){return this.exists===t.exists&&(this.updateTime?!!t.updateTime&&this.updateTime.isEqual(t.updateTime):!t.updateTime)},ro);function ro(t,e){this.updateTime=t,this.exists=e}function oo(t,e){this.field=t,this.transform=e}function so(t){this.fields=t}io.NONE=new io;var uo,ao,ho,co,fo,lo=(_o.prototype.Xt=function(t){},_o.Jt=function(t){return t instanceof Do?t.version:zi.MIN},_o),po=(n(To,fo=lo),To.prototype.xt=function(t,e){this.Xt(t);var n=e.version;return new Do(this.key,n,this.value,{hasCommittedMutations:!0})},To.prototype.Bt=function(t,e,n){if(this.Xt(t),!this.Zt.Yt(t))return t;var i=lo.Jt(t);return new Do(this.key,i,this.value,{te:!0})},To.prototype.ee=function(t){return null},To.prototype.isEqual=function(t){return t instanceof To&&this.key.isEqual(t.key)&&this.value.isEqual(t.value)&&this.Zt.isEqual(t.Zt)},To),yo=(n(No,co=lo),No.prototype.xt=function(t,e){if(this.Xt(t),!this.Zt.Yt(t))return new Co(this.key,e.version);var n=this.ie(t);return new Do(this.key,e.version,n,{hasCommittedMutations:!0})},No.prototype.Bt=function(t,e,n){if(this.Xt(t),!this.Zt.Yt(t))return t;var i=lo.Jt(t),r=this.ie(t);return new Do(this.key,i,r,{te:!0})},No.prototype.ee=function(t){return null},No.prototype.isEqual=function(t){return t instanceof No&&this.key.isEqual(t.key)&&this.se.isEqual(t.se)&&this.Zt.isEqual(t.Zt)},No.prototype.ie=function(t){var e;return e=t instanceof Do?t.data():wo.EMPTY,this.ne(e)},No.prototype.ne=function(t){var n=this,i=t.re();return this.se.fields.forEach(function(t){if(!t.B()){var e=n.data.field(t);null!==e?i.set(t,e):i.delete(t)}}),i.he()},No),vo=(n(Io,ho=lo),Io.prototype.xt=function(t,e){if(this.Xt(t),gu(null!=e.transformResults),!this.Zt.Yt(t))return new Co(this.key,e.version);var n=this.oe(t),i=this.ae(t,e.transformResults),r=e.version,o=this.ue(n.data(),i);return new Do(this.key,r,o,{hasCommittedMutations:!0})},Io.prototype.Bt=function(t,e,n){if(this.Xt(t),!this.Zt.Yt(t))return t;var i=this.oe(t),r=this.ce(n,t,e),o=this.ue(i.data(),r);return new Do(this.key,i.version,o,{te:!0})},Io.prototype.ee=function(t){for(var e=null,n=0,i=this.fieldTransforms;n<i.length;n++){var r=i[n],o=t instanceof Do?t.field(r.field):void 0,s=r.transform.Ut(o||null);null!=s&&(e=null==e?wo.le().set(r.field,s):e.set(r.field,s))}return e?e.he():null},Io.prototype.isEqual=function(t){return t instanceof Io&&this.key.isEqual(t.key)&&Eu(this.fieldTransforms,t.fieldTransforms,function(t,e){return t.isEqual(e)})&&this.Zt.isEqual(t.Zt)},Io.prototype.oe=function(t){return t},Io.prototype.ae=function(t,e){var n=[];gu(this.fieldTransforms.length===e.length);for(var i=0;i<e.length;i++){var r=this.fieldTransforms[i],o=r.transform,s=null;t instanceof Do&&(s=t.field(r.field)),n.push(o.xt(s,e[i]))}return n},Io.prototype.ce=function(t,e,n){for(var i=[],r=0,o=this.fieldTransforms;r<o.length;r++){var s=o[r],u=s.transform,a=null;e instanceof Do&&(a=e.field(s.field)),null===a&&n instanceof Do&&(a=n.field(s.field)),i.push(u.Bt(a,t))}return i},Io.prototype.ue=function(t,e){for(var n=t.re(),i=0;i<this.fieldTransforms.length;i++){var r=this.fieldTransforms[i].field;n.set(r,e[i])}return n.he()},Io),go=(n(Ao,ao=lo),Ao.prototype.xt=function(t,e){return this.Xt(t),new Vo(this.key,e.version,{hasCommittedMutations:!0})},Ao.prototype.Bt=function(t,e,n){return this.Xt(t),this.Zt.Yt(t)?new Vo(this.key,zi.S()):t},Ao.prototype.ee=function(t){return null},Ao.prototype.isEqual=function(t){return t instanceof Ao&&this.key.isEqual(t.key)&&this.Zt.isEqual(t.Zt)},Ao),mo=(n(Eo,uo=lo),Eo.prototype.xt=function(t,e){vu()},Eo.prototype.Bt=function(t,e,n){vu()},Eo.prototype.ee=function(t){vu()},Eo.prototype.isEqual=function(t){return t instanceof Eo&&this.key.isEqual(t.key)&&this.Zt.isEqual(t.Zt)},Eo),wo=(bo.le=function(){return bo.EMPTY.re()},bo.prototype.field=function(t){if(t.B())return this.proto;for(var e=this.proto,n=0;n<t.length-1;++n){if(!e.mapValue.fields)return null;if(!zr(e=e.mapValue.fields[t.get(n)]))return null}return(e=(e.mapValue.fields||{})[t.q()])||null},bo.prototype.se=function(){return this._e(this.proto.mapValue)},bo.prototype._e=function(t){var r=this,o=new vr(or.$);return Er(t.fields||{},function(t,e){var n=new or([t]);if(10===Or(e)){var i=r._e(e.mapValue).fields;i.B()?o=o.add(n):i.forEach(function(t){o=o.add(n.child(t))})}else o=o.add(n)}),eo.Gt(o)},bo.prototype.isEqual=function(t){return Lr(this.proto,t.proto)},bo.prototype.re=function(){return new Oo(this)},bo);function bo(t){this.proto=t}function Eo(t,e){var n=this;return(n=uo.call(this)||this).key=t,n.Zt=e,n.type=4,n}function Ao(t,e){var n=this;return(n=ao.call(this)||this).key=t,n.Zt=e,n.type=3,n}function Io(t,e){var n=this;return(n=ho.call(this)||this).key=t,n.fieldTransforms=e,n.type=2,n.Zt=io.exists(!0),n}function No(t,e,n,i){var r=this;return(r=co.call(this)||this).key=t,r.data=e,r.se=n,r.Zt=i,r.type=1,r}function To(t,e,n){var i=this;return(i=fo.call(this)||this).key=t,i.value=e,i.Zt=n,i.type=0,i}function _o(){}wo.EMPTY=new wo({mapValue:{}});var So,Ro,ko,Oo=(Ho.prototype.set=function(t,e){return this.we(t,e),this},Ho.prototype.delete=function(t){return this.we(t,null),this},Ho.prototype.we=function(t,e){for(var n=this.de,i=0;i<t.length-1;++i){var r=t.get(i),o=n.get(r);o instanceof Map||(o=o&&10===Or(o)?new Map(Object.entries(o.mapValue.fields||{})):new Map,n.set(r,o)),n=o}n.set(t.q(),e)},Ho.prototype.he=function(){var t=this.Te(or.H,this.de);return null!=t?new wo(t):this.fe},Ho.prototype.Te=function(i,t){var r=this,o=!1,e=this.fe.field(i),s=zr(e)?Object.assign({},e.mapValue.fields):{};return t.forEach(function(t,e){if(t instanceof Map){var n=r.Te(i.child(e),t);null!=n&&(s[e]=n,o=!0)}else null!==t?(s[e]=t,o=!0):s.hasOwnProperty(e)&&(delete s[e],o=!0)}),o?{mapValue:{fields:s}}:null},Ho),Lo=(zo.Ee=function(t,e){return ur.$(t.key,e.key)},zo),Do=(n(Bo,ko=Lo),Bo.prototype.field=function(t){return this.Ie.field(t)},Bo.prototype.data=function(){return this.Ie},Bo.prototype.me=function(){return this.Ie.proto},Bo.prototype.isEqual=function(t){return t instanceof Bo&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.te===t.te&&this.hasCommittedMutations===t.hasCommittedMutations&&this.Ie.isEqual(t.Ie)},Bo.prototype.toString=function(){return"Document("+this.key+", "+this.version+", "+this.Ie.toString()+", {hasLocalMutations: "+this.te+"}), {hasCommittedMutations: "+this.hasCommittedMutations+"})"},Object.defineProperty(Bo.prototype,"hasPendingWrites",{get:function(){return this.te||this.hasCommittedMutations},enumerable:!0,configurable:!0}),Bo.Re=function(t,e,n){var i=e.field(t),r=n.field(t);return null!==i&&null!==r?Vr(i,r):vu()},Bo),Vo=(n(jo,Ro=Lo),jo.prototype.toString=function(){return"NoDocument("+this.key+", "+this.version+")"},Object.defineProperty(jo.prototype,"hasPendingWrites",{get:function(){return this.hasCommittedMutations},enumerable:!0,configurable:!0}),jo.prototype.isEqual=function(t){return t instanceof jo&&t.hasCommittedMutations===this.hasCommittedMutations&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},jo),Co=(n(Go,So=Lo),Go.prototype.toString=function(){return"UnknownDocument("+this.key+", "+this.version+")"},Object.defineProperty(Go.prototype,"hasPendingWrites",{get:function(){return!0},enumerable:!0,configurable:!0}),Go.prototype.isEqual=function(t){return t instanceof Go&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},Go),Po=(qo.prototype.canonicalId=function(){if(null===this.Ae){var t=this.path.G();null!==this.collectionGroup&&(t+="|cg:"+this.collectionGroup),t+="|f:",t+=this.filters.map(function(t){return t.canonicalId()}).join(","),t+="|ob:",t+=this.orderBy.map(function(t){return t.canonicalId()}).join(","),Tr(this.limit)||(t+="|l:",t+=this.limit),this.startAt&&(t+="|lb:",t+=this.startAt.canonicalId()),this.endAt&&(t+="|ub:",t+=this.endAt.canonicalId()),this.Ae=t}return this.Ae},qo.prototype.toString=function(){var t=this.path.G();return null!==this.collectionGroup&&(t+=" collectionGroup="+this.collectionGroup),0<this.filters.length&&(t+=", filters: ["+this.filters.join(", ")+"]"),Tr(this.limit)||(t+=", limit: "+this.limit),0<this.orderBy.length&&(t+=", orderBy: ["+this.orderBy.join(", ")+"]"),this.startAt&&(t+=", startAt: "+this.startAt.canonicalId()),this.endAt&&(t+=", endAt: "+this.endAt.canonicalId()),"Target("+t+")"},qo.prototype.isEqual=function(t){if(this.limit!==t.limit)return!1;if(this.orderBy.length!==t.orderBy.length)return!1;for(var e=0;e<this.orderBy.length;e++)if(!this.orderBy[e].isEqual(t.orderBy[e]))return!1;if(this.filters.length!==t.filters.length)return!1;for(var n=0;n<this.filters.length;n++)if(!this.filters[n].isEqual(t.filters[n]))return!1;return this.collectionGroup===t.collectionGroup&&!!this.path.isEqual(t.path)&&!!(null!==this.startAt?this.startAt.isEqual(t.startAt):null===t.startAt)&&(null!==this.endAt?this.endAt.isEqual(t.endAt):null===t.endAt)},qo.prototype.Pe=function(){return ur.st(this.path)&&null===this.collectionGroup&&0===this.filters.length},qo),Uo=(Fo.ve=function(t){return new Fo(t)},Object.defineProperty(Fo.prototype,"orderBy",{get:function(){if(null===this.ge){var t=this.Se(),e=this.De();if(null!==t&&null===e)t.X()?this.ge=[gs]:this.ge=[new vs(t),gs];else{for(var n=!(this.ge=[]),i=0,r=this.Ve;i<r.length;i++){var o=r[i];this.ge.push(o),o.field.X()&&(n=!0)}if(!n){var s=0<this.Ve.length?this.Ve[this.Ve.length-1].dir:rs.ASCENDING;this.ge.push(s===rs.ASCENDING?gs:ms)}}}return this.ge},enumerable:!0,configurable:!0}),Fo.prototype.Ce=function(t){var e=this.filters.concat([t]);return new Fo(this.path,this.collectionGroup,this.Ve.slice(),e,this.limit,this.pe,this.startAt,this.endAt)},Fo.prototype.Fe=function(t){var e=this.Ve.concat([t]);return new Fo(this.path,this.collectionGroup,e,this.filters.slice(),this.limit,this.pe,this.startAt,this.endAt)},Fo.prototype.Ne=function(t){return new Fo(this.path,this.collectionGroup,this.Ve.slice(),this.filters.slice(),t,"F",this.startAt,this.endAt)},Fo.prototype.$e=function(t){return new Fo(this.path,this.collectionGroup,this.Ve.slice(),this.filters.slice(),t,"L",this.startAt,this.endAt)},Fo.prototype.ke=function(t){return new Fo(this.path,this.collectionGroup,this.Ve.slice(),this.filters.slice(),this.limit,this.pe,t,this.endAt)},Fo.prototype.Le=function(t){return new Fo(this.path,this.collectionGroup,this.Ve.slice(),this.filters.slice(),this.limit,this.pe,this.startAt,t)},Fo.prototype.Oe=function(t){return new Fo(t,null,this.Ve.slice(),this.filters.slice(),this.limit,this.pe,this.startAt,this.endAt)},Fo.prototype.Me=function(){return 0===this.filters.length&&null===this.limit&&null==this.startAt&&null==this.endAt&&(0===this.Ve.length||1===this.Ve.length&&this.Ve[0].field.X())},Fo.prototype.canonicalId=function(){return this.qe().canonicalId()+"|lt:"+this.pe},Fo.prototype.toString=function(){return"Query(target="+this.qe().toString()+"; limitType="+this.pe+")"},Fo.prototype.isEqual=function(t){return this.qe().isEqual(t.qe())&&this.pe===t.pe},Fo.prototype.Be=function(t,e){for(var n=!1,i=0,r=this.orderBy;i<r.length;i++){var o=r[i],s=o.compare(t,e);if(0!==s)return s;n=n||o.field.X()}return 0},Fo.prototype.matches=function(t){return this.xe(t)&&this.Ue(t)&&this.Qe(t)&&this.We(t)},Fo.prototype.je=function(){return!Tr(this.limit)&&"F"===this.pe},Fo.prototype.Ge=function(){return!Tr(this.limit)&&"L"===this.pe},Fo.prototype.De=function(){return 0<this.Ve.length?this.Ve[0].field:null},Fo.prototype.Se=function(){for(var t=0,e=this.filters;t<e.length;t++){var n=e[t];if(n instanceof Zo&&n.Ke())return n.field}return null},Fo.prototype.He=function(t){for(var e=0,n=this.filters;e<n.length;e++){var i=n[e];if(i instanceof Zo&&0<=t.indexOf(i.op))return i.op}return null},Fo.prototype.Pe=function(){return this.qe().Pe()},Fo.prototype.ze=function(){return null!==this.collectionGroup},Fo.prototype.qe=function(){if(!this.ye)if("F"===this.pe)this.ye=new Po(this.path,this.collectionGroup,this.orderBy,this.filters,this.limit,this.startAt,this.endAt);else{for(var t=[],e=0,n=this.orderBy;e<n.length;e++){var i=n[e],r=i.dir===rs.DESCENDING?rs.ASCENDING:rs.DESCENDING;t.push(new vs(i.field,r))}var o=this.endAt?new ys(this.endAt.position,!this.endAt.before):null,s=this.startAt?new ys(this.startAt.position,!this.startAt.before):null;this.ye=new Po(this.path,this.collectionGroup,t,this.filters,this.limit,o,s)}return this.ye},Fo.prototype.xe=function(t){var e=t.key.path;return null!==this.collectionGroup?t.key.et(this.collectionGroup)&&this.path.U(e):ur.st(this.path)?this.path.isEqual(e):this.path.W(e)},Fo.prototype.Ue=function(t){for(var e=0,n=this.Ve;e<n.length;e++){var i=n[e];if(!i.field.X()&&null===t.field(i.field))return!1}return!0},Fo.prototype.Qe=function(t){for(var e=0,n=this.filters;e<n.length;e++)if(!n[e].matches(t))return!1;return!0},Fo.prototype.We=function(t){return!(this.startAt&&!this.startAt.Ye(this.orderBy,t)||this.endAt&&this.endAt.Ye(this.orderBy,t))},Fo.prototype.be=function(t){},Fo),Mo=(xo.K=function(t){switch(t){case"<":return xo.LESS_THAN;case"<=":return xo.LESS_THAN_OR_EQUAL;case"==":return xo.EQUAL;case">=":return xo.GREATER_THAN_OR_EQUAL;case">":return xo.GREATER_THAN;case"array-contains":return xo.ARRAY_CONTAINS;case"in":return xo.IN;case"array-contains-any":return xo.ARRAY_CONTAINS_ANY;default:return vu()}},xo.prototype.toString=function(){return this.name},xo.prototype.isEqual=function(t){return this.name===t.name},xo);function xo(t){this.name=t}function Fo(t,e,n,i,r,o,s,u){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===i&&(i=[]),void 0===r&&(r=null),void 0===o&&(o="F"),void 0===s&&(s=null),void 0===u&&(u=null),this.path=t,this.collectionGroup=e,this.Ve=n,this.filters=i,this.limit=r,this.pe=o,this.startAt=s,this.endAt=u,this.ge=null,this.ye=null,this.startAt&&this.be(this.startAt),this.endAt&&this.be(this.endAt)}function qo(t,e,n,i,r,o,s){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===i&&(i=[]),void 0===r&&(r=null),void 0===o&&(o=null),void 0===s&&(s=null),this.path=t,this.collectionGroup=e,this.orderBy=n,this.filters=i,this.limit=r,this.startAt=o,this.endAt=s,this.Ae=null}function Go(){return null!==So&&So.apply(this,arguments)||this}function jo(t,e,n){var i=this;return(i=Ro.call(this,t,e)||this).hasCommittedMutations=!(!n||!n.hasCommittedMutations),i}function Bo(t,e,n,i){var r=this;return(r=ko.call(this,t,e)||this).Ie=n,r.te=!!i.te,r.hasCommittedMutations=!!i.hasCommittedMutations,r}function zo(t,e){this.key=t,this.version=e}function Ho(t){this.fe=t,this.de=new Map}Mo.LESS_THAN=new Mo("<"),Mo.LESS_THAN_OR_EQUAL=new Mo("<="),Mo.EQUAL=new Mo("=="),Mo.GREATER_THAN=new Mo(">"),Mo.GREATER_THAN_OR_EQUAL=new Mo(">="),Mo.ARRAY_CONTAINS=new Mo("array-contains"),Mo.IN=new Mo("in"),Mo.ARRAY_CONTAINS_ANY=new Mo("array-contains-any");var Yo,Qo,Wo,Xo,Ko,$o,Zo=(n(fs,$o=function(){}),fs.create=function(t,e,n){if(t.X())return e===Mo.IN?new ts(t,n):new Jo(t,e,n);if(jr(n)){if(e!==Mo.EQUAL)throw new xi(Mi.INVALID_ARGUMENT,"Invalid query. Null supports only equality comparisons.");return new fs(t,e,n)}if(Br(n)){if(e!==Mo.EQUAL)throw new xi(Mi.INVALID_ARGUMENT,"Invalid query. NaN supports only equality comparisons.");return new fs(t,e,n)}return e===Mo.ARRAY_CONTAINS?new es(t,n):e===Mo.IN?new ns(t,n):e===Mo.ARRAY_CONTAINS_ANY?new is(t,n):new fs(t,e,n)},fs.prototype.matches=function(t){var e=t.field(this.field);return null!==e&&Or(this.value)===Or(e)&&this.Xe(Vr(e,this.value))},fs.prototype.Xe=function(t){switch(this.op){case Mo.LESS_THAN:return t<0;case Mo.LESS_THAN_OR_EQUAL:return t<=0;case Mo.EQUAL:return 0===t;case Mo.GREATER_THAN:return 0<t;case Mo.GREATER_THAN_OR_EQUAL:return 0<=t;default:return vu()}},fs.prototype.Ke=function(){return 0<=[Mo.LESS_THAN,Mo.LESS_THAN_OR_EQUAL,Mo.GREATER_THAN,Mo.GREATER_THAN_OR_EQUAL].indexOf(this.op)},fs.prototype.canonicalId=function(){return this.field.G()+this.op.toString()+Pr(this.value)},fs.prototype.isEqual=function(t){return t instanceof fs&&this.op.isEqual(t.op)&&this.field.isEqual(t.field)&&Lr(this.value,t.value)},fs.prototype.toString=function(){return this.field.G()+" "+this.op+" "+Pr(this.value)},fs),Jo=(n(cs,Ko=Zo),cs.prototype.matches=function(t){var e=ur.$(t.key,this.key);return this.Xe(e)},cs),ts=(n(hs,Xo=Zo),hs.prototype.matches=function(e){return this.keys.some(function(t){return t.isEqual(e.key)})},hs),es=(n(as,Wo=Zo),as.prototype.matches=function(t){var e=t.field(this.field);return Gr(e)&&Dr(e.arrayValue,this.value)},as),ns=(n(us,Qo=Zo),us.prototype.matches=function(t){var e=t.field(this.field);return null!==e&&Dr(this.value.arrayValue,e)},us),is=(n(ss,Yo=Zo),ss.prototype.matches=function(t){var e=this,n=t.field(this.field);return!(!Gr(n)||!n.arrayValue.values)&&n.arrayValue.values.some(function(t){return Dr(e.value.arrayValue,t)})},ss),rs=(os.prototype.toString=function(){return this.name},os);function os(t){this.name=t}function ss(t,e){return Yo.call(this,t,Mo.ARRAY_CONTAINS_ANY,e)||this}function us(t,e){return Qo.call(this,t,Mo.IN,e)||this}function as(t,e){return Wo.call(this,t,Mo.ARRAY_CONTAINS,e)||this}function hs(t,e){var n=this;return(n=Xo.call(this,t,Mo.IN,e)||this).keys=(e.arrayValue.values||[]).map(function(t){return ur.tt(t.referenceValue)}),n}function cs(t,e,n){var i=this;return(i=Ko.call(this,t,e,n)||this).key=ur.tt(n.referenceValue),i}function fs(t,e,n){var i=this;return(i=$o.call(this)||this).field=t,i.op=e,i.value=n,i}rs.ASCENDING=new rs("asc"),rs.DESCENDING=new rs("desc");function ls(t){this.count=t}var ps,ds,ys=(As.prototype.canonicalId=function(){return(this.before?"b":"a")+":"+this.position.map(function(t){return Pr(t)}).join(",")},As.prototype.Ye=function(t,e){for(var n=0,i=0;i<this.position.length;i++){var r=t[i],o=this.position[i];if(n=r.field.X()?ur.$(ur.tt(o.referenceValue),e.key):Vr(o,e.field(r.field)),r.dir===rs.DESCENDING&&(n*=-1),0!==n)break}return this.before?n<=0:n<0},As.prototype.isEqual=function(t){if(null===t)return!1;if(this.before!==t.before||this.position.length!==t.position.length)return!1;for(var e=0;e<this.position.length;e++)if(!Lr(this.position[e],t.position[e]))return!1;return!0},As),vs=(Es.prototype.compare=function(t,e){var n=this.Je?Do.Ee(t,e):Do.Re(this.field,t,e);switch(this.dir){case rs.ASCENDING:return n;case rs.DESCENDING:return-1*n;default:return vu()}},Es.prototype.canonicalId=function(){return this.field.G()+this.dir.toString()},Es.prototype.toString=function(){return this.field.G()+" ("+this.dir+")"},Es.prototype.isEqual=function(t){return this.dir===t.dir&&this.field.isEqual(t.field)},Es),gs=new vs(or.J(),rs.ASCENDING),ms=new vs(or.J(),rs.DESCENDING),ws=(bs.prototype.es=function(t){return new bs(this.target,this.targetId,this.Ze,t,this.ts,this.lastLimboFreeSnapshotVersion,this.resumeToken)},bs.prototype.ss=function(t,e){return new bs(this.target,this.targetId,this.Ze,this.sequenceNumber,e,this.lastLimboFreeSnapshotVersion,t)},bs.prototype.ns=function(t){return new bs(this.target,this.targetId,this.Ze,this.sequenceNumber,this.ts,t,this.resumeToken)},bs);function bs(t,e,n,i,r,o,s){void 0===r&&(r=zi.MIN),void 0===o&&(o=zi.MIN),void 0===s&&(s=Ir.qt),this.target=t,this.targetId=e,this.Ze=n,this.sequenceNumber=i,this.ts=r,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=s}function Es(t,e){this.field=t,void 0===e&&(e=rs.ASCENDING),this.dir=e,this.Je=t.X()}function As(t,e){this.position=t,this.before=e}function Is(t){switch(t){case Mi.OK:return vu();case Mi.CANCELLED:case Mi.UNKNOWN:case Mi.DEADLINE_EXCEEDED:case Mi.RESOURCE_EXHAUSTED:case Mi.INTERNAL:case Mi.UNAVAILABLE:case Mi.UNAUTHENTICATED:return;case Mi.INVALID_ARGUMENT:case Mi.NOT_FOUND:case Mi.ALREADY_EXISTS:case Mi.PERMISSION_DENIED:case Mi.FAILED_PRECONDITION:case Mi.ABORTED:case Mi.OUT_OF_RANGE:case Mi.UNIMPLEMENTED:case Mi.DATA_LOSS:return 1;default:return vu()}}function Ns(t){if(void 0===t)return du("GRPC error has no .code"),Mi.UNKNOWN;switch(t){case ps.OK:return Mi.OK;case ps.CANCELLED:return Mi.CANCELLED;case ps.UNKNOWN:return Mi.UNKNOWN;case ps.DEADLINE_EXCEEDED:return Mi.DEADLINE_EXCEEDED;case ps.RESOURCE_EXHAUSTED:return Mi.RESOURCE_EXHAUSTED;case ps.INTERNAL:return Mi.INTERNAL;case ps.UNAVAILABLE:return Mi.UNAVAILABLE;case ps.UNAUTHENTICATED:return Mi.UNAUTHENTICATED;case ps.INVALID_ARGUMENT:return Mi.INVALID_ARGUMENT;case ps.NOT_FOUND:return Mi.NOT_FOUND;case ps.ALREADY_EXISTS:return Mi.ALREADY_EXISTS;case ps.PERMISSION_DENIED:return Mi.PERMISSION_DENIED;case ps.FAILED_PRECONDITION:return Mi.FAILED_PRECONDITION;case ps.ABORTED:return Mi.ABORTED;case ps.OUT_OF_RANGE:return Mi.OUT_OF_RANGE;case ps.UNIMPLEMENTED:return Mi.UNIMPLEMENTED;case ps.DATA_LOSS:return Mi.DATA_LOSS;default:return vu()}}(ds=ps=ps||{})[ds.OK=0]="OK",ds[ds.CANCELLED=1]="CANCELLED",ds[ds.UNKNOWN=2]="UNKNOWN",ds[ds.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",ds[ds.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",ds[ds.NOT_FOUND=5]="NOT_FOUND",ds[ds.ALREADY_EXISTS=6]="ALREADY_EXISTS",ds[ds.PERMISSION_DENIED=7]="PERMISSION_DENIED",ds[ds.UNAUTHENTICATED=16]="UNAUTHENTICATED",ds[ds.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",ds[ds.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",ds[ds.ABORTED=10]="ABORTED",ds[ds.OUT_OF_RANGE=11]="OUT_OF_RANGE",ds[ds.UNIMPLEMENTED=12]="UNIMPLEMENTED",ds[ds.INTERNAL=13]="INTERNAL",ds[ds.UNAVAILABLE=14]="UNAVAILABLE",ds[ds.DATA_LOSS=15]="DATA_LOSS";var Ts=new hr(ur.$);function _s(){return Ts}function Ss(){return _s()}var Rs=new hr(ur.$);function ks(){return Rs}var Os=new hr(ur.$);function Ls(){return Os}var Ds=new vr(ur.$);function Vs(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=Ds,i=0,r=t;i<r.length;i++){var o=r[i];n=n.add(o)}return n}var Cs=new vr(bu);function Ps(){return Cs}function Us(t,e,n,i){this.gs=t,this.removedTargetIds=e,this.key=n,this.ys=i}function Ms(t,e){this.targetId=t,this.bs=e}function xs(t,e,n,i){void 0===n&&(n=Ir.qt),void 0===i&&(i=null),this.state=t,this.targetIds=e,this.resumeToken=n,this.cause=i}var Fs=(Zs.os=function(t){return new Zs(t.$)},Zs.prototype.has=function(t){return null!=this.rs.get(t)},Zs.prototype.get=function(t){return this.rs.get(t)},Zs.prototype.first=function(){return this.hs.ot()},Zs.prototype.last=function(){return this.hs.at()},Zs.prototype.B=function(){return this.hs.B()},Zs.prototype.indexOf=function(t){var e=this.rs.get(t);return e?this.hs.indexOf(e):-1},Object.defineProperty(Zs.prototype,"size",{get:function(){return this.hs.size},enumerable:!0,configurable:!0}),Zs.prototype.forEach=function(n){this.hs.ut(function(t,e){return n(t),!1})},Zs.prototype.add=function(t){var e=this.delete(t.key);return e.rt(e.rs.nt(t.key,t),e.hs.nt(t,null))},Zs.prototype.delete=function(t){var e=this.get(t);return e?this.rt(this.rs.remove(t),this.hs.remove(e)):this},Zs.prototype.isEqual=function(t){if(!(t instanceof Zs))return!1;if(this.size!==t.size)return!1;for(var e=this.hs.lt(),n=t.hs.lt();e.It();){var i=e.Et().key,r=n.Et().key;if(!i.isEqual(r))return!1}return!0},Zs.prototype.toString=function(){var e=[];return this.forEach(function(t){e.push(t.toString())}),0===e.length?"DocumentSet ()":"DocumentSet (\n  "+e.join("  \n")+"\n)"},Zs.prototype.rt=function(t,e){var n=new Zs;return n.$=this.$,n.rs=t,n.hs=e,n},Zs),qs=($s.prototype.track=function(t){var e=t.doc.key,n=this.as.get(e);!n||0!==t.type&&3===n.type?this.as=this.as.nt(e,t):3===t.type&&1!==n.type?this.as=this.as.nt(e,{type:n.type,doc:t.doc}):2===t.type&&2===n.type?this.as=this.as.nt(e,{type:2,doc:t.doc}):2===t.type&&0===n.type?this.as=this.as.nt(e,{type:0,doc:t.doc}):1===t.type&&0===n.type?this.as=this.as.remove(e):1===t.type&&2===n.type?this.as=this.as.nt(e,{type:1,doc:n.doc}):0===t.type&&1===n.type?this.as=this.as.nt(e,{type:2,doc:t.doc}):vu()},$s.prototype.us=function(){var n=[];return this.as.ut(function(t,e){n.push(e)}),n},$s),Gs=(Ks.ds=function(t,e,n,i){var r=[];return e.forEach(function(t){r.push({type:0,doc:t})}),new Ks(t,e,Fs.os(e),r,n,i,!0,!1)},Object.defineProperty(Ks.prototype,"hasPendingWrites",{get:function(){return!this.ls.B()},enumerable:!0,configurable:!0}),Ks.prototype.isEqual=function(t){if(!(this.fromCache===t.fromCache&&this._s===t._s&&this.ls.isEqual(t.ls)&&this.query.isEqual(t.query)&&this.docs.isEqual(t.docs)&&this.cs.isEqual(t.cs)))return!1;var e=this.docChanges,n=t.docChanges;if(e.length!==n.length)return!1;for(var i=0;i<e.length;i++)if(e[i].type!==n[i].type||!e[i].doc.isEqual(n[i].doc))return!1;return!0},Ks),js=(Xs.ms=function(t,e){var n=new Map;return n.set(t,Bs.Rs(t,e)),new Xs(zi.MIN,n,Ps(),_s(),Vs())},Xs),Bs=(Ws.Rs=function(t,e){return new Ws(Ir.qt,e,Vs(),Vs(),Vs())},Ws),zs=(Object.defineProperty(Qs.prototype,"As",{get:function(){return this.Cs},enumerable:!0,configurable:!0}),Object.defineProperty(Qs.prototype,"resumeToken",{get:function(){return this.Ds},enumerable:!0,configurable:!0}),Object.defineProperty(Qs.prototype,"Ns",{get:function(){return 0!==this.vs},enumerable:!0,configurable:!0}),Object.defineProperty(Qs.prototype,"$s",{get:function(){return this.Fs},enumerable:!0,configurable:!0}),Qs.prototype.ks=function(t){0<t.Mt()&&(this.Fs=!0,this.Ds=t)},Qs.prototype.Ls=function(){var n=Vs(),i=Vs(),r=Vs();return this.Ss.forEach(function(t,e){switch(e){case 0:n=n.add(t);break;case 2:i=i.add(t);break;case 1:r=r.add(t);break;default:vu()}}),new Bs(this.Ds,this.Cs,n,i,r)},Qs.prototype.Os=function(){this.Fs=!1,this.Ss=tu()},Qs.prototype.Ms=function(t,e){this.Fs=!0,this.Ss=this.Ss.nt(t,e)},Qs.prototype.qs=function(t){this.Fs=!0,this.Ss=this.Ss.remove(t)},Qs.prototype.Bs=function(){this.vs+=1},Qs.prototype.xs=function(){--this.vs},Qs.prototype.Us=function(){this.Fs=!0,this.Cs=!0},Qs),Hs=(Ys.prototype.Hs=function(t){for(var e=0,n=t.gs;e<n.length;e++){var i=n[e];t.ys instanceof Do?this.zs(i,t.ys):t.ys instanceof Vo&&this.Ys(i,t.key,t.ys)}for(var r=0,o=t.removedTargetIds;r<o.length;r++){var s=o[r];this.Ys(s,t.key,t.ys)}},Ys.prototype.Xs=function(n){var i=this;this.Js(n,function(t){var e=i.Zs(t);switch(n.state){case 0:i.ti(t)&&e.ks(n.resumeToken);break;case 1:e.xs(),e.Ns||e.Os(),e.ks(n.resumeToken);break;case 2:e.xs(),e.Ns||i.removeTarget(t);break;case 3:i.ti(t)&&(e.Us(),e.ks(n.resumeToken));break;case 4:i.ti(t)&&(i.ei(t),e.ks(n.resumeToken));break;default:vu()}})},Ys.prototype.Js=function(t,n){var i=this;0<t.targetIds.length?t.targetIds.forEach(n):this.Ws.forEach(function(t,e){i.ti(e)&&n(e)})},Ys.prototype.si=function(t){var e=t.targetId,n=t.bs.count,i=this.ii(e);if(i){var r=i.target;if(r.Pe())if(0===n){var o=new ur(r.path);this.Ys(e,o,new Vo(o,zi.S()))}else gu(1===n);else this.ni(e)!==n&&(this.ei(e),this.Ks=this.Ks.add(e))}},Ys.prototype.ri=function(r){var o=this,s=new Map;this.Ws.forEach(function(t,e){var n=o.ii(e);if(n){if(t.As&&n.target.Pe()){var i=new ur(n.target.path);null!==o.js.get(i)||o.hi(e,i)||o.Ys(e,i,new Vo(i,r))}t.$s&&(s.set(e,t.Ls()),t.Os())}});var i=Vs();this.Gs.forEach(function(t,e){var n=!0;e.Ft(function(t){var e=o.ii(t);return!e||2===e.Ze||(n=!1)}),n&&(i=i.add(t))});var t=new js(r,s,this.Ks,this.js,i);return this.js=_s(),this.Gs=Js(),this.Ks=new vr(bu),t},Ys.prototype.zs=function(t,e){if(this.ti(t)){var n=this.hi(t,e.key)?2:0;this.Zs(t).Ms(e.key,n),this.js=this.js.nt(e.key,e),this.Gs=this.Gs.nt(e.key,this.oi(e.key).add(t))}},Ys.prototype.Ys=function(t,e,n){if(this.ti(t)){var i=this.Zs(t);this.hi(t,e)?i.Ms(e,1):i.qs(e),this.Gs=this.Gs.nt(e,this.oi(e).delete(t)),n&&(this.js=this.js.nt(e,n))}},Ys.prototype.removeTarget=function(t){this.Ws.delete(t)},Ys.prototype.ni=function(t){var e=this.Zs(t).Ls();return this.Qs.ai(t).size+e.Ps.size-e.ps.size},Ys.prototype.Bs=function(t){this.Zs(t).Bs()},Ys.prototype.Zs=function(t){var e=this.Ws.get(t);return e||(e=new zs,this.Ws.set(t,e)),e},Ys.prototype.oi=function(t){var e=this.Gs.get(t);return e||(e=new vr(bu),this.Gs=this.Gs.nt(t,e)),e},Ys.prototype.ti=function(t){var e=null!==this.ii(t);return e||pu("WatchChangeAggregator","Detected inactive target",t),e},Ys.prototype.ii=function(t){var e=this.Ws.get(t);return e&&e.Ns?null:this.Qs.ui(t)},Ys.prototype.ei=function(e){var n=this;this.Ws.set(e,new zs),this.Qs.ai(e).forEach(function(t){n.Ys(e,t,null)})},Ys.prototype.hi=function(t,e){return this.Qs.ai(t).has(e)},Ys);function Ys(t){this.Qs=t,this.Ws=new Map,this.js=_s(),this.Gs=Js(),this.Ks=new vr(bu)}function Qs(){this.vs=0,this.Ss=tu(),this.Ds=Ir.qt,this.Cs=!1,this.Fs=!0}function Ws(t,e,n,i,r){this.resumeToken=t,this.As=e,this.Ps=n,this.Vs=i,this.ps=r}function Xs(t,e,n,i,r){this.ts=t,this.ws=e,this.Ts=n,this.Es=i,this.Is=r}function Ks(t,e,n,i,r,o,s,u){this.query=t,this.docs=e,this.cs=n,this.docChanges=i,this.ls=r,this.fromCache=o,this._s=s,this.fs=u}function $s(){this.as=new hr(ur.$)}function Zs(n){this.$=n?function(t,e){return n(t,e)||ur.$(t.key,e.key)}:function(t,e){return ur.$(t.key,e.key)},this.rs=ks(),this.hs=new hr(this.$)}function Js(){return new hr(ur.$)}function tu(){return new hr(ur.$)}var eu,nu,iu=((nu={})[rs.ASCENDING.name]="ASCENDING",nu[rs.DESCENDING.name]="DESCENDING",nu),ru=((eu={})[Mo.LESS_THAN.name]="LESS_THAN",eu[Mo.LESS_THAN_OR_EQUAL.name]="LESS_THAN_OR_EQUAL",eu[Mo.GREATER_THAN.name]="GREATER_THAN",eu[Mo.GREATER_THAN_OR_EQUAL.name]="GREATER_THAN_OR_EQUAL",eu[Mo.EQUAL.name]="EQUAL",eu[Mo.ARRAY_CONTAINS.name]="ARRAY_CONTAINS",eu[Mo.IN.name]="IN",eu[Mo.ARRAY_CONTAINS_ANY.name]="ARRAY_CONTAINS_ANY",eu),ou=(su.prototype.li=function(t){var e=void 0===t.code?Mi.UNKNOWN:Ns(t.code);return new xi(e,t.message||"")},su.prototype._i=function(t){return this.options.fi||Tr(t)?t:{value:t}},su.prototype.di=function(t){var e;return Tr(e="object"==typeof t?t.value:t)?null:e},su.prototype.Wt=function(t){return{integerValue:""+t}},su.prototype.jt=function(t){if(this.options.fi){if(isNaN(t))return{doubleValue:"NaN"};if(t===1/0)return{doubleValue:"Infinity"};if(t===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:_r(t)?"-0":t}},su.prototype.wi=function(t){return"number"==typeof(e=t)&&Number.isInteger(e)&&!_r(e)&&e<=Number.MAX_SAFE_INTEGER&&e>=Number.MIN_SAFE_INTEGER?this.Wt(t):this.jt(t);var e},su.prototype.F=function(t){return this.options.fi?new Date(1e3*t.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")+"."+("000000000"+t.nanoseconds).slice(-9)+"Z":{seconds:""+t.seconds,nanos:t.nanoseconds}},su.prototype.v=function(t){var e=Ur(t);return new Bi(e.seconds,e.nanos)},su.prototype.Ti=function(t){return this.options.fi?t.toBase64():t.toUint8Array()},su.prototype.Ei=function(t){return this.options.fi?(gu(void 0===t||"string"==typeof t),Ir.fromBase64String(t||"")):(gu(void 0===t||t instanceof Uint8Array),Ir.fromUint8Array(t||new Uint8Array))},su.prototype.toVersion=function(t){return this.F(t.F())},su.prototype.fromVersion=function(t){return gu(!!t),zi.v(this.v(t))},su.prototype.Ii=function(t,e){return this.mi(e||this.ci).child("documents").child(t).G()},su.prototype.Ri=function(t){var e=tr.K(t);return gu(uu(e)),e},su.prototype.Ai=function(t){return this.Ii(t.path)},su.prototype.tt=function(t){var e=this.Ri(t);return gu(e.get(1)===this.ci.projectId),gu(!e.get(3)&&!this.ci.database||e.get(3)===this.ci.database),new ur(this.Pi(e))},su.prototype.Vi=function(t){return this.Ii(t)},su.prototype.pi=function(t){var e=this.Ri(t);return 4===e.length?tr.H:this.Pi(e)},Object.defineProperty(su.prototype,"gi",{get:function(){return new tr(["projects",this.ci.projectId,"databases",this.ci.database]).G()},enumerable:!0,configurable:!0}),su.prototype.mi=function(t){return new tr(["projects",t.projectId,"databases",t.database])},su.prototype.Pi=function(t){return gu(4<t.length&&"documents"===t.get(4)),t.L(5)},su.prototype.yi=function(t,e){return{name:this.Ai(t),fields:e.proto.mapValue.fields}},su.prototype.bi=function(t){return{name:this.Ai(t.key),fields:t.me().mapValue.fields,updateTime:this.F(t.version.F())}},su.prototype.vi=function(t,e){var n=this.tt(t.name),i=this.fromVersion(t.updateTime),r=new wo({mapValue:{fields:t.fields}});return new Do(n,i,r,{hasCommittedMutations:!!e})},su.prototype.Si=function(t){gu(!!t.found),t.found.name,t.found.updateTime;var e=this.tt(t.found.name),n=this.fromVersion(t.found.updateTime),i=new wo({mapValue:{fields:t.found.fields}});return new Do(e,n,i,{})},su.prototype.Di=function(t){gu(!!t.missing),gu(!!t.readTime);var e=this.tt(t.missing),n=this.fromVersion(t.readTime);return new Vo(e,n)},su.prototype.Ci=function(t){return"found"in t?this.Si(t):"missing"in t?this.Di(t):vu()},su.prototype.Fi=function(t){var e;if("targetChange"in t){t.targetChange;var n=this.Ni(t.targetChange.targetChangeType||"NO_CHANGE"),i=t.targetChange.targetIds||[],r=this.Ei(t.targetChange.resumeToken),o=t.targetChange.cause,s=o&&this.li(o);e=new xs(n,i,r,s||null)}else if("documentChange"in t){t.documentChange;var u=t.documentChange;u.document,u.document.name,u.document.updateTime;var a=this.tt(u.document.name),h=this.fromVersion(u.document.updateTime),c=new wo({mapValue:{fields:u.document.fields}}),f=new Do(a,h,c,{}),l=u.targetIds||[],p=u.removedTargetIds||[];e=new Us(l,p,f.key,f)}else if("documentDelete"in t){t.documentDelete;var d=t.documentDelete;d.document;var y=this.tt(d.document),v=d.readTime?this.fromVersion(d.readTime):zi.S(),g=new Vo(y,v),m=d.removedTargetIds||[];e=new Us([],m,g.key,g)}else if("documentRemove"in t){t.documentRemove;var w=t.documentRemove;w.document;var b=this.tt(w.document),E=w.removedTargetIds||[];e=new Us([],E,b,null)}else{if(!("filter"in t))return vu();t.filter;var A=t.filter;A.targetId;var I=A.count||0,N=new ls(I),T=A.targetId;e=new Ms(T,N)}return e},su.prototype.Ni=function(t){return"NO_CHANGE"===t?0:"ADD"===t?1:"REMOVE"===t?2:"CURRENT"===t?3:"RESET"===t?4:vu()},su.prototype.$i=function(t){if(!("targetChange"in t))return zi.MIN;var e=t.targetChange;return e.targetIds&&e.targetIds.length||!e.readTime?zi.MIN:this.fromVersion(e.readTime)},su.prototype.ki=function(t){var e,n=this;if(t instanceof po)e={update:this.yi(t.key,t.value)};else if(t instanceof go)e={delete:this.Ai(t.key)};else if(t instanceof yo)e={update:this.yi(t.key,t.data),updateMask:this.Li(t.se)};else if(t instanceof vo)e={transform:{document:this.Ai(t.key),fieldTransforms:t.fieldTransforms.map(function(t){return n.Oi(t)})}};else{if(!(t instanceof mo))return vu();e={verify:this.Ai(t.key)}}return t.Zt.zt||(e.currentDocument=this.Mi(t.Zt)),e},su.prototype.qi=function(t){var e=this,n=t.currentDocument?this.Bi(t.currentDocument):io.NONE;if(t.update){t.update.name;var i=this.tt(t.update.name),r=new wo({mapValue:{fields:t.update.fields}});if(t.updateMask){var o=this.xi(t.updateMask);return new yo(i,r,o,n)}return new po(i,r,n)}if(t.delete){var s=this.tt(t.delete);return new go(s,n)}if(t.transform){var u=this.tt(t.transform.document),a=t.transform.fieldTransforms.map(function(t){return e.Ui(t)});return gu(!0===n.exists),new vo(u,a)}if(t.verify){var h=this.tt(t.verify);return new mo(h,n)}return vu()},su.prototype.Mi=function(t){return void 0!==t.updateTime?{updateTime:this.toVersion(t.updateTime)}:void 0!==t.exists?{exists:t.exists}:vu()},su.prototype.Bi=function(t){return void 0!==t.updateTime?io.updateTime(this.fromVersion(t.updateTime)):void 0!==t.exists?io.exists(t.exists):io.NONE},su.prototype.Qi=function(t,e){var n=t.updateTime?this.fromVersion(t.updateTime):this.fromVersion(e);n.isEqual(zi.MIN)&&(n=this.fromVersion(e));var i=null;return t.transformResults&&0<t.transformResults.length&&(i=t.transformResults),new to(n,i)},su.prototype.Wi=function(t,e){var n=this;return t&&0<t.length?(gu(void 0!==e),t.map(function(t){return n.Qi(t,e)})):[]},su.prototype.Oi=function(t){var e=t.transform;if(e instanceof Hr)return{fieldPath:t.field.G(),setToServerValue:"REQUEST_TIME"};if(e instanceof Qr)return{fieldPath:t.field.G(),appendMissingElements:{values:e.elements}};if(e instanceof Wr)return{fieldPath:t.field.G(),removeAllFromArray:{values:e.elements}};if(e instanceof Xr)return{fieldPath:t.field.G(),increment:e.Qt};throw vu()},su.prototype.Ui=function(t){var e=null;if("setToServerValue"in t)gu("REQUEST_TIME"===t.setToServerValue),e=Hr.instance;else if("appendMissingElements"in t){var n=t.appendMissingElements.values||[];e=new Qr(n)}else if("removeAllFromArray"in t){var i=t.removeAllFromArray.values||[];e=new Wr(i)}else"increment"in t?e=new Xr(this,t.increment):vu();var r=or.Z(t.fieldPath);return new no(r,e)},su.prototype.ji=function(t){return{documents:[this.Vi(t.path)]}},su.prototype.Gi=function(t){gu(1===t.documents.length);var e=t.documents[0];return Uo.ve(this.pi(e)).qe()},su.prototype.Ki=function(t){var e={structuredQuery:{}},n=t.path;null!==t.collectionGroup?(e.parent=this.Vi(n),e.structuredQuery.from=[{collectionId:t.collectionGroup,allDescendants:!0}]):(e.parent=this.Vi(n.O()),e.structuredQuery.from=[{collectionId:n.q()}]);var i=this.Hi(t.filters);i&&(e.structuredQuery.where=i);var r=this.zi(t.orderBy);r&&(e.structuredQuery.orderBy=r);var o=this._i(t.limit);return null!==o&&(e.structuredQuery.limit=o),t.startAt&&(e.structuredQuery.startAt=this.Yi(t.startAt)),t.endAt&&(e.structuredQuery.endAt=this.Yi(t.endAt)),e},su.prototype.Xi=function(t){var e=this.pi(t.parent),n=t.structuredQuery,i=n.from?n.from.length:0,r=null;if(0<i){gu(1===i);var o=n.from[0];o.allDescendants?r=o.collectionId:e=e.child(o.collectionId)}var s=[];n.where&&(s=this.Ji(n.where));var u=[];n.orderBy&&(u=this.Zi(n.orderBy));var a=null;n.limit&&(a=this.di(n.limit));var h=null;n.startAt&&(h=this.tn(n.startAt));var c=null;return n.endAt&&(c=this.tn(n.endAt)),new Uo(e,r,u,s,a,"F",h,c).qe()},su.prototype.en=function(t){var e=this.sn(t.Ze);return null==e?null:{"goog-listen-tags":e}},su.prototype.sn=function(t){switch(t){case 0:return null;case 1:return"existence-filter-mismatch";case 2:return"limbo-document";default:return vu()}},su.prototype.qe=function(t){var e,n=t.target;return(e=n.Pe()?{documents:this.ji(n)}:{query:this.Ki(n)}).targetId=t.targetId,0<t.resumeToken.Mt()&&(e.resumeToken=this.Ti(t.resumeToken)),e},su.prototype.Hi=function(t){var e=this;if(0!==t.length){var n=t.map(function(t){return t instanceof Zo?e.in(t):vu()});return 1===n.length?n[0]:{compositeFilter:{op:"AND",filters:n}}}},su.prototype.Ji=function(t){var e=this;return t?void 0!==t.unaryFilter?[this.nn(t)]:void 0!==t.fieldFilter?[this.rn(t)]:void 0!==t.compositeFilter?t.compositeFilter.filters.map(function(t){return e.Ji(t)}).reduce(function(t,e){return t.concat(e)}):vu():[]},su.prototype.zi=function(t){var e=this;if(0!==t.length)return t.map(function(t){return e.hn(t)})},su.prototype.Zi=function(t){var e=this;return t.map(function(t){return e.on(t)})},su.prototype.Yi=function(t){return{before:t.before,values:t.position}},su.prototype.tn=function(t){var e=!!t.before,n=t.values||[];return new ys(n,e)},su.prototype.an=function(t){return iu[t.name]},su.prototype.un=function(t){switch(t){case"ASCENDING":return rs.ASCENDING;case"DESCENDING":return rs.DESCENDING;default:return}},su.prototype.cn=function(t){return ru[t.name]},su.prototype.ln=function(t){switch(t){case"EQUAL":return Mo.EQUAL;case"GREATER_THAN":return Mo.GREATER_THAN;case"GREATER_THAN_OR_EQUAL":return Mo.GREATER_THAN_OR_EQUAL;case"LESS_THAN":return Mo.LESS_THAN;case"LESS_THAN_OR_EQUAL":return Mo.LESS_THAN_OR_EQUAL;case"ARRAY_CONTAINS":return Mo.ARRAY_CONTAINS;case"IN":return Mo.IN;case"ARRAY_CONTAINS_ANY":return Mo.ARRAY_CONTAINS_ANY;case"OPERATOR_UNSPECIFIED":default:return vu()}},su.prototype._n=function(t){return{fieldPath:t.G()}},su.prototype.fn=function(t){return or.Z(t.fieldPath)},su.prototype.hn=function(t){return{field:this._n(t.field),direction:this.an(t.dir)}},su.prototype.on=function(t){return new vs(this.fn(t.field),this.un(t.direction))},su.prototype.rn=function(t){return Zo.create(this.fn(t.fieldFilter.field),this.ln(t.fieldFilter.op),t.fieldFilter.value)},su.prototype.in=function(t){if(t.op===Mo.EQUAL){if(Br(t.value))return{unaryFilter:{field:this._n(t.field),op:"IS_NAN"}};if(jr(t.value))return{unaryFilter:{field:this._n(t.field),op:"IS_NULL"}}}return{fieldFilter:{field:this._n(t.field),op:this.cn(t.op),value:t.value}}},su.prototype.nn=function(t){switch(t.unaryFilter.op){case"IS_NAN":var e=this.fn(t.unaryFilter.field);return Zo.create(e,Mo.EQUAL,{doubleValue:NaN});case"IS_NULL":var n=this.fn(t.unaryFilter.field);return Zo.create(n,Mo.EQUAL,{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":default:return vu()}},su.prototype.Li=function(t){var e=[];return t.fields.forEach(function(t){return e.push(t.G())}),{fieldPaths:e}},su.prototype.xi=function(t){var e=(t.fieldPaths||[]).map(function(t){return or.Z(t)});return eo.Kt(e)},su);function su(t,e){this.ci=t,this.options=e}function uu(t){return 4<=t.length&&"projects"===t.get(0)&&"databases"===t.get(2)}var au=(cu.dn=function(t){cu.platform&&vu(),cu.platform=t},cu.Ot=function(){return cu.platform||vu(),cu.platform},cu),hu=new l("@firebase/firestore");function cu(){}function fu(){return hu.logLevel}function lu(t){hu.logLevel=t}function pu(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(hu.logLevel<=u.DEBUG){var i=e.map(yu);hu.debug.apply(hu,r(["Firestore ("+Di+"): "+t],i))}}function du(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(hu.logLevel<=u.ERROR){var i=e.map(yu);hu.error.apply(hu,r(["Firestore ("+Di+"): "+t],i))}}function yu(t){if("string"==typeof t)return t;var e=au.Ot();try{return e.wn(t)}catch(e){return t}}function vu(t){void 0===t&&(t="Unexpected state");var e="FIRESTORE ("+Di+") INTERNAL ASSERTION FAILED: "+t;throw du(e),new Error(e)}function gu(t){t||vu()}var mu=(wu.Tn=function(){for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",e="",n=0;n<20;n++)e+=t.charAt(Math.floor(Math.random()*t.length));return e},wu);function wu(){}function bu(t,e){return t<e?-1:e<t?1:0}function Eu(t,n,i){return t.length===n.length&&t.every(function(t,e){return i(t,n[e])})}function Au(t,e,n,i,r){this.ci=t,this.persistenceKey=e,this.host=n,this.ssl=i,this.forceLongPolling=r}var Iu=(Object.defineProperty(ju.prototype,"En",{get:function(){return"(default)"===this.database},enumerable:!0,configurable:!0}),ju.prototype.isEqual=function(t){return t instanceof ju&&t.projectId===this.projectId&&t.database===this.database},ju.prototype.D=function(t){return bu(this.projectId,t.projectId)||bu(this.database,t.database)},ju),Nu=(Gu.prototype.get=function(t){var e=this.In(t),n=this.mn[e];if(void 0!==n)for(var i=0,r=n;i<r.length;i++){var o=r[i],s=o[0],u=o[1];if(s.isEqual(t))return u}},Gu.prototype.has=function(t){return void 0!==this.get(t)},Gu.prototype.set=function(t,e){var n=this.In(t),i=this.mn[n];if(void 0!==i){for(var r=0;r<i.length;r++)if(i[r][0].isEqual(t))return void(i[r]=[t,e]);i.push([t,e])}else this.mn[n]=[[t,e]]},Gu.prototype.delete=function(t){var e=this.In(t),n=this.mn[e];if(void 0===n)return!1;for(var i=0;i<n.length;i++)if(n[i][0].isEqual(t))return 1===n.length?delete this.mn[e]:n.splice(i,1),!0;return!1},Gu.prototype.forEach=function(u){Er(this.mn,function(t,e){for(var n=0,i=e;n<i.length;n++){var r=i[n],o=r[0],s=r[1];u(o,s)}})},Gu.prototype.B=function(){return Ar(this.mn)},Gu),Tu=(qu.prototype.xt=function(t,e,n){for(var i=n.An,r=0;r<this.mutations.length;r++){var o=this.mutations[r];if(o.key.isEqual(t)){var s=i[r];e=o.xt(e,s)}}return e},qu.prototype.Bt=function(t,e){for(var n=0,i=this.baseMutations;n<i.length;n++){var r=i[n];r.key.isEqual(t)&&(e=r.Bt(e,e,this.Rn))}for(var o=e,s=0,u=this.mutations;s<u.length;s++){var a=u[s];a.key.isEqual(t)&&(e=a.Bt(e,o,this.Rn))}return e},qu.prototype.Pn=function(n){var i=this,r=n;return this.mutations.forEach(function(t){var e=i.Bt(t.key,n.get(t.key));e&&(r=r.nt(t.key,e))}),r},qu.prototype.keys=function(){return this.mutations.reduce(function(t,e){return t.add(e.key)},Vs())},qu.prototype.isEqual=function(t){return this.batchId===t.batchId&&Eu(this.mutations,t.mutations,function(t,e){return t.isEqual(e)})&&Eu(this.baseMutations,t.baseMutations,function(t,e){return t.isEqual(e)})},qu),_u=(Fu.from=function(t,e,n,i){gu(t.mutations.length===n.length);for(var r=Ls(),o=t.mutations,s=0;s<o.length;s++)r=r.nt(o[s].key,n[s].version);return new Fu(t,e,n,i,r)},Fu),Su=(xu.prototype.B=function(){return this.gn.B()},xu.prototype.vn=function(t,e){var n=new Ru(t,e);this.gn=this.gn.add(n),this.yn=this.yn.add(n)},xu.prototype.Sn=function(t,e){var n=this;t.forEach(function(t){return n.vn(t,e)})},xu.prototype.Dn=function(t,e){this.Cn(new Ru(t,e))},xu.prototype.Fn=function(t,e){var n=this;t.forEach(function(t){return n.Dn(t,e)})},xu.prototype.Nn=function(t){var e=this,n=ur.EMPTY,i=new Ru(n,t),r=new Ru(n,t+1),o=[];return this.yn.Ct([i,r],function(t){e.Cn(t),o.push(t.key)}),o},xu.prototype.$n=function(){var e=this;this.gn.forEach(function(t){return e.Cn(t)})},xu.prototype.Cn=function(t){this.gn=this.gn.delete(t),this.yn=this.yn.delete(t)},xu.prototype.kn=function(t){var e=ur.EMPTY,n=new Ru(e,t),i=new Ru(e,t+1),r=Vs();return this.yn.Ct([n,i],function(t){r=r.add(t.key)}),r},xu.prototype.Ln=function(t){var e=new Ru(t,0),n=this.gn.Nt(e);return null!==n&&t.isEqual(n.key)},xu),Ru=(Mu.Ee=function(t,e){return ur.$(t.key,e.key)||bu(t.On,e.On)},Mu.bn=function(t,e){return bu(t.On,e.On)||ur.$(t.key,e.key)},Mu),ku=(Uu.prototype.catch=function(t){return this.next(void 0,t)},Uu.prototype.next=function(i,r){var o=this;return this.xn&&vu(),this.xn=!0,this.Bn?this.error?this.Un(r,this.error):this.Qn(i,this.result):new Uu(function(e,n){o.Mn=function(t){o.Qn(i,t).next(e,n)},o.qn=function(t){o.Un(r,t).next(e,n)}})},Uu.prototype.Wn=function(){var n=this;return new Promise(function(t,e){n.next(t,e)})},Uu.prototype.jn=function(t){try{var e=t();return e instanceof Uu?e:Uu.resolve(e)}catch(t){return Uu.reject(t)}},Uu.prototype.Qn=function(t,e){return t?this.jn(function(){return t(e)}):Uu.resolve(e)},Uu.prototype.Un=function(t,e){return t?this.jn(function(){return t(e)}):Uu.reject(e)},Uu.resolve=function(n){return new Uu(function(t,e){t(n)})},Uu.reject=function(n){return new Uu(function(t,e){e(n)})},Uu.Gn=function(t){return new Uu(function(e,n){var i=0,r=0,o=!1;t.forEach(function(t){++i,t.next(function(){++r,o&&r===i&&e()},function(t){return n(t)})}),o=!0,r===i&&e()})},Uu.Kn=function(t){for(var n=Uu.resolve(!1),e=function(e){n=n.next(function(t){return t?Uu.resolve(t):e()})},i=0,r=t;i<r.length;i++)e(r[i]);return n},Uu.forEach=function(t,n){var i=this,r=[];return t.forEach(function(t,e){r.push(n.call(i,t,e))}),this.Gn(r)},Uu),Ou=(Pu.prototype.Xn=function(e,n){var i=this;return this.zn.Jn(e,n).next(function(t){return i.Zn(e,n,t)})},Pu.prototype.Zn=function(t,i,r){return this.Hn.tr(t,i).next(function(t){for(var e=0,n=r;e<n.length;e++)t=n[e].Bt(i,t);return t})},Pu.prototype.er=function(t,e,r){var o=Ss();return e.forEach(function(t,e){for(var n=0,i=r;n<i.length;n++)e=i[n].Bt(t,e);o=o.nt(t,e)}),o},Pu.prototype.sr=function(e,t){var n=this;return this.Hn.getEntries(e,t).next(function(t){return n.ir(e,t)})},Pu.prototype.ir=function(i,r){var o=this;return this.zn.nr(i,r).next(function(t){var e=o.er(i,r,t),n=_s();return e.forEach(function(t,e){e=e||new Vo(t,zi.S()),n=n.nt(t,e)}),n})},Pu.prototype.rr=function(t,e,n){return e.Pe()?this.hr(t,e.path):e.ze()?this.or(t,e,n):this.ar(t,e,n)},Pu.prototype.hr=function(t,e){return this.Xn(t,new ur(e)).next(function(t){var e=ks();return t instanceof Do&&(e=e.nt(t.key,t)),e})},Pu.prototype.or=function(n,i,r){var o=this,s=i.collectionGroup,u=ks();return this.Yn.ur(n,s).next(function(t){return ku.forEach(t,function(t){var e=i.Oe(t.child(s));return o.ar(n,e,r).next(function(t){t.forEach(function(t,e){u=u.nt(t,e)})})}).next(function(){return u})})},Pu.prototype.ar=function(e,n,t){var c,f,i=this;return this.Hn.rr(e,n,t).next(function(t){return c=t,i.zn.cr(e,n)}).next(function(t){return f=t,i.lr(e,f,c).next(function(t){c=t;for(var e=0,n=f;e<n.length;e++)for(var i=n[e],r=0,o=i.mutations;r<o.length;r++){var s=o[r],u=s.key,a=c.get(u),h=s.Bt(a,a,i.Rn);c=h instanceof Do?c.nt(u,h):c.remove(u)}})}).next(function(){return c.forEach(function(t,e){n.matches(e)||(c=c.remove(t))}),c})},Pu.prototype.lr=function(t,e,n){for(var i=Vs(),r=0,o=e;r<o.length;r++)for(var s=0,u=o[r].mutations;s<u.length;s++){var a=u[s];a instanceof yo&&null===n.get(a.key)&&(i=i.add(a.key))}var h=n;return this.Hn.getEntries(t,i).next(function(t){return t.forEach(function(t,e){null!==e&&e instanceof Do&&(h=h.nt(t,e))}),h})},Pu),Lu=(Cu.wr=function(t,e){for(var n=Vs(),i=Vs(),r=0,o=e.docChanges;r<o.length;r++){var s=o[r];switch(s.type){case 0:n=n.add(s.doc.key);break;case 1:i=i.add(s.doc.key)}}return new Cu(t,e.fromCache,n,i)},Cu),Du=(Vu.prototype.Er=function(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue},Vu.prototype.next=function(){var t=++this.previousValue;return this.Ir&&this.Ir(t),t},Vu);function Vu(t,e){var n=this;this.previousValue=t,e&&(e.Tr=function(t){return n.Er(t)},this.Ir=function(t){return e.mr(t)})}function Cu(t,e,n,i){this.targetId=t,this.fromCache=e,this._r=n,this.dr=i}function Pu(t,e,n){this.Hn=t,this.zn=e,this.Yn=n}function Uu(t){var e=this;this.Mn=null,this.qn=null,this.result=void 0,this.error=void 0,this.Bn=!1,this.xn=!1,t(function(t){e.Bn=!0,e.result=t,e.Mn&&e.Mn(t)},function(t){e.Bn=!0,e.error=t,e.qn&&e.qn(t)})}function Mu(t,e){this.key=t,this.On=e}function xu(){this.gn=new vr(Ru.Ee),this.yn=new vr(Ru.bn)}function Fu(t,e,n,i,r){this.batch=t,this.Vn=e,this.An=n,this.streamToken=i,this.pn=r}function qu(t,e,n,i){this.batchId=t,this.Rn=e,this.baseMutations=n,this.mutations=i}function Gu(t){this.In=t,this.mn={}}function ju(t,e){this.projectId=t,this.database=e||"(default)"}Du.Rr=-1;function Bu(){var n=this;this.promise=new Promise(function(t,e){n.resolve=t,n.reject=e})}var zu=($u.prototype.reset=function(){this.yr=0},$u.prototype.Sr=function(){this.yr=this.gr},$u.prototype.Dr=function(t){var e=this;this.cancel();var n=Math.floor(this.yr+this.Cr()),i=Math.max(0,Date.now()-this.vr),r=Math.max(0,n-i);0<r&&pu("ExponentialBackoff","Backing off for "+r+" ms (base delay: "+this.yr+" ms, delay with jitter: "+n+" ms, last attempt: "+i+" ms ago)"),this.br=this.Ar.Fr(this.Pr,r,function(){return e.vr=Date.now(),t()}),this.yr*=this.pr,this.yr<this.Vr&&(this.yr=this.Vr),this.yr>this.gr&&(this.yr=this.gr)},$u.prototype.cancel=function(){null!==this.br&&(this.br.cancel(),this.br=null)},$u.prototype.Cr=function(){return(Math.random()-.5)*this.yr},$u),Hu=(Ku.Or=function(t,e,n,i,r){var o=new Ku(t,e,Date.now()+n,i,r);return o.start(n),o},Ku.prototype.start=function(t){var e=this;this.Mr=setTimeout(function(){return e.qr()},t)},Ku.prototype.Br=function(){return this.qr()},Ku.prototype.cancel=function(t){null!==this.Mr&&(this.clearTimeout(),this.Lr.reject(new xi(Mi.CANCELLED,"Operation cancelled"+(t?": "+t:""))))},Ku.prototype.qr=function(){var e=this;this.Nr.xr(function(){return null!==e.Mr?(e.clearTimeout(),e.op().then(function(t){return e.Lr.resolve(t)})):Promise.resolve()})},Ku.prototype.clearTimeout=function(){null!==this.Mr&&(this.kr(this),clearTimeout(this.Mr),this.Mr=null)},Ku),Yu=(Object.defineProperty(Xu.prototype,"Jr",{get:function(){return this.Wr},enumerable:!0,configurable:!0}),Xu.prototype.xr=function(t){this.enqueue(t)},Xu.prototype.Zr=function(t){this.th(),this.eh(t)},Xu.prototype.sh=function(t){return this.th(),this.eh(t)},Xu.prototype.ih=function(n){return c(this,void 0,void 0,function(){var e;return f(this,function(t){switch(t.label){case 0:return this.th(),this.Wr?[3,2]:(this.Wr=!0,(e=au.Ot().window)&&e.removeEventListener("visibilitychange",this.Yr),[4,this.sh(n)]);case 1:t.sent(),t.label=2;case 2:return[2]}})})},Xu.prototype.enqueue=function(t){return this.th(),this.Wr?new Promise(function(t){}):this.eh(t)},Xu.prototype.nh=function(r){var t=this;this.th(),this.Wr||(this.Qr=this.Qr.then(function(){var n=new Bu,i=function(){return c(t,void 0,void 0,function(){var e;return f(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,r()];case 1:return t.sent(),n.resolve(),this.zr.reset(),[3,3];case 2:if("IndexedDbTransactionError"!==(e=t.sent()).name)throw n.resolve(),e;return pu("AsyncQueue","Operation failed with retryable error: "+e),this.zr.Dr(i),[3,3];case 3:return[2]}})})};return t.xr(i),n.promise}))},Xu.prototype.eh=function(t){var e=this,n=this.Ur.then(function(){return e.Kr=!0,t().catch(function(t){throw e.Gr=t,e.Kr=!1,du("INTERNAL UNHANDLED ERROR: ",t.stack||t.message||""),t}).then(function(t){return e.Kr=!1,t})});return this.Ur=n},Xu.prototype.Fr=function(t,e,n){var i=this;this.th(),-1<this.Hr.indexOf(t)&&(e=0);var r=Hu.Or(this,t,e,n,function(t){return i.rh(t)});return this.jr.push(r),r},Xu.prototype.th=function(){this.Gr&&vu()},Xu.prototype.hh=function(){},Xu.prototype.oh=function(){return c(this,void 0,void 0,function(){var e;return f(this,function(t){switch(t.label){case 0:return[4,e=this.Ur];case 1:t.sent(),t.label=2;case 2:if(e!==this.Ur)return[3,0];t.label=3;case 3:return[2]}})})},Xu.prototype.ah=function(t){for(var e=0,n=this.jr;e<n.length;e++)if(n[e].Pr===t)return!0;return!1},Xu.prototype.Xr=function(i){var r=this;return this.oh().then(function(){r.jr.sort(function(t,e){return t.$r-e.$r});for(var t=0,e=r.jr;t<e.length;t++){var n=e[t];if(n.Br(),"all"!==i&&n.Pr===i)break}return r.oh()})},Xu.prototype.uh=function(t){this.Hr.push(t)},Xu.prototype.rh=function(t){var e=this.jr.indexOf(t);this.jr.splice(e,1)},Xu),Qu=(Wu.dh=function(t){return new Wu(t,Wu.wh,Wu.Th)},Wu);function Wu(t,e,n){this.lh=t,this._h=e,this.fh=n}function Xu(){var t=this;this.Ur=Promise.resolve(),this.Qr=Promise.resolve(),this.Wr=!1,this.jr=[],this.Gr=null,this.Kr=!1,this.Hr=[],this.zr=new zu(this,"async_queue_retry"),this.Yr=function(){t.Xr("async_queue_retry")};var e=au.Ot().window;e&&e.addEventListener("visibilitychange",this.Yr)}function Ku(t,e,n,i,r){this.Nr=t,this.Pr=e,this.$r=n,this.op=i,this.kr=r,this.Lr=new Bu,this.then=this.Lr.promise.then.bind(this.Lr.promise),this.catch=this.Lr.promise.catch.bind(this.Lr.promise),this.Lr.promise.catch(function(t){})}function $u(t,e,n,i,r){void 0===n&&(n=1e3),void 0===i&&(i=1.5),void 0===r&&(r=6e4),this.Ar=t,this.Pr=e,this.Vr=n,this.pr=i,this.gr=r,this.yr=0,this.br=null,this.vr=Date.now(),this.reset()}Qu.Eh=-1,Qu.Ih=1048576,Qu.mh=41943040,Qu.wh=10,Qu.Th=1e3,Qu.Rh=new Qu(Qu.mh,Qu.wh,Qu.Th),Qu.DISABLED=new Qu(Qu.Eh,0,0);var Zu=(oa.prototype.next=function(){return this.Ah+=2,this.Ah},oa.Ph=function(){return new oa(0)},oa.Vh=function(){return new oa(-1)},oa),Ju=(ra.prototype.gh=function(t,e){return this.ph.add(e),ku.resolve()},ra.prototype.ur=function(t,e){return ku.resolve(this.ph.getEntries(e))},ra),ta=(ia.prototype.add=function(t){var e=t.q(),n=t.O(),i=this.index[e]||new vr(tr.$),r=!i.has(n);return this.index[e]=i.add(n),r},ia.prototype.has=function(t){var e=t.q(),n=t.O(),i=this.index[e];return i&&i.has(n)},ia.prototype.getEntries=function(t){return(this.index[t]||new vr(tr.$)).j()},ia),ea=(na.prototype.start=function(){return Promise.resolve()},na.prototype.xh=function(r){return c(this,void 0,void 0,function(){var e,m,n,i=this;return f(this,function(t){switch(t.label){case 0:return e=this.zn,m=this.Mh,[4,this.persistence.runTransaction("Handle user change","readonly",function(v){var g;return i.zn.Uh(v).next(function(t){return g=t,e=i.persistence.Nh(r),m=new Ou(i.$h,e,i.persistence.qh()),e.Uh(v)}).next(function(t){for(var e=[],n=[],i=Vs(),r=0,o=g;r<o.length;r++){var s=o[r];e.push(s.batchId);for(var u=0,a=s.mutations;u<a.length;u++){var h=a[u];i=i.add(h.key)}}for(var c=0,f=t;c<f.length;c++){var l=f[c];n.push(l.batchId);for(var p=0,d=l.mutations;p<d.length;p++){var y=d[p];i=i.add(y.key)}}return m.sr(v,i).next(function(t){return{Qh:t,Wh:e,jh:n}})})})];case 1:return n=t.sent(),[2,(this.zn=e,this.Mh=m,this.yh.Bh(this.Mh),n)]}})})},na.prototype.Gh=function(u){var a,h=this,c=Bi.now(),t=u.reduce(function(t,e){return t.add(e.key)},Vs());return this.persistence.runTransaction("Locally write mutations","readwrite",function(s){return h.Mh.sr(s,t).next(function(t){a=t;for(var e=[],n=0,i=u;n<i.length;n++){var r=i[n],o=r.ee(a.get(r.key));null!=o&&e.push(new yo(r.key,o,o.se(),io.exists(!0)))}return h.zn.Kh(s,c,e,u)})}).then(function(t){var e=t.Pn(a);return{batchId:t.batchId,Hh:e}})},na.prototype.zh=function(i){var r=this;return this.persistence.runTransaction("Acknowledge batch","readwrite-primary",function(t){var e=i.batch.keys(),n=r.$h.Yh({Xh:!0});return r.zn.zh(t,i.batch,i.streamToken).next(function(){return r.Jh(t,i,n)}).next(function(){return n.apply(t)}).next(function(){return r.zn.Zh(t)}).next(function(){return r.Mh.sr(t,e)})})},na.prototype.to=function(t){var i=this;return this.persistence.runTransaction("Reject batch","readwrite-primary",function(e){var n;return i.zn.eo(e,t).next(function(t){return gu(null!==t),n=t.keys(),i.zn.so(e,t)}).next(function(){return i.zn.Zh(e)}).next(function(){return i.Mh.sr(e,n)})})},na.prototype.io=function(){var e=this;return this.persistence.runTransaction("Get highest unacknowledged batch id","readonly",function(t){return e.zn.io(t)})},na.prototype.no=function(){var e=this;return this.persistence.runTransaction("Get last stream token","readonly",function(t){return e.zn.no(t)})},na.prototype.ro=function(e){var n=this;return this.persistence.runTransaction("Set last stream token","readwrite-primary",function(t){return n.zn.ro(t,e)})},na.prototype.ho=function(){var e=this;return this.persistence.runTransaction("Get last remote snapshot version","readonly",function(t){return e.Lh.ho(t)})},na.prototype.oo=function(a){var h=this,c=a.ts,f=this.vh;return this.persistence.runTransaction("Apply remote event","readwrite-primary",function(o){var r=h.$h.Yh({Xh:!0});f=h.vh;var s=[];a.ws.forEach(function(t,e){var n=f.get(e);if(n){s.push(h.Lh.ao(o,t.ps,e).next(function(){return h.Lh.uo(o,t.Ps,e)}));var i=t.resumeToken;if(0<i.Mt()){var r=n.ss(i,c).es(o.co);f=f.nt(e,r),na.lo(n,r,t)&&s.push(h.Lh._o(o,r))}}});var u=_s(),n=Vs();if(a.Es.forEach(function(t,e){n=n.add(t)}),s.push(r.getEntries(o,n).next(function(i){a.Es.forEach(function(t,e){var n=i.get(t);e instanceof Vo&&e.version.isEqual(zi.MIN)?(r.fo(t,c),u=u.nt(t,e)):null==n||0<e.version.D(n.version)||0===e.version.D(n.version)&&n.hasPendingWrites?(r.do(e,c),u=u.nt(t,e)):pu("LocalStore","Ignoring outdated watch update for ",t,". Current version:",n.version," Watch version:",e.version),a.Is.has(t)&&s.push(h.persistence.Fh.wo(o,t))})})),!c.isEqual(zi.MIN)){var t=h.Lh.ho(o).next(function(t){return h.Lh.To(o,o.co,c)});s.push(t)}return ku.Gn(s).next(function(){return r.apply(o)}).next(function(){return h.Mh.ir(o,u)})}).then(function(t){return h.vh=f,t})},na.lo=function(t,e,n){return gu(0<e.resumeToken.Mt()),0===t.resumeToken.Mt()||e.ts.C()-t.ts.C()>=this.Eo||0<n.Ps.size+n.Vs.size+n.ps.size},na.prototype.Io=function(t){for(var n=this,e=0,i=t;e<i.length;e++){var r=i[e],o=r.targetId;if(this.bh.Sn(r._r,o),this.bh.Fn(r.dr,o),!r.fromCache){var s=this.vh.get(o),u=s.ts,a=s.ns(u);this.vh=this.vh.nt(o,a)}}return this.persistence.runTransaction("notifyLocalViewChanges","readwrite",function(e){return ku.forEach(t,function(t){return ku.forEach(t.dr,function(t){return n.persistence.Fh.Dn(e,t)})})})},na.prototype.mo=function(e){var n=this;return this.persistence.runTransaction("Get next mutation batch","readonly",function(t){return void 0===e&&(e=-1),n.zn.Ro(t,e)})},na.prototype.Ao=function(e){var n=this;return this.persistence.runTransaction("read document","readonly",function(t){return n.Mh.Xn(t,e)})},na.prototype.Po=function(i){var r=this;return this.persistence.runTransaction("Allocate target","readwrite",function(e){var n;return r.Lh.Vo(e,i).next(function(t){return t?(n=t,ku.resolve(n)):r.Lh.po(e).next(function(t){return n=new ws(i,t,0,e.co),r.Lh.yo(e,n).next(function(){return n})})})}).then(function(t){return null===r.vh.get(t.targetId)&&(r.vh=r.vh.nt(t.targetId,t),r.Sh.set(i,t.targetId)),t})},na.prototype.Vo=function(t,e){var n=this.Sh.get(e);return void 0!==n?ku.resolve(this.vh.get(n)):this.Lh.Vo(t,e)},na.prototype.bo=function(n,i){var r=this,o=this.vh.get(n),t=i?"readwrite":"readwrite-primary";return this.persistence.runTransaction("Release target",t,function(e){var t=r.bh.Nn(n);return i?ku.resolve():ku.forEach(t,function(t){return r.persistence.Fh.Dn(e,t)}).next(function(){r.persistence.Fh.removeTarget(e,o)})}).then(function(){r.vh=r.vh.remove(n),r.Sh.delete(o.target)})},na.prototype.vo=function(t,n){var i=this,r=zi.MIN,o=Vs();return this.persistence.runTransaction("Execute query","readonly",function(e){return i.Vo(e,t.qe()).next(function(t){if(t)return r=t.lastLimboFreeSnapshotVersion,i.Lh.So(e,t.targetId).next(function(t){o=t})}).next(function(){return i.yh.rr(e,t,n?r:zi.MIN,n?o:Vs())}).next(function(t){return{documents:t,Do:o}})})},na.prototype.Co=function(e){var n=this;return this.persistence.runTransaction("Remote document keys","readonly",function(t){return n.Lh.So(t,e)})},na.prototype.Jh=function(t,r,o){var e=this,s=r.batch,n=s.keys(),u=ku.resolve();return n.forEach(function(i){u=u.next(function(){return o.tr(t,i)}).next(function(t){var e=t,n=r.pn.get(i);gu(null!==n),(!e||e.version.D(n)<0)&&(e=s.xt(i,e,r))&&o.do(e,r.Vn)})}),u.next(function(){return e.zn.so(t,s)})},na.prototype.Fo=function(e){var n=this;return this.persistence.runTransaction("Collect garbage","readwrite-primary",function(t){return e.No(t,n.vh)})},na);function na(t,e,n){this.persistence=t,this.yh=e,this.bh=new Su,this.vh=new hr(bu),this.Sh=new Nu(function(t){return t.canonicalId()}),this.Dh=zi.MIN,this.persistence.Fh.Ch(this.bh),this.zn=t.Nh(n),this.$h=t.kh(),this.Lh=t.Oh(),this.Mh=new Ou(this.$h,this.zn,this.persistence.qh()),this.yh.Bh(this.Mh)}function ia(){this.index={}}function ra(){this.ph=new ta}function oa(t){this.Ah=t}function sa(e){return c(this,void 0,void 0,function(){return f(this,function(t){if(e.code!==Mi.FAILED_PRECONDITION||"The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab."!==e.message)throw e;return pu("LocalStore","Unexpectedly lost primary lease"),[2]})})}function ua(t,e){if(0!==e.length)throw new xi(Mi.INVALID_ARGUMENT,"Function "+t+"() does not support arguments, but was called with "+Na(e.length,"argument")+".")}function aa(t,e,n){if(e.length!==n)throw new xi(Mi.INVALID_ARGUMENT,"Function "+t+"() requires "+Na(n,"argument")+", but was called with "+Na(e.length,"argument")+".")}function ha(t,e,n){if(e.length<n)throw new xi(Mi.INVALID_ARGUMENT,"Function "+t+"() requires at least "+Na(n,"argument")+", but was called with "+Na(e.length,"argument")+".")}function ca(t,e,n,i){if(e.length<n||e.length>i)throw new xi(Mi.INVALID_ARGUMENT,"Function "+t+"() requires between "+n+" and "+i+" arguments, but was called with "+Na(e.length,"argument")+".")}function fa(t,e,n,i){va(t,e,Ia(n)+" argument",i)}function la(t,e,n,i){void 0!==i&&fa(t,e,n,i)}function pa(t,e,n,i){va(t,e,n+" option",i)}function da(t,e,n,i){void 0!==i&&pa(t,e,n,i)}function ya(t,e,n,i,a){void 0!==i&&function(t,e,n){for(var i=[],r=0,o=a;r<o.length;r++){var s=o[r];if(s===n)return;i.push(ma(s))}var u=ma(n);throw new xi(Mi.INVALID_ARGUMENT,"Invalid value "+u+" provided to function "+t+'() for option "'+e+'". Acceptable values: '+i.join(", "))}(t,n,i)}function va(t,e,n,i){if(!("object"===e?ga(i):"non-empty string"===e?"string"==typeof i&&""!==i:typeof i===e)){var r=ma(i);throw new xi(Mi.INVALID_ARGUMENT,"Function "+t+"() requires its "+n+" to be of type "+e+", but it was: "+r)}}function ga(t){return"object"==typeof t&&null!==t&&(Object.getPrototypeOf(t)===Object.prototype||null===Object.getPrototypeOf(t))}function ma(e){if(void 0===e)return"undefined";if(null===e)return"null";if("string"==typeof e)return 20<e.length&&(e=e.substring(0,20)+"..."),JSON.stringify(e);if("number"==typeof e||"boolean"==typeof e)return""+e;if("object"!=typeof e)return"function"==typeof e?"a function":vu();if(e instanceof Array)return"an array";var t=function(){if(e.constructor){var t=/function\s+([^\s(]+)\s*\(/.exec(e.constructor.toString());if(t&&1<t.length)return t[1]}return null}();return t?"a custom "+t+" object":"an object"}function wa(t,e,n){if(void 0===n)throw new xi(Mi.INVALID_ARGUMENT,"Function "+t+"() requires a valid "+Ia(e)+" argument, but it was undefined.")}function ba(n,t,i){Er(t,function(t,e){if(i.indexOf(t)<0)throw new xi(Mi.INVALID_ARGUMENT,"Unknown option '"+t+"' passed to function "+n+"(). Available options: "+i.join(", "))})}function Ea(t,e,n,i){var r=ma(i);return new xi(Mi.INVALID_ARGUMENT,"Function "+t+"() requires its "+Ia(n)+" argument to be a "+e+", but it was: "+r)}function Aa(t,e,n){if(n<=0)throw new xi(Mi.INVALID_ARGUMENT,'Function "'+t+'()" requires its '+Ia(e)+" argument to be a positive number, but it was: "+n+".")}function Ia(t){switch(t){case 1:return"first";case 2:return"second";case 3:return"third";default:return t+"th"}}function Na(t,e){return t+" "+e+(1===t?"":"s")}function Ta(t,e){function n(){var t="This constructor is private.";throw e&&(t+=" ",t+=e),new xi(Mi.INVALID_ARGUMENT,t)}return n.prototype=t.prototype,Object.assign(n,t),n}function _a(){if("undefined"==typeof Uint8Array)throw new xi(Mi.UNIMPLEMENTED,"Uint8Arrays are not available in this environment.")}function Sa(){if(!au.Ot().$o)throw new xi(Mi.UNIMPLEMENTED,"Blobs are unavailable in Firestore in this environment.")}ea.Eo=3e8;var Ra=(Da.fromBase64String=function(t){aa("Blob.fromBase64String",arguments,1),fa("Blob.fromBase64String","string",1,t),Sa();try{return new Da(Ir.fromBase64String(t))}catch(t){throw new xi(Mi.INVALID_ARGUMENT,"Failed to construct Blob from Base64 string: "+t)}},Da.fromUint8Array=function(t){if(aa("Blob.fromUint8Array",arguments,1),_a(),!(t instanceof Uint8Array))throw Ea("Blob.fromUint8Array","Uint8Array",1,t);return new Da(Ir.fromUint8Array(t))},Da.prototype.toBase64=function(){return aa("Blob.toBase64",arguments,0),Sa(),this.ko.toBase64()},Da.prototype.toUint8Array=function(){return aa("Blob.toUint8Array",arguments,0),_a(),this.ko.toUint8Array()},Da.prototype.toString=function(){return"Blob(base64: "+this.toBase64()+")"},Da.prototype.isEqual=function(t){return this.ko.isEqual(t.ko)},Da),ka=Ta(Ra,"Use Blob.fromUint8Array() or Blob.fromBase64String() instead."),Oa=(La.documentId=function(){return La.Oo},La.prototype.isEqual=function(t){if(!(t instanceof La))throw Ea("isEqual","FieldPath",1,t);return this.Lo.isEqual(t.Lo)},La);function La(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];!function(){if(!(t instanceof Array)||t.length<1)throw new xi(Mi.INVALID_ARGUMENT,"Function FieldPath() requires its fieldNames argument to be an array with at least 1 element.")}();for(var n=0;n<t.length;++n)if(fa("FieldPath","string",n,t[n]),0===t[n].length)throw new xi(Mi.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this.Lo=new or(t)}function Da(t){Sa(),this.ko=t}Oa.Oo=new Oa(or.J().G());var Va,Ca=new RegExp("[~\\*/\\[\\]]"),Pa=(xa.delete=function(){return ua("FieldValue.delete",arguments),Ua.instance},xa.serverTimestamp=function(){return ua("FieldValue.serverTimestamp",arguments),qa.instance},xa.arrayUnion=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return ha("FieldValue.arrayUnion",arguments,1),new Ha(t)},xa.arrayRemove=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return ha("FieldValue.arrayRemove",arguments,1),new Ya(t)},xa.increment=function(t){return fa("FieldValue.increment","number",1,t),aa("FieldValue.increment",arguments,1),new Qa(t)},xa.prototype.isEqual=function(t){return this===t},xa),Ua=(n(Ma,Va=Pa),Ma);function Ma(){return Va.call(this,"FieldValue.delete")||this}function xa(t){this.Mo=t}Ua.instance=new Ua;var Fa,qa=(n(Ga,Fa=Pa),Ga);function Ga(){return Fa.call(this,"FieldValue.serverTimestamp")||this}qa.instance=new qa;var ja,Ba,za,Ha=(n(rh,za=Pa),rh),Ya=(n(ih,Ba=Pa),ih),Qa=(n(nh,ja=Pa),nh),Wa=Ta(Pa,"Use FieldValue.<field>() instead."),Xa=(Object.defineProperty(eh.prototype,"latitude",{get:function(){return this.xo},enumerable:!0,configurable:!0}),Object.defineProperty(eh.prototype,"longitude",{get:function(){return this.Uo},enumerable:!0,configurable:!0}),eh.prototype.isEqual=function(t){return this.xo===t.xo&&this.Uo===t.Uo},eh.prototype.g=function(t){return bu(this.xo,t.xo)||bu(this.Uo,t.Uo)},eh),Ka=/^__.*__$/,$a=(th.prototype.Qo=function(t,e){var n=[];return null!==this.se?n.push(new yo(t,this.data,this.se,e)):n.push(new po(t,this.data,e)),0<this.fieldTransforms.length&&n.push(new vo(t,this.fieldTransforms)),n},th),Za=(Ja.prototype.Qo=function(t,e){var n=[new yo(t,this.data,this.se,e)];return 0<this.fieldTransforms.length&&n.push(new vo(t,this.fieldTransforms)),n},Ja);function Ja(t,e,n){this.data=t,this.se=e,this.fieldTransforms=n}function th(t,e,n){this.data=t,this.se=e,this.fieldTransforms=n}function eh(t,e){if(aa("GeoPoint",arguments,2),fa("GeoPoint","number",1,t),fa("GeoPoint","number",2,e),!isFinite(t)||t<-90||90<t)throw new xi(Mi.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(e)||e<-180||180<e)throw new xi(Mi.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+e);this.xo=t,this.Uo=e}function nh(t){var e=this;return(e=ja.call(this,"FieldValue.increment")||this).Bo=t,e}function ih(t){var e=this;return(e=Ba.call(this,"FieldValue.arrayRemove")||this).qo=t,e}function rh(t){var e=this;return(e=za.call(this,"FieldValue.arrayUnion")||this).qo=t,e}function oh(t){switch(t){case 0:case 2:case 1:return 1;case 3:case 4:return;default:throw vu()}}var sh=(ch.prototype.Ko=function(t){var e=null==this.path?null:this.path.child(t),n=new ch(this.Wo,this.methodName,e,!1,this.fieldTransforms,this.se);return n.Ho(t),n},ch.prototype.zo=function(t){var e=null==this.path?null:this.path.child(t),n=new ch(this.Wo,this.methodName,e,!1,this.fieldTransforms,this.se);return n.Go(),n},ch.prototype.Yo=function(t){return new ch(this.Wo,this.methodName,null,!0,this.fieldTransforms,this.se)},ch.prototype.Xo=function(t){var e=null===this.path||this.path.B()?"":" (found in field "+this.path.toString()+")";return new xi(Mi.INVALID_ARGUMENT,"Function "+this.methodName+"() called with invalid data. "+t+e)},ch.prototype.contains=function(e){return void 0!==this.se.find(function(t){return e.U(t)})||void 0!==this.fieldTransforms.find(function(t){return e.U(t.field)})},ch.prototype.Go=function(){if(null!==this.path)for(var t=0;t<this.path.length;t++)this.Ho(this.path.get(t))},ch.prototype.Ho=function(t){if(0===t.length)throw this.Xo("Document fields must not be empty");if(oh(this.Wo)&&Ka.test(t))throw this.Xo('Document fields cannot begin and end with "__"')},ch),uh=function(t,e){this.ci=t,this.key=e},ah=(hh.prototype.Zo=function(t,e){var n=new sh(0,t,or.H);lh("Data must be an object, but it was:",n,e);var i=this.ta(e,n);return new $a(new wo(i),null,n.fieldTransforms)},hh.prototype.ea=function(t,e,n){var i=new sh(2,t,or.H);lh("Data must be an object, but it was:",i,e);var r,o,s=this.ta(e,i);if(n){for(var u=new vr(or.$),a=0,h=n;a<h.length;a++){var c=h[a],f=void 0;if(c instanceof Oa)f=c.Lo;else{if("string"!=typeof c)throw vu();f=dh(t,c)}if(!i.contains(f))throw new xi(Mi.INVALID_ARGUMENT,"Field '"+f+"' is specified in your field mask but missing from your input data.");u=u.add(f)}r=eo.Gt(u),o=i.fieldTransforms.filter(function(t){return r.Ht(t.field)})}else r=eo.Kt(i.se),o=i.fieldTransforms;return new $a(new wo(s),r,o)},hh.prototype.sa=function(o,t){var s=this,u=new sh(1,o,or.H);lh("Data must be an object, but it was:",u,t);var a=new vr(or.$),h=wo.le();Er(t,function(t,e){var n=dh(o,t),i=u.zo(n);if((e=s.ia(e,i))instanceof Ua)a=a.add(n);else{var r=s.na(e,i);null!=r&&(a=a.add(n),h.set(n,r))}});var e=eo.Gt(a);return new Za(h.he(),e,u.fieldTransforms)},hh.prototype.ra=function(t,e,n,i){var r=new sh(1,t,or.H),o=[ph(t,e)],s=[n];if(i.length%2!=0)throw new xi(Mi.INVALID_ARGUMENT,"Function "+t+"() needs to be called with an even number of arguments that alternate between field names and values.");for(var u=0;u<i.length;u+=2)o.push(ph(t,i[u])),s.push(i[u+1]);for(var a=new vr(or.$),h=wo.le(),c=0;c<o.length;++c){var f=o[c],l=r.zo(f),p=this.ia(s[c],l);if(p instanceof Ua)a=a.add(f);else{var d=this.na(p,l);null!=d&&(a=a.add(f),h.set(f,d))}}var y=eo.Gt(a);return new Za(h.he(),y,r.fieldTransforms)},hh.prototype.ha=function(t,e,n){void 0===n&&(n=!1);var i=new sh(n?4:3,t,or.H);return this.na(e,i)},hh.prototype.ia=function(t,e){try{return this.Jo(t)}catch(t){var n=yh(t);throw e.Xo(n)}},hh.prototype.na=function(t,e){if(fh(t=this.ia(t,e)))return lh("Unsupported field value:",e,t),this.ta(t,e);if(t instanceof Pa)return this.oa(t,e),null;if(e.path&&e.se.push(e.path),t instanceof Array){if(e.jo&&4!==e.Wo)throw e.Xo("Nested arrays are not supported");return this.aa(t,e)}return this.ua(t,e)},hh.prototype.ta=function(t,i){var r=this,o={};return Ar(t)?i.path&&0<i.path.length&&i.se.push(i.path):Er(t,function(t,e){var n=r.na(e,i.Ko(t));null!=n&&(o[t]=n)}),{mapValue:{fields:o}}},hh.prototype.aa=function(t,e){for(var n=[],i=0,r=0,o=t;r<o.length;r++){var s=o[r],u=this.na(s,e.Yo(i));null==u&&(u={nullValue:"NULL_VALUE"}),n.push(u),i++}return{arrayValue:{values:n}}},hh.prototype.oa=function(t,e){if(!oh(e.Wo))throw e.Xo(t.Mo+"() can only be used with update() and set()");if(null===e.path)throw e.Xo(t.Mo+"() is not currently supported inside arrays");if(t instanceof Ua){if(2!==e.Wo)throw 1===e.Wo?e.Xo("FieldValue.delete() can only appear at the top level of your update data"):e.Xo("FieldValue.delete() cannot be used with set() unless you pass {merge:true}");e.se.push(e.path)}else if(t instanceof qa)e.fieldTransforms.push(new no(e.path,Hr.instance));else if(t instanceof Ha){var n=this.ca(t.Mo,t.qo),i=new Qr(n);e.fieldTransforms.push(new no(e.path,i))}else if(t instanceof Ya){var r=this.ca(t.Mo,t.qo),o=new Wr(r);e.fieldTransforms.push(new no(e.path,o))}else if(t instanceof Qa){var s=this.ha("FieldValue.increment",t.Bo),u=new Xr(this.serializer,s);e.fieldTransforms.push(new no(e.path,u))}else vu()},hh.prototype.ua=function(t,e){if(null===t)return{nullValue:"NULL_VALUE"};if("number"==typeof t)return this.serializer.wi(t);if("boolean"==typeof t)return{booleanValue:t};if("string"==typeof t)return{stringValue:t};if(t instanceof Date){var n=Bi.fromDate(t);return{timestampValue:this.serializer.F(n)}}if(t instanceof Bi){var i=new Bi(t.seconds,1e3*Math.floor(t.nanoseconds/1e3));return{timestampValue:this.serializer.F(i)}}if(t instanceof Xa)return{geoPointValue:{latitude:t.latitude,longitude:t.longitude}};if(t instanceof Ra)return{bytesValue:this.serializer.Ti(t)};if(t instanceof uh)return{referenceValue:this.serializer.Ii(t.key.path,t.ci)};throw e.Xo("Unsupported field value: "+ma(t))},hh.prototype.ca=function(i,t){var r=this;return t.map(function(t,e){var n=new sh(3,i,or.H);return r.na(t,n.Yo(e))})},hh);function hh(t,e){this.serializer=t,this.Jo=e}function ch(t,e,n,i,r,o){this.Wo=t,this.methodName=e,this.path=n,this.jo=i,void 0===r&&this.Go(),this.jo=void 0!==i&&i,this.fieldTransforms=r||[],this.se=o||[]}function fh(t){return!("object"!=typeof t||null===t||t instanceof Array||t instanceof Date||t instanceof Bi||t instanceof Xa||t instanceof Ra||t instanceof uh||t instanceof Pa)}function lh(t,e,n){if(!fh(n)||!ga(n)){var i=ma(n);throw"an object"===i?e.Xo(t+" a custom object"):e.Xo(t+" "+i)}}function ph(t,e){if(e instanceof Oa)return e.Lo;if("string"==typeof e)return dh(t,e);throw new xi(Mi.INVALID_ARGUMENT,"Function "+t+"() called with invalid data. Field path arguments must be of type string or FieldPath.")}function dh(t,e){try{return function(e){if(0<=e.search(Ca))throw new xi(Mi.INVALID_ARGUMENT,"Invalid field path ("+e+"). Paths must not contain '~', '*', '/', '[', or ']'");try{return new(Oa.bind.apply(Oa,r([void 0],e.split("."))))}catch(t){throw new xi(Mi.INVALID_ARGUMENT,"Invalid field path ("+e+"). Paths must not be empty, begin with '.', end with '.', or contain '..'")}}(e).Lo}catch(e){var n=yh(e);throw new xi(Mi.INVALID_ARGUMENT,"Function "+t+"() called with invalid data. "+n)}}function yh(t){return t instanceof Error?t.message:t.toString()}function vh(t){this.key=t}function gh(t){this.key=t}function mh(t,e,n){this.query=t,this.targetId=e,this.view=n}function wh(t){this.key=t,this.Lc=!1}function bh(){this.fl=null,this.targetId=0,this.dl=[]}var Eh,Ah,Ih,Nh=(ic.prototype.Ta=function(){return 1===this.state||2===this.state||4===this.state},ic.prototype.Ea=function(){return 2===this.state},ic.prototype.start=function(){3!==this.state?this.auth():this.Ia()},ic.prototype.stop=function(){return c(this,void 0,void 0,function(){return f(this,function(t){switch(t.label){case 0:return this.Ta()?[4,this.close(0)]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})},ic.prototype.ma=function(){this.state=0,this.zr.reset()},ic.prototype.Ra=function(){var t=this;this.Ea()&&null===this.wa&&(this.wa=this.Ar.Fr(this.la,6e4,function(){return t.Aa()}))},ic.prototype.Pa=function(t){this.Va(),this.stream.send(t)},ic.prototype.Aa=function(){return c(this,void 0,void 0,function(){return f(this,function(t){return this.Ea()?[2,this.close(0)]:[2]})})},ic.prototype.Va=function(){this.wa&&(this.wa.cancel(),this.wa=null)},ic.prototype.close=function(e,n){return c(this,void 0,void 0,function(){return f(this,function(t){switch(t.label){case 0:return this.Va(),this.zr.cancel(),this.da++,3!==e?this.zr.reset():n&&n.code===Mi.RESOURCE_EXHAUSTED?(du(n.toString()),du("Using maximum backoff delay to prevent overloading the backend."),this.zr.Sr()):n&&n.code===Mi.UNAUTHENTICATED&&this.fa.l(),null!==this.stream&&(this.pa(),this.stream.close(),this.stream=null),this.state=e,[4,this.listener.ga(n)];case 1:return t.sent(),[2]}})})},ic.prototype.pa=function(){},ic.prototype.auth=function(){var n=this;this.state=1;var t=this.ya(this.da),e=this.da;this.fa.getToken().then(function(t){n.da===e&&n.ba(t)},function(e){t(function(){var t=new xi(Mi.UNKNOWN,"Fetching auth token failed: "+e.message);return n.va(t)})})},ic.prototype.ba=function(t){var e=this,n=this.ya(this.da);this.stream=this.Sa(t),this.stream.Da(function(){n(function(){return e.state=2,e.listener.Da()})}),this.stream.ga(function(t){n(function(){return e.va(t)})}),this.stream.onMessage(function(t){n(function(){return e.onMessage(t)})})},ic.prototype.Ia=function(){var t=this;this.state=4,this.zr.Dr(function(){return c(t,void 0,void 0,function(){return f(this,function(t){return this.state=0,this.start(),[2]})})})},ic.prototype.va=function(t){return pu("PersistentStream","close with error: "+t),this.stream=null,this.close(3,t)},ic.prototype.ya=function(e){var n=this;return function(t){n.Ar.xr(function(){return n.da===e?t():(pu("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())})}},ic),Th=(n(nc,Ah=Nh),nc.prototype.Sa=function(t){return this._a.Ca("Listen",t)},nc.prototype.onMessage=function(t){this.zr.reset();var e=this.serializer.Fi(t),n=this.serializer.$i(t);return this.listener.Fa(e,n)},nc.prototype.Na=function(t){var e={};e.database=this.serializer.gi,e.addTarget=this.serializer.qe(t);var n=this.serializer.en(t);n&&(e.labels=n),this.Pa(e)},nc.prototype.$a=function(t){var e={};e.database=this.serializer.gi,e.removeTarget=t,this.Pa(e)},nc),_h=(n(ec,Eh=Nh),Object.defineProperty(ec.prototype,"La",{get:function(){return this.ka},enumerable:!0,configurable:!0}),ec.prototype.start=function(){this.ka=!1,Eh.prototype.start.call(this)},ec.prototype.pa=function(){this.ka&&this.Oa([])},ec.prototype.Sa=function(t){return this._a.Ca("Write",t)},ec.prototype.onMessage=function(t){if(gu(!!t.streamToken),this.lastStreamToken=this.serializer.Ei(t.streamToken),this.ka){this.zr.reset();var e=this.serializer.Wi(t.writeResults,t.commitTime),n=this.serializer.fromVersion(t.commitTime);return this.listener.Ma(n,e)}return gu(!t.writeResults||0===t.writeResults.length),this.ka=!0,this.listener.qa()},ec.prototype.Ba=function(){var t={};t.database=this.serializer.gi,this.Pa(t)},ec.prototype.Oa=function(t){var e=this,n={streamToken:this.serializer.Ti(this.lastStreamToken),writes:t.map(function(t){return e.serializer.ki(t)})};this.Pa(n)},ec),Sh=(tc.prototype.xa=function(t){return new _h(this.Ar,this._a,this.credentials,this.serializer,t)},tc.prototype.Ua=function(t){return new Th(this.Ar,this._a,this.credentials,this.serializer,t)},tc.prototype.commit=function(t){var e=this,n={database:this.serializer.gi,writes:t.map(function(t){return e.serializer.ki(t)})};return this.Qa("Commit",n).then(function(t){return e.serializer.Wi(t.writeResults,t.commitTime)})},tc.prototype.Wa=function(e){var r=this,t={database:this.serializer.gi,documents:e.map(function(t){return r.serializer.Ai(t)})};return this.ja("BatchGetDocuments",t).then(function(t){var n=_s();t.forEach(function(t){var e=r.serializer.Ci(t);n=n.nt(e.key,e)});var i=[];return e.forEach(function(t){var e=n.get(t);gu(!!e),i.push(e)}),i})},tc.prototype.Qa=function(e,n){var i=this;return this.credentials.getToken().then(function(t){return i._a.Qa(e,n,t)}).catch(function(t){throw t.code===Mi.UNAUTHENTICATED&&i.credentials.l(),t})},tc.prototype.ja=function(e,n){var i=this;return this.credentials.getToken().then(function(t){return i._a.ja(e,n,t)}).catch(function(t){throw t.code===Mi.UNAUTHENTICATED&&i.credentials.l(),t})},tc),Rh=(Jh.prototype.Wa=function(i){return c(this,void 0,void 0,function(){var e,n=this;return f(this,function(t){switch(t.label){case 0:if(this.Xa(),0<this.mutations.length)throw new xi(Mi.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes.");return[4,this.Ga.Wa(i)];case 1:return[2,((e=t.sent()).forEach(function(t){t instanceof Vo||t instanceof Do?n.Ja(t):vu()}),e)]}})})},Jh.prototype.set=function(t,e){this.write(e.Qo(t,this.Zt(t))),this.Ya.add(t)},Jh.prototype.update=function(t,e){try{this.write(e.Qo(t,this.Za(t)))}catch(t){this.za=t}this.Ya.add(t)},Jh.prototype.delete=function(t){this.write([new go(t,this.Zt(t))]),this.Ya.add(t)},Jh.prototype.commit=function(){return c(this,void 0,void 0,function(){var e,n=this;return f(this,function(t){switch(t.label){case 0:if(this.Xa(),this.za)throw this.za;return e=this.Ka,this.mutations.forEach(function(t){e=e.remove(t.key)}),e.forEach(function(t,e){n.mutations.push(new mo(t,n.Zt(t)))}),[4,this.Ga.commit(this.mutations)];case 1:return t.sent(),this.Ha=!0,[2]}})})},Jh.prototype.Ja=function(t){var e;if(t instanceof Do)e=t.version;else{if(!(t instanceof Vo))throw vu();e=zi.S()}var n=this.Ka.get(t.key);if(null!==n){if(!e.isEqual(n))throw new xi(Mi.ABORTED,"Document version changed between two reads.")}else this.Ka=this.Ka.nt(t.key,e)},Jh.prototype.Zt=function(t){var e=this.Ka.get(t);return!this.Ya.has(t)&&e?io.updateTime(e):io.NONE},Jh.prototype.Za=function(t){var e=this.Ka.get(t);if(this.Ya.has(t)||!e)return io.exists(!0);if(e.isEqual(zi.S()))throw new xi(Mi.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return io.updateTime(e)},Jh.prototype.write=function(t){this.Xa(),this.mutations=this.mutations.concat(t)},Jh.prototype.Xa=function(){},Jh),kh=(Zh.prototype.nu=function(){var t=this;0===this.eu&&(this.ru("Unknown"),this.su=this.Nr.Fr("online_state_timeout",1e4,function(){return t.su=null,t.hu("Backend didn't respond within 10 seconds."),t.ru("Offline"),Promise.resolve()}))},Zh.prototype.ou=function(t){"Online"===this.state?this.ru("Unknown"):(this.eu++,1<=this.eu&&(this.au(),this.hu("Connection failed 1 times. Most recent error: "+t.toString()),this.ru("Offline")))},Zh.prototype.set=function(t){this.au(),this.eu=0,"Online"===t&&(this.iu=!1),this.ru(t)},Zh.prototype.ru=function(t){t!==this.state&&(this.state=t,this.tu(t))},Zh.prototype.hu=function(t){var e="Could not reach Cloud Firestore backend. "+t+"\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.";this.iu?(du(e),this.iu=!1):pu("OnlineStateTracker",e)},Zh.prototype.au=function(){null!==this.su&&(this.su.cancel(),this.su=null)},Zh),Oh=($h.prototype.start=function(){return this.enableNetwork()},$h.prototype.enableNetwork=function(){return c(this,void 0,void 0,function(){var e;return f(this,function(t){switch(t.label){case 0:return this.networkEnabled=!0,this.wu()?(e=this.Pu,[4,this.uu.no()]):[3,3];case 1:return e.lastStreamToken=t.sent(),this.yu()?this.bu():this.Eu.set("Unknown"),[4,this.vu()];case 2:t.sent(),t.label=3;case 3:return[2]}})})},$h.prototype.disableNetwork=function(){return c(this,void 0,void 0,function(){return f(this,function(t){switch(t.label){case 0:return this.networkEnabled=!1,[4,this.Su()];case 1:return t.sent(),this.Eu.set("Offline"),[2]}})})},$h.prototype.Su=function(){return c(this,void 0,void 0,function(){return f(this,function(t){switch(t.label){case 0:return[4,this.Pu.stop()];case 1:return t.sent(),[4,this.Iu.stop()];case 2:return t.sent(),0<this.cu.length&&(pu("RemoteStore","Stopping write stream with "+this.cu.length+" pending writes"),this.cu=[]),this.Du(),[2]}})})},$h.prototype.Cu=function(){return c(this,void 0,void 0,function(){return f(this,function(t){switch(t.label){case 0:return pu("RemoteStore","RemoteStore shutting down."),this.networkEnabled=!1,[4,this.Su()];case 1:return t.sent(),this.fu.Cu(),this.Eu.set("Unknown"),[2]}})})},$h.prototype.listen=function(t){this.lu.has(t.targetId)||(this.lu.set(t.targetId,t),this.yu()?this.bu():this.Iu.Ea()&&this.Fu(t))},$h.prototype.Nu=function(t){this.lu.delete(t),this.Iu.Ea()&&this.$u(t),0===this.lu.size&&(this.Iu.Ea()?this.Iu.Ra():this.wu()&&this.Eu.set("Unknown"))},$h.prototype.ui=function(t){return this.lu.get(t)||null},$h.prototype.ai=function(t){return this.ku.ai(t)},$h.prototype.Fu=function(t){this._u.Bs(t.targetId),this.Iu.Na(t)},$h.prototype.$u=function(t){this._u.Bs(t),this.Iu.$a(t)},$h.prototype.bu=function(){this._u=new Hs(this),this.Iu.start(),this.Eu.nu()},$h.prototype.yu=function(){return this.wu()&&!this.Iu.Ta()&&0<this.lu.size},$h.prototype.wu=function(){return this.isPrimary&&this.networkEnabled},$h.prototype.Du=function(){this._u=null},$h.prototype.mu=function(){return c(this,void 0,void 0,function(){var n=this;return f(this,function(t){return this.lu.forEach(function(t,e){n.Fu(t)}),[2]})})},$h.prototype.Ru=function(e){return c(this,void 0,void 0,function(){return f(this,function(t){return this.Du(),this.yu()?(this.Eu.ou(e),this.bu()):this.Eu.set("Unknown"),[2]})})},$h.prototype.Au=function(n,i){return c(this,void 0,void 0,function(){var e;return f(this,function(t){switch(t.label){case 0:return this.Eu.set("Online"),n instanceof xs&&2===n.state&&n.cause?[2,this.Lu(n)]:(n instanceof Us?this._u.Hs(n):n instanceof Ms?this._u.si(n):this._u.Xs(n),i.isEqual(zi.MIN)?[3,4]:[4,this.uu.ho()]);case 1:return e=t.sent(),0<=i.D(e)?[4,this.Ou(i)]:[3,3];case 2:t.sent(),t.label=3;case 3:t.label=4;case 4:return[2]}})})},$h.prototype.Ou=function(i){var r=this,t=this._u.ri(i);return t.ws.forEach(function(t,e){if(0<t.resumeToken.Mt()){var n=r.lu.get(e);n&&r.lu.set(e,n.ss(t.resumeToken,i))}}),t.Ts.forEach(function(t){var e=r.lu.get(t);if(e){r.lu.set(t,e.ss(Ir.qt,e.ts)),r.$u(t);var n=new ws(e.target,t,1,e.sequenceNumber);r.Fu(n)}}),this.ku.oo(t)},$h.prototype.Lu=function(t){var n=this,i=t.cause,r=Promise.resolve();return t.targetIds.forEach(function(e){r=r.then(function(){return c(n,void 0,void 0,function(){return f(this,function(t){return this.lu.has(e)?[2,(this.lu.delete(e),this._u.removeTarget(e),this.ku.Mu(e,i))]:[2]})})})}),r},$h.prototype.vu=function(){return c(this,void 0,void 0,function(){var e,n;return f(this,function(t){switch(t.label){case 0:return this.qu()?(e=0<this.cu.length?this.cu[this.cu.length-1].batchId:-1,[4,this.uu.mo(e)]):[3,5];case 1:return null!==(n=t.sent())?[3,2]:(0===this.cu.length&&this.Pu.Ra(),[3,4]);case 2:return this.Bu(n),[4,this.vu()];case 3:t.sent(),t.label=4;case 4:t.label=5;case 5:return this.xu()&&this.Uu(),[2]}})})},$h.prototype.qu=function(){return this.wu()&&this.cu.length<10},$h.prototype.Qu=function(){return this.cu.length},$h.prototype.Bu=function(t){this.cu.push(t),this.Pu.Ea()&&this.Pu.La&&this.Pu.Oa(t.mutations)},$h.prototype.xu=function(){return this.wu()&&!this.Pu.Ta()&&0<this.cu.length},$h.prototype.Uu=function(){this.Pu.start()},$h.prototype.Vu=function(){return c(this,void 0,void 0,function(){return f(this,function(t){return this.Pu.Ba(),[2]})})},$h.prototype.gu=function(){var i=this;return this.uu.ro(this.Pu.lastStreamToken).then(function(){for(var t=0,e=i.cu;t<e.length;t++){var n=e[t];i.Pu.Oa(n.mutations)}}).catch(sa)},$h.prototype.Ma=function(t,e){var n=this,i=this.cu.shift(),r=_u.from(i,t,e,this.Pu.lastStreamToken);return this.ku.Wu(r).then(function(){return n.vu()})},$h.prototype.pu=function(n){return c(this,void 0,void 0,function(){var e=this;return f(this,function(t){return n&&0<this.cu.length?[2,(this.Pu.La?this.ju(n):this.Gu(n)).then(function(){e.xu()&&e.Uu()})]:[2]})})},$h.prototype.Gu=function(e){return c(this,void 0,void 0,function(){return f(this,function(t){return Is(e.code)?[2,(pu("RemoteStore","RemoteStore error before completed handshake; resetting stream token: ",this.Pu.lastStreamToken),this.Pu.lastStreamToken=Ir.qt,this.uu.ro(Ir.qt).catch(sa))]:[2]})})},$h.prototype.ju=function(r){return c(this,void 0,void 0,function(){var e,n,i=this;return f(this,function(t){return Is(n=r.code)&&n!==Mi.ABORTED?(e=this.cu.shift(),[2,(this.Pu.ma(),this.ku.Ku(e.batchId,r).then(function(){return i.vu()}))]):[2]})})},$h.prototype.Hu=function(){return new Rh(this.Ga)},$h.prototype.Tu=function(){return c(this,void 0,void 0,function(){return f(this,function(t){switch(t.label){case 0:return this.networkEnabled=!1,[4,this.Su()];case 1:return t.sent(),this.Eu.set("Unknown"),[4,this.enableNetwork()];case 2:return t.sent(),[2]}})})},$h.prototype.zu=function(){return c(this,void 0,void 0,function(){return f(this,function(t){switch(t.label){case 0:return this.wu()?(pu("RemoteStore","RemoteStore restarting streams for new credential"),[4,this.Tu()]):[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})},$h.prototype.Yu=function(e){return c(this,void 0,void 0,function(){return f(this,function(t){switch(t.label){case 0:return(this.isPrimary=e)&&this.networkEnabled?[4,this.enableNetwork()]:[3,2];case 1:return t.sent(),[3,5];case 2:return e?[3,4]:[4,this.Su()];case 3:t.sent(),this.Eu.set("Unknown"),t.label=4;case 4:t.label=5;case 5:return[2]}})})},$h),Lh=(Kh.prototype.Xu=function(t){this.activeTargetIds=this.activeTargetIds.add(t)},Kh.prototype.Ju=function(t){this.activeTargetIds=this.activeTargetIds.delete(t)},Kh.prototype.Zu=function(){var t={activeTargetIds:this.activeTargetIds.j(),updateTimeMs:Date.now()};return JSON.stringify(t)},Kh),Dh=(Xh.prototype.sc=function(t){},Xh.prototype.ic=function(t,e,n){},Xh.prototype.nc=function(t){return this.tc.Xu(t),this.ec[t]||"not-current"},Xh.prototype.rc=function(t,e,n){this.ec[t]=e},Xh.prototype.hc=function(t){this.tc.Ju(t)},Xh.prototype.oc=function(t){return this.tc.activeTargetIds.has(t)},Xh.prototype.ac=function(t){delete this.ec[t]},Xh.prototype.uc=function(){return this.tc.activeTargetIds},Xh.prototype.cc=function(t){return this.tc.activeTargetIds.has(t)},Xh.prototype.start=function(){return this.tc=new Lh,Promise.resolve()},Xh.prototype.xh=function(t,e,n){},Xh.prototype.lc=function(t){},Xh.prototype.Cu=function(){},Xh.prototype.mr=function(t){},Xh),Vh=(Object.defineProperty(Wh.prototype,"Tc",{get:function(){return this._c},enumerable:!0,configurable:!0}),Wh.prototype.Ec=function(t,e){var u=this,a=e?e.Ic:new qs,h=e?e.wc:this.wc,c=e?e.ls:this.ls,f=h,l=!1,p=this.query.je()&&h.size===this.query.limit?h.last():null,d=this.query.Ge()&&h.size===this.query.limit?h.first():null;if(t.ut(function(t,e){var n=h.get(t),i=e instanceof Do?e:null;i=i&&(u.query.matches(i)?i:null);var r=!!n&&u.ls.has(n.key),o=!!i&&(i.te||u.ls.has(i.key)&&i.hasCommittedMutations),s=!1;n&&i?n.data().isEqual(i.data())?r!==o&&(a.track({type:3,doc:i}),s=!0):u.mc(n,i)||(a.track({type:2,doc:i}),s=!0,(p&&0<u.query.Be(i,p)||d&&u.query.Be(i,d)<0)&&(l=!0)):!n&&i?(a.track({type:0,doc:i}),s=!0):n&&!i&&(a.track({type:1,doc:n}),s=!0,(p||d)&&(l=!0)),s&&(c=i?(f=f.add(i),o?c.add(t):c.delete(t)):(f=f.delete(t),c.delete(t)))}),this.query.je()||this.query.Ge())for(;f.size>this.query.limit;){var n=this.query.je()?f.last():f.first();f=f.delete(n.key),c=c.delete(n.key),a.track({type:1,doc:n})}return{wc:f,Ic:a,Rc:l,ls:c}},Wh.prototype.mc=function(t,e){return t.te&&e.hasCommittedMutations&&!e.te},Wh.prototype.Ac=function(t,e,n){var o=this,i=this.wc;this.wc=t.wc,this.ls=t.ls;var r=t.Ic.us();r.sort(function(t,e){return i=t.type,r=e.type,n(i)-n(r)||o.query.Be(t.doc,e.doc);function n(t){switch(t){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return vu()}}var i,r}),this.Pc(n);var s=e?this.Vc():[],u=0===this.dc.size&&this.As?1:0,a=u!==this.fc;return this.fc=u,0!==r.length||a?{snapshot:new Gs(this.query,t.wc,i,r,t.ls,0==u,a,!1),pc:s}:{pc:s}},Wh.prototype.gc=function(t){return this.As&&"Offline"===t?(this.As=!1,this.Ac({wc:this.wc,Ic:new qs,ls:this.ls,Rc:!1},!1)):{pc:[]}},Wh.prototype.yc=function(t){return!this._c.has(t)&&!!this.wc.has(t)&&!this.wc.get(t).te},Wh.prototype.Pc=function(t){var e=this;t&&(t.Ps.forEach(function(t){return e._c=e._c.add(t)}),t.Vs.forEach(function(t){}),t.ps.forEach(function(t){return e._c=e._c.delete(t)}),this.As=t.As)},Wh.prototype.Vc=function(){var e=this;if(!this.As)return[];var n=this.dc;this.dc=Vs(),this.wc.forEach(function(t){e.yc(t.key)&&(e.dc=e.dc.add(t.key))});var i=[];return n.forEach(function(t){e.dc.has(t)||i.push(new gh(t))}),this.dc.forEach(function(t){n.has(t)||i.push(new vh(t))}),i},Wh.prototype.bc=function(t){this._c=t.Do,this.dc=Vs();var e=this.Ec(t.documents);return this.Ac(e,!0)},Wh.prototype.vc=function(){return Gs.ds(this.query,this.wc,this.ls,0===this.fc)},Wh),Ch=(Qh.prototype.Cc=function(){this.Fc()},Qh.prototype.Fc=function(){var t=this;this.zr.Dr(function(){return c(t,void 0,void 0,function(){var e,n,i=this;return f(this,function(t){return e=this.Sc.Hu(),(n=this.Nc(e))&&n.then(function(t){i.Nr.xr(function(){return e.commit().then(function(){i.Lr.resolve(t)}).catch(function(t){i.$c(t)})})}).catch(function(t){i.$c(t)}),[2]})})})},Qh.prototype.Nc=function(t){try{var e=this.updateFunction(t);return!Tr(e)&&e.catch&&e.then?e:(this.Lr.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.Lr.reject(t),null}},Qh.prototype.$c=function(t){var e=this;0<this.Dc&&this.kc(t)?(--this.Dc,this.Nr.xr(function(){return e.Fc(),Promise.resolve()})):this.Lr.reject(t)},Qh.prototype.kc=function(t){if("FirebaseError"!==t.name)return!1;var e=t.code;return"aborted"===e||"failed-precondition"===e||!Is(e)},Qh),Ph=(Object.defineProperty(Yh.prototype,"zc",{get:function(){return!0},enumerable:!0,configurable:!0}),Yh.prototype.subscribe=function(t){this.qc=t},Yh.prototype.listen=function(s){return c(this,void 0,void 0,function(){var e,n,i,r,o;return f(this,function(t){switch(t.label){case 0:return this.Yc("listen()"),(i=this.Bc.get(s))?(e=i.targetId,this.Oc.nc(e),n=i.view.vc(),[3,4]):[3,1];case 1:return[4,this.uu.Po(s.qe())];case 2:return r=t.sent(),o=this.Oc.nc(r.targetId),e=r.targetId,[4,this.Xc(s,e,"current"===o)];case 3:n=t.sent(),this.zc&&this.Sc.listen(r),t.label=4;case 4:return[2,(this.qc.Fa([n]),e)]}})})},Yh.prototype.Xc=function(u,a,h){return c(this,void 0,void 0,function(){var e,n,i,r,o,s;return f(this,function(t){switch(t.label){case 0:return[4,this.uu.vo(u,!0)];case 1:return e=t.sent(),n=new Vh(u,e.Do),i=n.Ec(e.documents),r=Bs.Rs(a,h&&"Offline"!==this.onlineState),o=n.Ac(i,this.zc,r),this.Jc(a,o.pc),s=new mh(u,a,n),[2,(this.Bc.set(u,s),this.xc.has(a)?this.xc.get(a).push(u):this.xc.set(a,[u]),o.snapshot)]}})})},Yh.prototype.Nu=function(r){return c(this,void 0,void 0,function(){var e,n,i=this;return f(this,function(t){switch(t.label){case 0:return this.Yc("unlisten()"),e=this.Bc.get(r),1<(n=this.xc.get(e.targetId)).length?[2,(this.xc.set(e.targetId,n.filter(function(t){return!t.isEqual(r)})),void this.Bc.delete(r))]:this.zc?(this.Oc.hc(e.targetId),this.Oc.cc(e.targetId)?[3,2]:[4,this.uu.bo(e.targetId,!1).then(function(){i.Oc.ac(e.targetId),i.Sc.Nu(e.targetId),i.Zc(e.targetId)}).catch(sa)]):[3,3];case 1:t.sent(),t.label=2;case 2:return[3,5];case 3:return this.Zc(e.targetId),[4,this.uu.bo(e.targetId,!0)];case 4:t.sent(),t.label=5;case 5:return[2]}})})},Yh.prototype.write=function(i,r){return c(this,void 0,void 0,function(){var e,n;return f(this,function(t){switch(t.label){case 0:this.Yc("write()"),t.label=1;case 1:return t.trys.push([1,3,,4]),[4,this.uu.Gh(i)];case 2:return e=t.sent(),[3,4];case 3:if("IndexedDbTransactionError"===(n=t.sent()).name)return[2,(du("SyncEngine","Dropping write that cannot be persisted: "+n),void r.reject(new xi(Mi.UNAVAILABLE,"Failed to persist write: "+n)))];throw n;case 4:return this.Oc.sc(e.batchId),this.tl(e.batchId,r),[4,this.el(e.Hh)];case 5:return t.sent(),[4,this.Sc.vu()];case 6:return t.sent(),[2]}})})},Yh.prototype.runTransaction=function(t,e,n){new Ch(t,this.Sc,e,n).Cc()},Yh.prototype.oo=function(n){return c(this,void 0,void 0,function(){var e,i=this;return f(this,function(t){switch(t.label){case 0:this.Yc("applyRemoteEvent()"),t.label=1;case 1:return t.trys.push([1,4,,6]),[4,this.uu.oo(n)];case 2:return e=t.sent(),n.ws.forEach(function(t,e){var n=i.Wc.get(e);n&&(gu(t.Ps.size+t.Vs.size+t.ps.size<=1),0<t.Ps.size?n.Lc=!0:0<t.Vs.size?gu(n.Lc):0<t.ps.size&&(gu(n.Lc),n.Lc=!1))}),[4,this.el(e,n)];case 3:return t.sent(),[3,6];case 4:return[4,sa(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}})})},Yh.prototype.gc=function(i,t){this.Yc("applyOnlineStateChange()");var r=[];this.Bc.forEach(function(t,e){var n=e.view.gc(i);n.snapshot&&r.push(n.snapshot)}),this.qc.sl(i),this.qc.Fa(r),this.onlineState=i},Yh.prototype.Mu=function(u,a){return c(this,void 0,void 0,function(){var e,n,i,r,o,s=this;return f(this,function(t){switch(t.label){case 0:return this.Yc("rejectListens()"),this.Oc.rc(u,"rejected",a),e=this.Wc.get(u),(n=e&&e.key)?(this.Qc=this.Qc.remove(n),this.Wc.delete(u),this.il(),i=(i=new hr(ur.$)).nt(n,new Vo(n,zi.S())),r=Vs().add(n),o=new js(zi.MIN,new Map,new vr(bu),i,r),[2,this.oo(o)]):[4,this.uu.bo(u,!1).then(function(){return s.Zc(u,a)}).catch(sa)];case 1:return t.sent(),[2]}})})},Yh.prototype.Wu=function(i){return c(this,void 0,void 0,function(){var e,n;return f(this,function(t){switch(t.label){case 0:this.Yc("applySuccessfulWrite()"),e=i.batch.batchId,this.nl(e,null),this.rl(e),t.label=1;case 1:return t.trys.push([1,4,,6]),[4,this.uu.zh(i)];case 2:return n=t.sent(),this.Oc.ic(e,"acknowledged"),[4,this.el(n)];case 3:return t.sent(),[3,6];case 4:return[4,sa(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}})})},Yh.prototype.Ku=function(n,i){return c(this,void 0,void 0,function(){var e;return f(this,function(t){switch(t.label){case 0:this.Yc("rejectFailedWrite()"),this.nl(n,i),this.rl(n),t.label=1;case 1:return t.trys.push([1,4,,6]),[4,this.uu.to(n)];case 2:return e=t.sent(),this.Oc.ic(n,"rejected",i),[4,this.el(e)];case 3:return t.sent(),[3,6];case 4:return[4,sa(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}})})},Yh.prototype.hl=function(i){return c(this,void 0,void 0,function(){var e,n;return f(this,function(t){switch(t.label){case 0:return this.Sc.wu()||pu("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled."),[4,this.uu.io()];case 1:return-1===(e=t.sent())?[2,void i.resolve()]:((n=this.Kc.get(e)||[]).push(i),this.Kc.set(e,n),[2])}})})},Yh.prototype.rl=function(t){(this.Kc.get(t)||[]).forEach(function(t){t.resolve()}),this.Kc.delete(t)},Yh.prototype.ol=function(e){this.Kc.forEach(function(t){t.forEach(function(t){t.reject(new xi(Mi.CANCELLED,e))})}),this.Kc.clear()},Yh.prototype.tl=function(t,e){var n=this.Gc[this.currentUser.s()];n=(n=n||new hr(bu)).nt(t,e),this.Gc[this.currentUser.s()]=n},Yh.prototype.nl=function(t,e){var n=this.Gc[this.currentUser.s()];if(n){var i=n.get(t);i&&(e?i.reject(e):i.resolve(),n=n.remove(t)),this.Gc[this.currentUser.s()]=n}},Yh.prototype.Zc=function(t,e){var n=this;void 0===e&&(e=null),this.Oc.hc(t);for(var i=0,r=this.xc.get(t);i<r.length;i++){var o=r[i];this.Bc.delete(o),e&&this.qc.al(o,e)}if(this.xc.delete(t),this.zc){var s=this.jc.kn(t);this.jc.Nn(t),s.forEach(function(t){n.jc.Ln(t)||n.ul(t)})}},Yh.prototype.ul=function(t){var e=this.Qc.get(t);null!==e&&(this.Sc.Nu(e),this.Qc=this.Qc.remove(t),this.Wc.delete(e),this.il())},Yh.prototype.Jc=function(t,e){for(var n=0,i=e;n<i.length;n++){var r=i[n];r instanceof vh?(this.jc.vn(r.key,t),this.cl(r)):r instanceof gh?(pu("SyncEngine","Document no longer in limbo: "+r.key),this.jc.Dn(r.key,t),this.jc.Ln(r.key)||this.ul(r.key)):vu()}},Yh.prototype.cl=function(t){var e=t.key;this.Qc.get(e)||(pu("SyncEngine","New document in limbo: "+e),this.Uc.push(e),this.il())},Yh.prototype.il=function(){for(;0<this.Uc.length&&this.Qc.size<this.Mc;){var t=this.Uc.shift(),e=this.Hc.next();this.Wc.set(e,new wh(t)),this.Qc=this.Qc.nt(t,e),this.Sc.listen(new ws(Uo.ve(t.path).qe(),e,2,Du.Rr))}},Yh.prototype.ll=function(){return this.Qc},Yh.prototype._l=function(){return this.Uc},Yh.prototype.el=function(i,a){return c(this,void 0,void 0,function(){var o,s,e,u=this;return f(this,function(t){switch(t.label){case 0:return o=[],s=[],e=[],this.Bc.forEach(function(t,r){e.push(Promise.resolve().then(function(){var n=r.view.Ec(i);return n.Rc?u.uu.vo(r.query,!1).then(function(t){var e=t.documents;return r.view.Ec(e,n)}):n}).then(function(t){var e=a&&a.ws.get(r.targetId),n=r.view.Ac(t,u.zc,e);if(u.Jc(r.targetId,n.pc),n.snapshot){u.zc&&u.Oc.rc(r.targetId,n.snapshot.fromCache?"not-current":"current"),o.push(n.snapshot);var i=Lu.wr(r.targetId,n.snapshot);s.push(i)}}))}),[4,Promise.all(e)];case 1:return t.sent(),this.qc.Fa(o),[4,this.uu.Io(s)];case 2:return t.sent(),[2]}})})},Yh.prototype.Yc=function(t){},Yh.prototype.zu=function(i){return c(this,void 0,void 0,function(){var e,n;return f(this,function(t){switch(t.label){case 0:return e=!this.currentUser.isEqual(i),this.currentUser=i,e?(this.ol("'waitForPendingWrites' promise is rejected due to a user change."),[4,this.uu.xh(i)]):[3,3];case 1:return n=t.sent(),this.Oc.xh(i,n.Wh,n.jh),[4,this.el(n.Qh)];case 2:t.sent(),t.label=3;case 3:return[4,this.Sc.zu()];case 4:return t.sent(),[2]}})})},Yh.prototype.enableNetwork=function(){return this.Sc.enableNetwork()},Yh.prototype.disableNetwork=function(){return this.Sc.disableNetwork()},Yh.prototype.ai=function(t){var e=this.Wc.get(t);if(e&&e.Lc)return Vs().add(e.key);var n=Vs(),i=this.xc.get(t);if(!i)return n;for(var r=0,o=i;r<o.length;r++){var s=o[r],u=this.Bc.get(s);n=n.$t(u.view.Tc)}return n},Yh),Uh=(Hh.prototype.listen=function(t){var e=t.query,n=!1,i=this.wl.get(e);return i||(n=!0,i=new bh,this.wl.set(e,i)),i.dl.push(t),t.gc(this.onlineState),i.fl&&t.El(i.fl)&&this.Il(),n?this.ku.listen(e).then(function(t){return i.targetId=t}):Promise.resolve(i.targetId)},Hh.prototype.Nu=function(o){return c(this,void 0,void 0,function(){var e,n,i,r;return f(this,function(t){return e=o.query,n=!1,(i=this.wl.get(e))&&0<=(r=i.dl.indexOf(o))&&(i.dl.splice(r,1),n=0===i.dl.length),n?[2,(this.wl.delete(e),this.ku.Nu(e))]:[2]})})},Hh.prototype.Fa=function(t){for(var e=!1,n=0,i=t;n<i.length;n++){var r=i[n],o=r.query,s=this.wl.get(o);if(s){for(var u=0,a=s.dl;u<a.length;u++)a[u].El(r)&&(e=!0);s.fl=r}}e&&this.Il()},Hh.prototype.al=function(t,e){var n=this.wl.get(t);if(n)for(var i=0,r=n.dl;i<r.length;i++)r[i].onError(e);this.wl.delete(t)},Hh.prototype.sl=function(r){this.onlineState=r;var o=!1;this.wl.forEach(function(t,e){for(var n=0,i=e.dl;n<i.length;n++)i[n].gc(r)&&(o=!0)}),o&&this.Il()},Hh.prototype.ml=function(t){this.Tl.add(t),t.next()},Hh.prototype.Rl=function(t){this.Tl.delete(t)},Hh.prototype.Il=function(){this.Tl.forEach(function(t){t.next()})},Hh),Mh=(zh.prototype.El=function(t){if(!this.options.includeMetadataChanges){for(var e=[],n=0,i=t.docChanges;n<i.length;n++){var r=i[n];3!==r.type&&e.push(r)}t=new Gs(t.query,t.docs,t.cs,e,t.ls,t.fromCache,t._s,!0)}var o=!1;return this.Pl?this.pl(t)&&(this.Al.next(t),o=!0):this.gl(t,this.onlineState)&&(this.yl(t),o=!0),this.Vl=t,o},zh.prototype.onError=function(t){this.Al.error(t)},zh.prototype.gc=function(t){this.onlineState=t;var e=!1;return this.Vl&&!this.Pl&&this.gl(this.Vl,t)&&(this.yl(this.Vl),e=!0),e},zh.prototype.gl=function(t,e){if(!t.fromCache)return!0;var n="Offline"!==e;return!(this.options.bl&&n||t.docs.B()&&"Offline"!==e)},zh.prototype.pl=function(t){if(0<t.docChanges.length)return!0;var e=this.Vl&&this.Vl.hasPendingWrites!==t.hasPendingWrites;return!(!t._s&&!e)&&!0===this.options.includeMetadataChanges},zh.prototype.yl=function(t){t=Gs.ds(t.query,t.docs,t.ls,t.fromCache),this.Pl=!0,this.Al.next(t)},zh),xh=(Bh.prototype.Bh=function(t){this.vl=t},Bh.prototype.rr=function(e,i,r,o){var s=this;return i.Me()||r.isEqual(zi.MIN)?this.Sl(e,i):this.vl.sr(e,o).next(function(t){var n=s.Dl(i,t);return(i.je()||i.Ge())&&s.Rc(i.pe,n,o,r)?s.Sl(e,i):(fu()<=u.DEBUG&&pu("IndexFreeQueryEngine","Re-using previous result from %s to execute query: %s",r.toString(),i.toString()),s.vl.rr(e,i,r).next(function(e){return n.forEach(function(t){e=e.nt(t.key,t)}),e}))})},Bh.prototype.Dl=function(n,t){var i=new vr(function(t,e){return n.Be(t,e)});return t.forEach(function(t,e){e instanceof Do&&n.matches(e)&&(i=i.add(e))}),i},Bh.prototype.Rc=function(t,e,n,i){if(n.size!==e.size)return!0;var r="F"===t?e.last():e.first();return!!r&&(r.hasPendingWrites||0<r.version.D(i))},Bh.prototype.Sl=function(t,e){return fu()<=u.DEBUG&&pu("IndexFreeQueryEngine","Using full collection scan to execute query: %s",e.toString()),this.vl.rr(t,e,zi.MIN)},Bh),Fh=(jh.prototype.Nl=function(t){return ku.resolve(0===this.zn.length)},jh.prototype.zh=function(t,e,n){var i=e.batchId,r=this.$l(i,"acknowledged");return gu(0===r),this.zn[r],this.lastStreamToken=n,ku.resolve()},jh.prototype.no=function(t){return ku.resolve(this.lastStreamToken)},jh.prototype.ro=function(t,e){return this.lastStreamToken=e,ku.resolve()},jh.prototype.Kh=function(t,e,n,i){var r=this.Cl;this.Cl++,0<this.zn.length&&this.zn[this.zn.length-1];var o=new Tu(r,e,n,i);this.zn.push(o);for(var s=0,u=i;s<u.length;s++){var a=u[s];this.Fl=this.Fl.add(new Ru(a.key,r)),this.Yn.gh(t,a.key.path.O())}return ku.resolve(o)},jh.prototype.eo=function(t,e){return ku.resolve(this.kl(e))},jh.prototype.Ro=function(t,e){var n=e+1,i=this.Ll(n),r=i<0?0:i;return ku.resolve(this.zn.length>r?this.zn[r]:null)},jh.prototype.io=function(){return ku.resolve(0===this.zn.length?-1:this.Cl-1)},jh.prototype.Uh=function(t){return ku.resolve(this.zn.slice())},jh.prototype.Jn=function(t,e){var n=this,i=new Ru(e,0),r=new Ru(e,Number.POSITIVE_INFINITY),o=[];return this.Fl.Ct([i,r],function(t){var e=n.kl(t.On);o.push(e)}),ku.resolve(o)},jh.prototype.nr=function(t,e){var i=this,r=new vr(bu);return e.forEach(function(t){var e=new Ru(t,0),n=new Ru(t,Number.POSITIVE_INFINITY);i.Fl.Ct([e,n],function(t){r=r.add(t.On)})}),ku.resolve(this.Ol(r))},jh.prototype.cr=function(t,e){var n=e.path,i=n.length+1,r=n;ur.st(r)||(r=r.child(""));var o=new Ru(new ur(r),0),s=new vr(bu);return this.Fl.Ft(function(t){var e=t.key.path;return!!n.U(e)&&(e.length===i&&(s=s.add(t.On)),!0)},o),ku.resolve(this.Ol(s))},jh.prototype.Ol=function(t){var n=this,i=[];return t.forEach(function(t){var e=n.kl(t);null!==e&&i.push(e)}),i},jh.prototype.so=function(n,i){var r=this;gu(0===this.$l(i.batchId,"removed")),this.zn.shift();var o=this.Fl;return ku.forEach(i.mutations,function(t){var e=new Ru(t.key,i.batchId);return o=o.delete(e),r.Fh.Ml(n,t.key)}).next(function(){r.Fl=o})},jh.prototype.ql=function(t){},jh.prototype.Ln=function(t,e){var n=new Ru(e,0),i=this.Fl.Nt(n);return ku.resolve(e.isEqual(i&&i.key))},jh.prototype.Zh=function(t){return this.zn.length,ku.resolve()},jh.prototype.$l=function(t,e){return this.Ll(t)},jh.prototype.Ll=function(t){return 0===this.zn.length?0:t-this.zn[0].batchId},jh.prototype.kl=function(t){var e=this.Ll(t);return e<0||e>=this.zn.length?null:this.zn[e]},jh),qh=(Gh.prototype.do=function(t,e,n){var i=e.key,r=this.docs.get(i),o=r?r.size:0,s=this.Bl(e);return this.docs=this.docs.nt(i,{xl:e,size:s,readTime:n}),this.size+=s-o,this.Yn.gh(t,i.path.O())},Gh.prototype.fo=function(t){var e=this.docs.get(t);e&&(this.docs=this.docs.remove(t),this.size-=e.size)},Gh.prototype.tr=function(t,e){var n=this.docs.get(e);return ku.resolve(n?n.xl:null)},Gh.prototype.getEntries=function(t,e){var n=this,i=Ss();return e.forEach(function(t){var e=n.docs.get(t);i=i.nt(t,e?e.xl:null)}),ku.resolve(i)},Gh.prototype.rr=function(t,e,n){for(var i=ks(),r=new ur(e.path.child("")),o=this.docs._t(r);o.It();){var s=o.Et(),u=s.key,a=s.value,h=a.xl,c=a.readTime;if(!e.path.U(u.path))break;c.D(n)<=0||h instanceof Do&&e.matches(h)&&(i=i.nt(h.key,h))}return ku.resolve(i)},Gh.prototype.Ul=function(t,e){return ku.forEach(this.docs,function(t){return e(t)})},Gh.prototype.Yh=function(t){return new Gh.Ql(this)},Gh.prototype.Wl=function(t){return ku.resolve(this.size)},Gh);function Gh(t,e){this.Yn=t,this.Bl=e,this.docs=new hr(ur.$),this.size=0}function jh(t,e){this.Yn=t,this.Fh=e,this.zn=[],this.Cl=1,this.lastStreamToken=Ir.qt,this.Fl=new vr(Ru.Ee)}function Bh(){}function zh(t,e,n){this.query=t,this.Al=e,this.Pl=!1,this.Vl=null,this.onlineState="Unknown",this.options=n||{}}function Hh(t){this.ku=t,this.wl=new Nu(function(t){return t.canonicalId()}),this.onlineState="Unknown",this.Tl=new Set,this.ku.subscribe(this)}function Yh(t,e,n,i,r){this.uu=t,this.Sc=e,this.Oc=n,this.currentUser=i,this.Mc=r,this.qc=null,this.Bc=new Nu(function(t){return t.canonicalId()}),this.xc=new Map,this.Uc=[],this.Qc=new hr(ur.$),this.Wc=new Map,this.jc=new Su,this.Gc={},this.Kc=new Map,this.Hc=Zu.Vh(),this.onlineState="Unknown"}function Qh(t,e,n,i){this.Nr=t,this.Sc=e,this.updateFunction=n,this.Lr=i,this.Dc=5,this.zr=new zu(this.Nr,"transaction_retry")}function Wh(t,e){this.query=t,this._c=e,this.fc=null,this.As=!1,this.dc=Vs(),this.ls=Vs(),this.wc=new Fs(t.Be.bind(t))}function Xh(){this.tc=new Lh,this.ec={},this.ku=null,this.tu=null,this.Tr=null}function Kh(){this.activeTargetIds=Ps()}function $h(t,e,n,i,r){var o=this;this.uu=t,this.Ga=e,this.cu=[],this.lu=new Map,this._u=null,this.networkEnabled=!1,this.isPrimary=!1,this.fu=r,this.fu.du(function(t){n.xr(function(){return c(o,void 0,void 0,function(){return f(this,function(t){switch(t.label){case 0:return this.wu()?(pu("RemoteStore","Restarting streams for network reachability change."),[4,this.Tu()]):[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})})}),this.Eu=new kh(n,i),this.Iu=this.Ga.Ua({Da:this.mu.bind(this),ga:this.Ru.bind(this),Fa:this.Au.bind(this)}),this.Pu=this.Ga.xa({Da:this.Vu.bind(this),ga:this.pu.bind(this),qa:this.gu.bind(this),Ma:this.Ma.bind(this)})}function Zh(t,e){this.Nr=t,this.tu=e,this.state="Unknown",this.eu=0,this.su=null,this.iu=!0}function Jh(t){this.Ga=t,this.Ka=Ls(),this.mutations=[],this.Ha=!1,this.za=null,this.Ya=new Set}function tc(t,e,n,i){this.Ar=t,this._a=e,this.credentials=n,this.serializer=i}function ec(t,e,n,i,r){var o=this;return(o=Eh.call(this,t,"write_stream_connection_backoff","write_stream_idle",e,n,r)||this).serializer=i,o.ka=!1,o.lastStreamToken=Ir.qt,o}function nc(t,e,n,i,r){var o=this;return(o=Ah.call(this,t,"listen_stream_connection_backoff","listen_stream_idle",e,n,r)||this).serializer=i,o}function ic(t,e,n,i,r,o){this.Ar=t,this.la=n,this._a=i,this.fa=r,this.listener=o,this.state=0,this.da=0,this.wa=null,this.stream=null,this.zr=new zu(t,e)}function rc(t){var e=this;return(e=Ih.call(this)||this).Yl=t,e}function oc(){this.Hh=new Nu(function(t){return t.toString()}),this.jl=!1}qh.Ql=(Object.defineProperty(oc.prototype,"readTime",{get:function(){return this.Gl},set:function(t){this.Gl=t},enumerable:!0,configurable:!0}),oc.prototype.do=function(t,e){this.Kl(),this.readTime=e,this.Hh.set(t.key,t)},oc.prototype.fo=function(t,e){this.Kl(),e&&(this.readTime=e),this.Hh.set(t,null)},oc.prototype.tr=function(t,e){this.Kl();var n=this.Hh.get(e);return void 0!==n?ku.resolve(n):this.Hl(t,e)},oc.prototype.getEntries=function(t,e){return this.zl(t,e)},oc.prototype.apply=function(t){return this.Kl(),this.jl=!0,this.Ac(t)},oc.prototype.Kl=function(){},n(rc,Ih=oc),rc.prototype.Ac=function(n){var i=this,r=[];return this.Hh.forEach(function(t,e){e?r.push(i.Yl.do(n,e,i.readTime)):i.Yl.fo(t)}),ku.Gn(r)},rc.prototype.Hl=function(t,e){return this.Yl.tr(t,e)},rc.prototype.zl=function(t,e){return this.Yl.getEntries(t,e)},rc);var sc,uc=(Ec.prototype.Js=function(t,n){return this.Xl.forEach(function(t,e){return n(e)}),ku.resolve()},Ec.prototype.ho=function(t){return ku.resolve(this.lastRemoteSnapshotVersion)},Ec.prototype.e_=function(t){return ku.resolve(this.Jl)},Ec.prototype.po=function(t){return this.highestTargetId=this.t_.next(),ku.resolve(this.highestTargetId)},Ec.prototype.To=function(t,e,n){return n&&(this.lastRemoteSnapshotVersion=n),e>this.Jl&&(this.Jl=e),ku.resolve()},Ec.prototype.s_=function(t){this.Xl.set(t.target,t);var e=t.targetId;e>this.highestTargetId&&(this.t_=new Zu(e),this.highestTargetId=e),t.sequenceNumber>this.Jl&&(this.Jl=t.sequenceNumber)},Ec.prototype.yo=function(t,e){return this.s_(e),this.targetCount+=1,ku.resolve()},Ec.prototype._o=function(t,e){return this.s_(e),ku.resolve()},Ec.prototype.i_=function(t,e){return this.Xl.delete(e.target),this.Zl.Nn(e.targetId),--this.targetCount,ku.resolve()},Ec.prototype.n_=function(n,i,r){var o=this,s=0,u=[];return this.Xl.forEach(function(t,e){e.sequenceNumber<=i&&null===r.get(e.targetId)&&(o.Xl.delete(t),u.push(o.r_(n,e.targetId)),s++)}),ku.Gn(u).next(function(){return s})},Ec.prototype.h_=function(t){return ku.resolve(this.targetCount)},Ec.prototype.Vo=function(t,e){var n=this.Xl.get(e)||null;return ku.resolve(n)},Ec.prototype.uo=function(e,t,n){this.Zl.Sn(t,n);var i=this.persistence.Fh,r=[];return i&&t.forEach(function(t){r.push(i.vn(e,t))}),ku.Gn(r)},Ec.prototype.ao=function(e,t,n){this.Zl.Fn(t,n);var i=this.persistence.Fh,r=[];return i&&t.forEach(function(t){r.push(i.Dn(e,t))}),ku.Gn(r)},Ec.prototype.r_=function(t,e){return this.Zl.Nn(e),ku.resolve()},Ec.prototype.So=function(t,e){var n=this.Zl.kn(e);return ku.resolve(n)},Ec.prototype.Ln=function(t,e){return ku.resolve(this.Zl.Ln(e))},Ec),ac=(bc.prototype.start=function(){return Promise.resolve()},bc.prototype.Cu=function(){return this.u_=!1,Promise.resolve()},Object.defineProperty(bc.prototype,"l_",{get:function(){return this.u_},enumerable:!0,configurable:!0}),bc.prototype.__=function(){},bc.prototype.qh=function(){return this.Yn},bc.prototype.Nh=function(t){var e=this.o_[t.s()];return e||(e=new Fh(this.Yn,this.Fh),this.o_[t.s()]=e),e},bc.prototype.Oh=function(){return this.Lh},bc.prototype.kh=function(){return this.Hn},bc.prototype.runTransaction=function(t,e,n){var i=this;pu("MemoryPersistence","Starting transaction:",t);var r=new hc(this.a_.next());return this.Fh.f_(),n(r).next(function(t){return i.Fh.d_(r).next(function(){return t})}).Wn().then(function(t){return r.w_(),t})},bc.prototype.T_=function(e,n){return ku.Kn(Object.values(this.o_).map(function(t){return function(){return t.Ln(e,n)}}))},bc),hc=(wc.prototype.I_=function(t){this.E_.push(t)},wc.prototype.w_=function(){this.E_.forEach(function(t){return t()})},n(mc,sc=wc),mc),cc=(gc.A_=function(t){return new gc(t)},Object.defineProperty(gc.prototype,"P_",{get:function(){if(this.R_)return this.R_;throw vu()},enumerable:!0,configurable:!0}),gc.prototype.Ch=function(t){this.m_=t},gc.prototype.vn=function(t,e){return this.P_.delete(e),ku.resolve()},gc.prototype.Dn=function(t,e){return this.P_.add(e),ku.resolve()},gc.prototype.Ml=function(t,e){return this.P_.add(e),ku.resolve()},gc.prototype.removeTarget=function(t,e){var n=this,i=this.persistence.Oh();return i.So(t,e.targetId).next(function(t){t.forEach(function(t){return n.P_.add(t)})}).next(function(){return i.i_(t,e)})},gc.prototype.f_=function(){this.R_=new Set},gc.prototype.d_=function(t){var n=this,i=this.persistence.kh().Yh();return ku.forEach(this.P_,function(e){return n.V_(t,e).next(function(t){t||i.fo(e)})}).next(function(){return n.R_=null,i.apply(t)})},gc.prototype.wo=function(t,e){var n=this;return this.V_(t,e).next(function(t){t?n.P_.delete(e):n.P_.add(e)})},gc.prototype.c_=function(t){return 0},gc.prototype.V_=function(t,e){var n=this;return ku.Kn([function(){return n.persistence.Oh().Ln(t,e)},function(){return n.persistence.T_(t,e)},function(){return ku.resolve(n.m_.Ln(e))}])},gc),fc=(vc.prototype.initialize=function(n){return c(this,void 0,void 0,function(){var e=this;return f(this,function(t){switch(t.label){case 0:return this.Oc=this.p_(n),this.persistence=this.g_(n),[4,this.persistence.start()];case 1:return t.sent(),this.y_=this.b_(n),this.uu=this.v_(n),this.Sc=this.S_(n),this.ku=this.D_(n),this.C_=this.F_(n),this.Oc.tu=function(t){return e.ku.gc(t,1)},this.Sc.ku=this.ku,[4,this.uu.start()];case 2:return t.sent(),[4,this.Oc.start()];case 3:return t.sent(),[4,this.Sc.start()];case 4:return t.sent(),[4,this.Sc.Yu(this.ku.zc)];case 5:return t.sent(),[2]}})})},vc.prototype.F_=function(t){return new Uh(this.ku)},vc.prototype.b_=function(t){return null},vc.prototype.v_=function(t){return new ea(this.persistence,new xh,t.N_)},vc.prototype.g_=function(t){return new ac(cc.A_)},vc.prototype.S_=function(t){var e=this;return new Oh(this.uu,t.Ga,t.Nr,function(t){return e.ku.gc(t,0)},t.platform.k_())},vc.prototype.p_=function(t){return new Dh},vc.prototype.D_=function(t){return new Ph(this.uu,this.Sc,this.Oc,t.N_,t.Mc)},vc.prototype.clearPersistence=function(t){throw new xi(Mi.FAILED_PRECONDITION,"You are using the memory-only build of Firestore. Persistence support is only available via the @firebase/firestore bundle or the firebase-firestore.js build.")},vc),lc=(yc.prototype.start=function(e,n){var i=this;this.O_();var r=new Bu,o=new Bu,s=!1;return this.credentials._(function(t){if(!s)return s=!0,pu("FirestoreClient","Initializing. user=",t.uid),i.M_(e,n,t,o).then(r.resolve,r.reject);i.Nr.xr(function(){return i.zu(t)})}),this.Nr.xr(function(){return r.promise}),o.promise},yc.prototype.enableNetwork=function(){var t=this;return this.O_(),this.Nr.enqueue(function(){return t.ku.enableNetwork()})},yc.prototype.M_=function(s,u,a,h){return c(this,void 0,void 0,function(){var e,n,i,r,o=this;return f(this,function(t){switch(t.label){case 0:return t.trys.push([0,3,,4]),[4,this.platform.q_(this.L_)];case 1:return e=t.sent(),n=this.platform.B_(this.L_.ci),i=new Sh(this.Nr,e,this.credentials,n),[4,s.initialize({Nr:this.Nr,L_:this.L_,platform:this.platform,Ga:i,clientId:this.clientId,N_:a,Mc:100,x_:u})];case 2:return t.sent(),this.persistence=s.persistence,this.Oc=s.Oc,this.uu=s.uu,this.Sc=s.Sc,this.ku=s.ku,this.y_=s.y_,this.U_=s.C_,this.persistence.__(function(){return c(o,void 0,void 0,function(){return f(this,function(t){switch(t.label){case 0:return[4,this.terminate()];case 1:return t.sent(),[2]}})})}),h.resolve(),[3,4];case 3:if(r=t.sent(),h.reject(r),!this.Q_(r))throw r;return[2,(console.warn("Error enabling offline persistence. Falling back to persistence disabled: "+r),this.M_(new fc,{W_:!1},a,h))];case 4:return[2]}})})},yc.prototype.Q_=function(t){return"FirebaseError"===t.name?t.code===Mi.FAILED_PRECONDITION||t.code===Mi.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&t instanceof DOMException)||22===t.code||20===t.code||11===t.code},yc.prototype.O_=function(){if(this.Nr.Jr)throw new xi(Mi.FAILED_PRECONDITION,"The client has already been terminated.")},yc.prototype.zu=function(t){return this.Nr.hh(),pu("FirestoreClient","Credential Changed. Current user: "+t.uid),this.ku.zu(t)},yc.prototype.disableNetwork=function(){var t=this;return this.O_(),this.Nr.enqueue(function(){return t.ku.disableNetwork()})},yc.prototype.terminate=function(){var t=this;return this.Nr.ih(function(){return c(t,void 0,void 0,function(){return f(this,function(t){switch(t.label){case 0:return this.y_&&this.y_.stop(),[4,this.Sc.Cu()];case 1:return t.sent(),[4,this.Oc.Cu()];case 2:return t.sent(),[4,this.persistence.Cu()];case 3:return t.sent(),this.credentials.T(),[2]}})})})},yc.prototype.waitForPendingWrites=function(){var t=this;this.O_();var e=new Bu;return this.Nr.xr(function(){return t.ku.hl(e)}),e.promise},yc.prototype.listen=function(t,e,n){var i=this;this.O_();var r=new Mh(t,e,n);return this.Nr.xr(function(){return i.U_.listen(r)}),r},yc.prototype.Nu=function(t){var e=this;this.j_||this.Nr.xr(function(){return e.U_.Nu(t)})},yc.prototype.G_=function(t){var e=this;return this.O_(),this.Nr.enqueue(function(){return e.uu.Ao(t)}).then(function(t){if(t instanceof Do)return t;if(t instanceof Vo)return null;throw new xi(Mi.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)")})},yc.prototype.K_=function(r){var t=this;return this.O_(),this.Nr.enqueue(function(){return c(t,void 0,void 0,function(){var e,n,i;return f(this,function(t){switch(t.label){case 0:return[4,this.uu.vo(r,!0)];case 1:return e=t.sent(),n=new Vh(r,e.Do),i=n.Ec(e.documents),[2,n.Ac(i,!1).snapshot]}})})})},yc.prototype.write=function(t){var e=this;this.O_();var n=new Bu;return this.Nr.xr(function(){return e.ku.write(t,n)}),n.promise},yc.prototype.ci=function(){return this.L_.ci},yc.prototype.ml=function(t){var e=this;this.O_(),this.Nr.xr(function(){return e.U_.ml(t),Promise.resolve()})},yc.prototype.Rl=function(t){this.j_||this.U_.Rl(t)},Object.defineProperty(yc.prototype,"j_",{get:function(){return this.Nr.Jr},enumerable:!0,configurable:!0}),yc.prototype.transaction=function(t){var e=this;this.O_();var n=new Bu;return this.Nr.xr(function(){return e.ku.runTransaction(e.Nr,t,n),Promise.resolve()}),n.promise},yc),pc=(dc.prototype.next=function(t){this.H_(this.observer.next,t)},dc.prototype.error=function(t){this.H_(this.observer.error,t)},dc.prototype.z_=function(){this.muted=!0},dc.prototype.H_=function(t,e){var n=this;this.muted||setTimeout(function(){n.muted||t(e)},0)},dc);function dc(t){this.observer=t,this.muted=!1}function yc(t,e,n,i){this.platform=t,this.L_=e,this.credentials=n,this.Nr=i,this.clientId=mu.Tn()}function vc(){}function gc(t){this.persistence=t,this.m_=null,this.R_=null}function mc(t){var e=this;return(e=sc.call(this)||this).co=t,e}function wc(){this.E_=[]}function bc(t){var e=this;this.o_={},this.a_=new Du(0),this.u_=!1,this.u_=!0,this.Fh=t(this),this.Lh=new uc(this),this.Yn=new Ju,this.Hn=new qh(this.Yn,function(t){return e.Fh.c_(t)})}function Ec(t){this.persistence=t,this.Xl=new Nu(function(t){return t.canonicalId()}),this.lastRemoteSnapshotVersion=zi.MIN,this.highestTargetId=0,this.Jl=0,this.Zl=new Su,this.targetCount=0,this.t_=Zu.Ph()}function Ac(r){return function(){if("object"==typeof r&&null!==r)for(var t=r,e=0,n=["next","error","complete"];e<n.length;e++){var i=n[e];if(i in t&&"function"==typeof t[i])return 1}}()}var Ic,Nc,Tc=(Xc.prototype.X_=function(t){switch(Or(t)){case 0:return null;case 1:return t.booleanValue;case 2:return Mr(t.integerValue||t.doubleValue);case 3:return this.J_(t.timestampValue);case 4:return this.Z_(t);case 5:return t.stringValue;case 6:return new Ra(xr(t.bytesValue));case 7:return this.tf(t.referenceValue);case 8:return new Xa(t.geoPointValue.latitude,t.geoPointValue.longitude);case 9:return this.ef(t.arrayValue);case 10:return this.sf(t.mapValue);default:throw vu()}},Xc.prototype.sf=function(t){var n=this,i={};return Er(t.fields||{},function(t,e){i[t]=n.X_(e)}),i},Xc.prototype.ef=function(t){var e=this;return(t.values||[]).map(function(t){return e.X_(t)})},Xc.prototype.Z_=function(t){switch(this.Y_){case"previous":var e=function t(e){var n=e.mapValue.fields.__previous_value__;return Sr(n)?t(n):n}(t);return null==e?null:this.X_(e);case"estimate":return this.J_(Rr(t));default:return null}},Xc.prototype.J_=function(t){var e=Ur(t),n=new Bi(e.seconds,e.nanos);return this.timestampsInSnapshots?n:n.toDate()},Xc.prototype.tf=function(t){var e=tr.K(t);gu(uu(e));var n=new Iu(e.get(1),e.get(3)),i=new ur(e.L(5));return n.isEqual(this.firestore.if)||du("Document "+i+" contains a document reference within a different database ("+n.projectId+"/"+n.database+") which is not supported. It will be treated as a reference in the current database ("+this.firestore.if.projectId+"/"+this.firestore.if.database+") instead."),new Lc(i,this.firestore,this.converter)},Xc),_c=Qu.Eh,Sc=(Wc.prototype.isEqual=function(t){return this.host===t.host&&this.ssl===t.ssl&&this.timestampsInSnapshots===t.timestampsInSnapshots&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.forceLongPolling===t.forceLongPolling},Wc),Rc=(Qc.prototype.settings=function(t){aa("Firestore.settings",arguments,1),fa("Firestore.settings","object",1,t);var e=new Sc(t);if(this.af&&!this.ff.isEqual(e))throw new xi(Mi.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only call settings() before calling any other methods on a Firestore object.");void 0!==(this.ff=e).credentials&&(this.lf=function(t){if(!t)return new Fi;switch(t.type){case"gapi":var e=t.Tf;return gu(!("object"!=typeof e||null===e||!e.auth||!e.auth.getAuthHeaderValueForFirstParty)),new ji(e,t.V||"0");case"provider":return t.Tf;default:throw new xi(Mi.INVALID_ARGUMENT,"makeCredentialsProvider failed due to invalid credential type")}}(e.credentials))},Qc.prototype.enableNetwork=function(){return this.hf(),this.af.enableNetwork()},Qc.prototype.disableNetwork=function(){return this.hf(),this.af.disableNetwork()},Qc.prototype.enablePersistence=function(t){var e,n;if(this.af)throw new xi(Mi.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only call enablePersistence() before calling any other methods on a Firestore object.");var i=!1;return t&&(void 0!==t.experimentalTabSynchronization&&du("The 'experimentalTabSynchronization' setting will be removed. Use 'synchronizeTabs' instead."),i=null!==(n=null!==(e=t.synchronizeTabs)&&void 0!==e?e:t.experimentalTabSynchronization)&&void 0!==n&&n),this.Ef(this._f,{W_:!0,cacheSizeBytes:this.ff.cacheSizeBytes,synchronizeTabs:i})},Qc.prototype.clearPersistence=function(){return c(this,void 0,void 0,function(){var i,e=this;return f(this,function(t){if(void 0!==this.af&&!this.af.j_)throw new xi(Mi.FAILED_PRECONDITION,"Persistence cannot be cleared after this Firestore instance is initialized.");return i=new Bu,[2,(this.rf.Zr(function(){return c(e,void 0,void 0,function(){var e,n;return f(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),e=this.If(),[4,this._f.clearPersistence(e)];case 1:return t.sent(),i.resolve(),[3,3];case 2:return n=t.sent(),i.reject(n),[3,3];case 3:return[2]}})})}),i.promise)]})})},Qc.prototype.terminate=function(){return this.app._removeServiceInstance("firestore"),this.INTERNAL.delete()},Object.defineProperty(Qc.prototype,"mf",{get:function(){return this.hf(),this.af.j_},enumerable:!0,configurable:!0}),Qc.prototype.waitForPendingWrites=function(){return this.hf(),this.af.waitForPendingWrites()},Qc.prototype.onSnapshotsInSync=function(t){if(this.hf(),Ac(t))return this.Rf(t);fa("Firestore.onSnapshotsInSync","function",1,t);var e={next:t};return this.Rf(e)},Qc.prototype.Rf=function(t){var e=this,n=new pc({next:function(){t.next&&t.next()},error:function(t){throw vu()}});return this.af.ml(n),function(){n.z_(),e.af.Rl(n)}},Qc.prototype.hf=function(){return this.af||this.Ef(new fc,{W_:!1}),this.af},Qc.prototype.If=function(){return new Au(this.if,this.cf,this.ff.host,this.ff.ssl,this.ff.forceLongPolling)},Qc.prototype.Ef=function(t,e){var n=this.If();return this.af=new lc(au.Ot(),n,this.lf,this.rf),this.af.start(t,e)},Qc.prototype.wf=function(i){var t=au.Ot().B_(i);return new ah(t,function(t){if(t instanceof Lc){var e=i,n=t.firestore.if;if(!n.isEqual(e))throw new xi(Mi.INVALID_ARGUMENT,"Document reference is for database "+n.projectId+"/"+n.database+" but should be for database "+e.projectId+"/"+e.database);return new uh(i,t.Af)}return t})},Qc.uf=function(t){if(e=t.options,!Object.prototype.hasOwnProperty.call(e,"projectId"))throw new xi(Mi.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');var e,n=t.options.projectId;if(!n||"string"!=typeof n)throw new xi(Mi.INVALID_ARGUMENT,"projectId must be a string in FirebaseApp.options");return new Iu(n)},Object.defineProperty(Qc.prototype,"app",{get:function(){if(!this.nf)throw new xi(Mi.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this.nf},enumerable:!0,configurable:!0}),Qc.prototype.collection=function(t){return aa("Firestore.collection",arguments,1),fa("Firestore.collection","non-empty string",1,t),this.hf(),new Mc(tr.K(t),this)},Qc.prototype.doc=function(t){return aa("Firestore.doc",arguments,1),fa("Firestore.doc","non-empty string",1,t),this.hf(),Lc.Pf(tr.K(t),this)},Qc.prototype.collectionGroup=function(t){if(aa("Firestore.collectionGroup",arguments,1),fa("Firestore.collectionGroup","non-empty string",1,t),0<=t.indexOf("/"))throw new xi(Mi.INVALID_ARGUMENT,"Invalid collection ID '"+t+"' passed to function Firestore.collectionGroup(). Collection IDs must not contain '/'.");return this.hf(),new Pc(new Uo(tr.H,t),this)},Qc.prototype.runTransaction=function(e){var n=this;return aa("Firestore.runTransaction",arguments,1),fa("Firestore.runTransaction","function",1,e),this.hf().transaction(function(t){return e(new kc(n,t))})},Qc.prototype.batch=function(){return this.hf(),new Oc(this)},Object.defineProperty(Qc,"logLevel",{get:function(){switch(fu()){case u.DEBUG:return"debug";case u.SILENT:return"silent";default:return"error"}},enumerable:!0,configurable:!0}),Qc.setLogLevel=function(t){switch(aa("Firestore.setLogLevel",arguments,1),fa("Firestore.setLogLevel","non-empty string",1,t),t){case"debug":lu(u.DEBUG);break;case"error":lu(u.ERROR);break;case"silent":lu(u.SILENT);break;default:throw new xi(Mi.INVALID_ARGUMENT,"Invalid log level: "+t)}},Qc.prototype.Vf=function(){return this.ff.timestampsInSnapshots},Qc),kc=(Yc.prototype.get=function(t){var n=this;aa("Transaction.get",arguments,1);var i=Jc("Transaction.get",t,this.pf);return this.gf.Wa([i.Af]).then(function(t){if(!t||1!==t.length)return vu();var e=t[0];if(e instanceof Vo)return new Vc(n.pf,i.Af,null,!1,!1,i.yf);if(e instanceof Do)return new Vc(n.pf,i.Af,e,!1,!1,i.yf);throw vu()})},Yc.prototype.set=function(t,e,n){ca("Transaction.set",arguments,2,3);var i=Jc("Transaction.set",t,this.pf);n=Kc("Transaction.set",n);var r=tf(i.yf,e,"Transaction.set"),o=r[0],s=r[1],u=n.merge||n.mergeFields?this.pf.df.ea(s,o,n.mergeFields):this.pf.df.Zo(s,o);return this.gf.set(i.Af,u),this},Yc.prototype.update=function(t,e,n){for(var i,r,o=[],s=3;s<arguments.length;s++)o[s-3]=arguments[s];return r="string"==typeof e||e instanceof Oa?(ha("Transaction.update",arguments,3),i=Jc("Transaction.update",t,this.pf),this.pf.df.ra("Transaction.update",e,n,o)):(aa("Transaction.update",arguments,2),i=Jc("Transaction.update",t,this.pf),this.pf.df.sa("Transaction.update",e)),this.gf.update(i.Af,r),this},Yc.prototype.delete=function(t){aa("Transaction.delete",arguments,1);var e=Jc("Transaction.delete",t,this.pf);return this.gf.delete(e.Af),this},Yc),Oc=(Hc.prototype.set=function(t,e,n){ca("WriteBatch.set",arguments,2,3),this.Sf();var i=Jc("WriteBatch.set",t,this.pf);n=Kc("WriteBatch.set",n);var r=tf(i.yf,e,"WriteBatch.set"),o=r[0],s=r[1],u=n.merge||n.mergeFields?this.pf.df.ea(s,o,n.mergeFields):this.pf.df.Zo(s,o);return this.bf=this.bf.concat(u.Qo(i.Af,io.NONE)),this},Hc.prototype.update=function(t,e,n){for(var i,r,o=[],s=3;s<arguments.length;s++)o[s-3]=arguments[s];return this.Sf(),r="string"==typeof e||e instanceof Oa?(ha("WriteBatch.update",arguments,3),i=Jc("WriteBatch.update",t,this.pf),this.pf.df.ra("WriteBatch.update",e,n,o)):(aa("WriteBatch.update",arguments,2),i=Jc("WriteBatch.update",t,this.pf),this.pf.df.sa("WriteBatch.update",e)),this.bf=this.bf.concat(r.Qo(i.Af,io.exists(!0))),this},Hc.prototype.delete=function(t){aa("WriteBatch.delete",arguments,1),this.Sf();var e=Jc("WriteBatch.delete",t,this.pf);return this.bf=this.bf.concat(new go(e.Af,io.NONE)),this},Hc.prototype.commit=function(){return this.Sf(),this.vf=!0,0<this.bf.length?this.pf.hf().write(this.bf):Promise.resolve()},Hc.prototype.Sf=function(){if(this.vf)throw new xi(Mi.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")},Hc),Lc=(zc.Pf=function(t,e,n){if(t.length%2!=0)throw new xi(Mi.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but "+t.G()+" has "+t.length);return new zc(new ur(t),e,n)},Object.defineProperty(zc.prototype,"id",{get:function(){return this.Af.path.q()},enumerable:!0,configurable:!0}),Object.defineProperty(zc.prototype,"parent",{get:function(){return new Mc(this.Af.path.O(),this.firestore,this.yf)},enumerable:!0,configurable:!0}),Object.defineProperty(zc.prototype,"path",{get:function(){return this.Af.path.G()},enumerable:!0,configurable:!0}),zc.prototype.collection=function(t){if(aa("DocumentReference.collection",arguments,1),fa("DocumentReference.collection","non-empty string",1,t),!t)throw new xi(Mi.INVALID_ARGUMENT,"Must provide a non-empty collection name to collection()");var e=tr.K(t);return new Mc(this.Af.path.child(e),this.firestore)},zc.prototype.isEqual=function(t){if(!(t instanceof zc))throw Ea("isEqual","DocumentReference",1,t);return this.firestore===t.firestore&&this.Af.isEqual(t.Af)&&this.yf===t.yf},zc.prototype.set=function(t,e){ca("DocumentReference.set",arguments,1,2),e=Kc("DocumentReference.set",e);var n=tf(this.yf,t,"DocumentReference.set"),i=n[0],r=n[1],o=e.merge||e.mergeFields?this.firestore.df.ea(r,i,e.mergeFields):this.firestore.df.Zo(r,i);return this.af.write(o.Qo(this.Af,io.NONE))},zc.prototype.update=function(t,e){for(var n,i=[],r=2;r<arguments.length;r++)i[r-2]=arguments[r];return n="string"==typeof t||t instanceof Oa?(ha("DocumentReference.update",arguments,2),this.firestore.df.ra("DocumentReference.update",t,e,i)):(aa("DocumentReference.update",arguments,1),this.firestore.df.sa("DocumentReference.update",t)),this.af.write(n.Qo(this.Af,io.exists(!0)))},zc.prototype.delete=function(){return aa("DocumentReference.delete",arguments,0),this.af.write([new go(this.Af,io.NONE)])},zc.prototype.onSnapshot=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];ca("DocumentReference.onSnapshot",arguments,1,4);var n,i={includeMetadataChanges:!1},r=0;"object"!=typeof t[r]||Ac(t[r])||(ba("DocumentReference.onSnapshot",i=t[r],["includeMetadataChanges"]),da("DocumentReference.onSnapshot","boolean","includeMetadataChanges",i.includeMetadataChanges),r++);var o={includeMetadataChanges:i.includeMetadataChanges};return n=Ac(t[r])?t[r]:(fa("DocumentReference.onSnapshot","function",r,t[r]),la("DocumentReference.onSnapshot","function",r+1,t[r+1]),la("DocumentReference.onSnapshot","function",r+2,t[r+2]),{next:t[r],error:t[r+1],complete:t[r+2]}),this.Df(o,n)},zc.prototype.Df=function(t,n){var i=this,e=function(t){console.error("Uncaught Error in onSnapshot:",t)};n.error&&(e=n.error.bind(n));var r=new pc({next:function(t){if(n.next){var e=t.docs.get(i.Af);n.next(new Vc(i.firestore,i.Af,e,t.fromCache,t.hasPendingWrites,i.yf))}},error:e}),o=this.af.listen(Uo.ve(this.Af.path),r,t);return function(){r.z_(),i.af.Nu(o)}},zc.prototype.get=function(n){var i=this;return ca("DocumentReference.get",arguments,0,1),Zc("DocumentReference.get",n),new Promise(function(e,t){n&&"cache"===n.source?i.firestore.hf().G_(i.Af).then(function(t){e(new Vc(i.firestore,i.Af,t,!0,t instanceof Do&&t.te,i.yf))},t):i.Cf(e,t,n)})},zc.prototype.Cf=function(e,n,i){var r=this.Df({includeMetadataChanges:!0,bl:!0},{next:function(t){r(),!t.exists&&t.metadata.fromCache?n(new xi(Mi.UNAVAILABLE,"Failed to get document because the client is offline.")):t.exists&&t.metadata.fromCache&&i&&"server"===i.source?n(new xi(Mi.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):e(t)},error:n})},zc.prototype.withConverter=function(t){return new zc(this.Af,this.firestore,t)},zc),Dc=(Bc.prototype.isEqual=function(t){return this.hasPendingWrites===t.hasPendingWrites&&this.fromCache===t.fromCache},Bc),Vc=(jc.prototype.data=function(t){if(ca("DocumentSnapshot.data",arguments,0,1),t=$c("DocumentSnapshot.data",t),this.Ff){if(this.yf){var e=new Cc(this.pf,this.Af,this.Ff,this.Nf,this.$f);return this.yf.fromFirestore(e,t)}return new Tc(this.pf,this.pf.Vf(),t.serverTimestamps,void 0).X_(this.Ff.me())}},jc.prototype.get=function(t,e){if(ca("DocumentSnapshot.get",arguments,1,2),e=$c("DocumentSnapshot.get",e),this.Ff){var n=this.Ff.data().field(ph("DocumentSnapshot.get",t));if(null!==n)return new Tc(this.pf,this.pf.Vf(),e.serverTimestamps,this.yf).X_(n)}},Object.defineProperty(jc.prototype,"id",{get:function(){return this.Af.path.q()},enumerable:!0,configurable:!0}),Object.defineProperty(jc.prototype,"ref",{get:function(){return new Lc(this.Af,this.pf,this.yf)},enumerable:!0,configurable:!0}),Object.defineProperty(jc.prototype,"exists",{get:function(){return null!==this.Ff},enumerable:!0,configurable:!0}),Object.defineProperty(jc.prototype,"metadata",{get:function(){return new Dc(this.$f,this.Nf)},enumerable:!0,configurable:!0}),jc.prototype.isEqual=function(t){if(!(t instanceof jc))throw Ea("isEqual","DocumentSnapshot",1,t);return this.pf===t.pf&&this.Nf===t.Nf&&this.Af.isEqual(t.Af)&&(null===this.Ff?null===t.Ff:this.Ff.isEqual(t.Ff))&&this.yf===t.yf},jc),Cc=(n(Gc,Nc=Vc),Gc.prototype.data=function(t){return Nc.prototype.data.call(this,t)},Gc),Pc=(qc.prototype.where=function(t,e,n){var i;aa("Query.where",arguments,3),wa("Query.where",3,n),function(t,e){if(!t.some(function(t){return t===e}))throw new xi(Mi.INVALID_ARGUMENT,"Invalid value "+ma(e)+" provided to function Query.where() for its "+Ia(2)+" argument. Acceptable values: "+t.join(", "))}(["<","<=","==",">=",">","array-contains","in","array-contains-any"],e);var r=ph("Query.where",t),o=Mo.K(e);if(r.X()){if(o===Mo.ARRAY_CONTAINS||o===Mo.ARRAY_CONTAINS_ANY)throw new xi(Mi.INVALID_ARGUMENT,"Invalid Query. You can't perform '"+o.toString()+"' queries on FieldPath.documentId().");if(o===Mo.IN){this.Lf(n,o);for(var s=[],u=0,a=n;u<a.length;u++){var h=a[u];s.push(this.Of(h))}i={arrayValue:{values:s}}}else i=this.Of(n)}else o!==Mo.IN&&o!==Mo.ARRAY_CONTAINS_ANY||this.Lf(n,o),i=this.firestore.df.ha("Query.where",n,o===Mo.IN);var c=Zo.create(r,o,i);return this.Mf(c),new qc(this.kf.Ce(c),this.firestore,this.yf)},qc.prototype.orderBy=function(t,e){var n;if(ca("Query.orderBy",arguments,1,2),la("Query.orderBy","non-empty string",2,e),void 0===e||"asc"===e)n=rs.ASCENDING;else{if("desc"!==e)throw new xi(Mi.INVALID_ARGUMENT,"Function Query.orderBy() has unknown direction '"+e+"', expected 'asc' or 'desc'.");n=rs.DESCENDING}if(null!==this.kf.startAt)throw new xi(Mi.INVALID_ARGUMENT,"Invalid query. You must not call Query.startAt() or Query.startAfter() before calling Query.orderBy().");if(null!==this.kf.endAt)throw new xi(Mi.INVALID_ARGUMENT,"Invalid query. You must not call Query.endAt() or Query.endBefore() before calling Query.orderBy().");var i=ph("Query.orderBy",t),r=new vs(i,n);return this.qf(r),new qc(this.kf.Fe(r),this.firestore,this.yf)},qc.prototype.limit=function(t){return aa("Query.limit",arguments,1),fa("Query.limit","number",1,t),Aa("Query.limit",1,t),new qc(this.kf.Ne(t),this.firestore,this.yf)},qc.prototype.limitToLast=function(t){return aa("Query.limitToLast",arguments,1),fa("Query.limitToLast","number",1,t),Aa("Query.limitToLast",1,t),new qc(this.kf.$e(t),this.firestore,this.yf)},qc.prototype.startAt=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];ha("Query.startAt",arguments,1);var i=this.Bf("Query.startAt",t,e,!0);return new qc(this.kf.ke(i),this.firestore,this.yf)},qc.prototype.startAfter=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];ha("Query.startAfter",arguments,1);var i=this.Bf("Query.startAfter",t,e,!1);return new qc(this.kf.ke(i),this.firestore,this.yf)},qc.prototype.endBefore=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];ha("Query.endBefore",arguments,1);var i=this.Bf("Query.endBefore",t,e,!0);return new qc(this.kf.Le(i),this.firestore,this.yf)},qc.prototype.endAt=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];ha("Query.endAt",arguments,1);var i=this.Bf("Query.endAt",t,e,!1);return new qc(this.kf.Le(i),this.firestore,this.yf)},qc.prototype.isEqual=function(t){if(!(t instanceof qc))throw Ea("isEqual","Query",1,t);return this.firestore===t.firestore&&this.kf.isEqual(t.kf)},qc.prototype.withConverter=function(t){return new qc(this.kf,this.firestore,t)},qc.prototype.Bf=function(t,e,n,i){if(wa(t,1,e),e instanceof Vc){if(0<n.length)throw new xi(Mi.INVALID_ARGUMENT,"Too many arguments provided to "+t+"().");var r=e;if(!r.exists)throw new xi(Mi.NOT_FOUND,"Can't use a DocumentSnapshot that doesn't exist for "+t+"().");return this.xf(r.Ff,i)}var o=[e].concat(n);return this.Uf(t,o,i)},qc.prototype.xf=function(t,e){for(var n=[],i=0,r=this.kf.orderBy;i<r.length;i++){var o=r[i];if(o.field.X())n.push(Fr(this.firestore.if,t.key));else{var s=t.field(o.field);if(Sr(s))throw new xi(Mi.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+o.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(null===s){var u=o.field.G();throw new xi(Mi.INVALID_ARGUMENT,"Invalid query. You are trying to start or end a query using a document for which the field '"+u+"' (used as the orderBy) does not exist.")}n.push(s)}}return new ys(n,e)},qc.prototype.Uf=function(t,e,n){var i=this.kf.Ve;if(e.length>i.length)throw new xi(Mi.INVALID_ARGUMENT,"Too many arguments provided to "+t+"(). The number of arguments must be less than or equal to the number of Query.orderBy() clauses");for(var r=[],o=0;o<e.length;o++){var s=e[o];if(i[o].field.X()){if("string"!=typeof s)throw new xi(Mi.INVALID_ARGUMENT,"Invalid query. Expected a string for document ID in "+t+"(), but got a "+typeof s);if(!this.kf.ze()&&-1!==s.indexOf("/"))throw new xi(Mi.INVALID_ARGUMENT,"Invalid query. When querying a collection and ordering by FieldPath.documentId(), the value passed to "+t+"() must be a plain document ID, but '"+s+"' contains a slash.");var u=this.kf.path.child(tr.K(s));if(!ur.st(u))throw new xi(Mi.INVALID_ARGUMENT,"Invalid query. When querying a collection group and ordering by FieldPath.documentId(), the value passed to "+t+"() must result in a valid document path, but '"+u+"' is not because it contains an odd number of segments.");var a=new ur(u);r.push(Fr(this.firestore.if,a))}else{var h=this.firestore.df.ha(t,s);r.push(h)}}return new ys(r,n)},qc.prototype.onSnapshot=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];ca("Query.onSnapshot",arguments,1,4);var n,i={},r=0;return"object"!=typeof t[r]||Ac(t[r])||(ba("Query.onSnapshot",i=t[r],["includeMetadataChanges"]),da("Query.onSnapshot","boolean","includeMetadataChanges",i.includeMetadataChanges),r++),n=Ac(t[r])?t[r]:(fa("Query.onSnapshot","function",r,t[r]),la("Query.onSnapshot","function",r+1,t[r+1]),la("Query.onSnapshot","function",r+2,t[r+2]),{next:t[r],error:t[r+1],complete:t[r+2]}),this.Qf(this.kf),this.Df(i,n)},qc.prototype.Df=function(t,e){var n=this,i=function(t){console.error("Uncaught Error in onSnapshot:",t)};e.error&&(i=e.error.bind(e));var r=new pc({next:function(t){e.next&&e.next(new Uc(n.firestore,n.kf,t,n.yf))},error:i}),o=this.firestore.hf(),s=o.listen(this.kf,r,t);return function(){r.z_(),o.Nu(s)}},qc.prototype.Qf=function(t){if(t.Ge()&&0===t.Ve.length)throw new xi(Mi.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")},qc.prototype.get=function(n){var i=this;return ca("Query.get",arguments,0,1),Zc("Query.get",n),this.Qf(this.kf),new Promise(function(e,t){n&&"cache"===n.source?i.firestore.hf().K_(i.kf).then(function(t){e(new Uc(i.firestore,i.kf,t,i.yf))},t):i.Cf(e,t,n)})},qc.prototype.Cf=function(e,n,i){var r=this.Df({includeMetadataChanges:!0,bl:!0},{next:function(t){r(),t.metadata.fromCache&&i&&"server"===i.source?n(new xi(Mi.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):e(t)},error:n})},qc.prototype.Of=function(t){if("string"==typeof t){if(""===t)throw new xi(Mi.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid document ID, but it was an empty string.");if(!this.kf.ze()&&-1!==t.indexOf("/"))throw new xi(Mi.INVALID_ARGUMENT,"Invalid query. When querying a collection by FieldPath.documentId(), you must provide a plain document ID, but '"+t+"' contains a '/' character.");var e=this.kf.path.child(tr.K(t));if(!ur.st(e))throw new xi(Mi.INVALID_ARGUMENT,"Invalid query. When querying a collection group by FieldPath.documentId(), the value provided must result in a valid document path, but '"+e+"' is not because it has an odd number of segments ("+e.length+").");return Fr(this.firestore.if,new ur(e))}if(t instanceof Lc){var n=t;return Fr(this.firestore.if,n.Af)}throw new xi(Mi.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid string or a DocumentReference, but it was: "+ma(t)+".")},qc.prototype.Lf=function(t,e){if(!Array.isArray(t)||0===t.length)throw new xi(Mi.INVALID_ARGUMENT,"Invalid Query. A non-empty array is required for '"+e.toString()+"' filters.");if(10<t.length)throw new xi(Mi.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters support a maximum of 10 elements in the value array.");if(0<=t.indexOf(null))throw new xi(Mi.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters cannot contain 'null' in the value array.");if(0<t.filter(function(t){return Number.isNaN(t)}).length)throw new xi(Mi.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters cannot contain 'NaN' in the value array.")},qc.prototype.Mf=function(t){if(t instanceof Zo){var e=[Mo.ARRAY_CONTAINS,Mo.ARRAY_CONTAINS_ANY],n=[Mo.IN,Mo.ARRAY_CONTAINS_ANY],i=0<=e.indexOf(t.op),r=0<=n.indexOf(t.op);if(t.Ke()){var o=this.kf.Se();if(null!==o&&!o.isEqual(t.field))throw new xi(Mi.INVALID_ARGUMENT,"Invalid query. All where filters with an inequality (<, <=, >, or >=) must be on the same field. But you have inequality filters on '"+o.toString()+"' and '"+t.field.toString()+"'");var s=this.kf.De();null!==s&&this.Wf(t.field,s)}else if(r||i){var u=null;if(r&&(u=this.kf.He(n)),null===u&&i&&(u=this.kf.He(e)),null!=u)throw u===t.op?new xi(Mi.INVALID_ARGUMENT,"Invalid query. You cannot use more than one '"+t.op.toString()+"' filter."):new xi(Mi.INVALID_ARGUMENT,"Invalid query. You cannot use '"+t.op.toString()+"' filters with '"+u.toString()+"' filters.")}}},qc.prototype.qf=function(t){if(null===this.kf.De()){var e=this.kf.Se();null!==e&&this.Wf(e,t.field)}},qc.prototype.Wf=function(t,e){if(!e.isEqual(t))throw new xi(Mi.INVALID_ARGUMENT,"Invalid query. You have a where filter with an inequality (<, <=, >, or >=) on field '"+t.toString()+"' and so you must also use '"+t.toString()+"' as your first Query.orderBy(), but your first Query.orderBy() is on field '"+e.toString()+"' instead.")},qc),Uc=(Object.defineProperty(Fc.prototype,"docs",{get:function(){var e=[];return this.forEach(function(t){return e.push(t)}),e},enumerable:!0,configurable:!0}),Object.defineProperty(Fc.prototype,"empty",{get:function(){return this.Gf.docs.B()},enumerable:!0,configurable:!0}),Object.defineProperty(Fc.prototype,"size",{get:function(){return this.Gf.docs.size},enumerable:!0,configurable:!0}),Fc.prototype.forEach=function(e,n){var i=this;ca("QuerySnapshot.forEach",arguments,1,2),fa("QuerySnapshot.forEach","function",1,e),this.Gf.docs.forEach(function(t){e.call(n,i.zf(t))})},Object.defineProperty(Fc.prototype,"query",{get:function(){return new Pc(this.jf,this.pf,this.yf)},enumerable:!0,configurable:!0}),Fc.prototype.docChanges=function(t){t&&(ba("QuerySnapshot.docChanges",t,["includeMetadataChanges"]),da("QuerySnapshot.docChanges","boolean","includeMetadataChanges",t.includeMetadataChanges));var e=!(!t||!t.includeMetadataChanges);if(e&&this.Gf.fs)throw new xi(Mi.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this.Kf&&this.Hf===e||(this.Kf=function(r,e,o,s){if(o.cs.B()){var n=0;return o.docChanges.map(function(t){var e=new Cc(r,t.doc.key,t.doc,o.fromCache,o.ls.has(t.doc.key),s);return t.doc,{type:"added",doc:e,oldIndex:-1,newIndex:n++}})}var u=o.cs;return o.docChanges.filter(function(t){return e||3!==t.type}).map(function(t){var e=new Cc(r,t.doc.key,t.doc,o.fromCache,o.ls.has(t.doc.key),s),n=-1,i=-1;return 0!==t.type&&(n=u.indexOf(t.doc.key),u=u.delete(t.doc.key)),1!==t.type&&(i=(u=u.add(t.doc)).indexOf(t.doc.key)),{type:function(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return vu()}}(t.type),doc:e,oldIndex:n,newIndex:i}})}(this.pf,e,this.Gf,this.yf),this.Hf=e),this.Kf},Fc.prototype.isEqual=function(t){if(!(t instanceof Fc))throw Ea("isEqual","QuerySnapshot",1,t);return this.pf===t.pf&&this.jf.isEqual(t.jf)&&this.Gf.isEqual(t.Gf)&&this.yf===t.yf},Fc.prototype.zf=function(t){return new Cc(this.pf,t.key,t,this.metadata.fromCache,this.Gf.ls.has(t.key),this.yf)},Fc),Mc=(n(xc,Ic=Pc),Object.defineProperty(xc.prototype,"id",{get:function(){return this.kf.path.q()},enumerable:!0,configurable:!0}),Object.defineProperty(xc.prototype,"parent",{get:function(){var t=this.kf.path.O();return t.B()?null:new Lc(new ur(t),this.firestore)},enumerable:!0,configurable:!0}),Object.defineProperty(xc.prototype,"path",{get:function(){return this.kf.path.G()},enumerable:!0,configurable:!0}),xc.prototype.doc=function(t){if(ca("CollectionReference.doc",arguments,0,1),0===arguments.length&&(t=mu.Tn()),fa("CollectionReference.doc","non-empty string",1,t),""===t)throw new xi(Mi.INVALID_ARGUMENT,"Document path must be a non-empty string");var e=tr.K(t);return Lc.Pf(this.kf.path.child(e),this.firestore,this.yf)},xc.prototype.add=function(t){aa("CollectionReference.add",arguments,1),fa("CollectionReference.add","object",1,this.yf?this.yf.toFirestore(t):t);var e=this.doc();return e.set(t).then(function(){return e})},xc.prototype.withConverter=function(t){return new xc(this.Yf,this.firestore,t)},xc);function xc(t,e,n){var i=this;if(((i=Ic.call(this,Uo.ve(t),e,n)||this).Yf=t).length%2!=1)throw new xi(Mi.INVALID_ARGUMENT,"Invalid collection reference. Collection references must have an odd number of segments, but "+t.G()+" has "+t.length);return i}function Fc(t,e,n,i){this.pf=t,this.jf=e,this.Gf=n,this.yf=i,this.Kf=null,this.Hf=null,this.metadata=new Dc(n.hasPendingWrites,n.fromCache)}function qc(t,e,n){this.kf=t,this.firestore=e,this.yf=n}function Gc(){return null!==Nc&&Nc.apply(this,arguments)||this}function jc(t,e,n,i,r,o){this.pf=t,this.Af=e,this.Ff=n,this.Nf=i,this.$f=r,this.yf=o}function Bc(t,e){this.hasPendingWrites=t,this.fromCache=e}function zc(t,e,n){this.Af=t,this.firestore=e,this.yf=n,this.af=this.firestore.hf()}function Hc(t){this.pf=t,this.bf=[],this.vf=!1}function Yc(t,e){this.pf=t,this.gf=e}function Qc(t,e,n){var i=this;if(void 0===n&&(n=new fc),this.nf=null,this.rf=new Yu,this.INTERNAL={delete:function(){return c(i,void 0,void 0,function(){return f(this,function(t){switch(t.label){case 0:return this.hf(),[4,this.af.terminate()];case 1:return t.sent(),[2]}})})}},"object"==typeof t.options){var r=t;this.nf=r,this.if=Qc.uf(r),this.cf=r.name,this.lf=new qi(e)}else{var o=t;if(!o.projectId)throw new xi(Mi.INVALID_ARGUMENT,"Must provide projectId");this.if=new Iu(o.projectId,o.database),this.cf="[DEFAULT]",this.lf=new Fi}this._f=n,this.ff=new Sc({}),this.df=this.wf(this.if)}function Wc(t){var e,n;if(void 0===t.host){if(void 0!==t.ssl)throw new xi(Mi.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else pa("settings","non-empty string","host",t.host),this.host=t.host,da("settings","boolean","ssl",t.ssl),this.ssl=null===(e=t.ssl)||void 0===e||e;if(ba("settings",t,["host","ssl","credentials","timestampsInSnapshots","cacheSizeBytes","experimentalForceLongPolling"]),da("settings","object","credentials",t.credentials),this.credentials=t.credentials,da("settings","boolean","timestampsInSnapshots",t.timestampsInSnapshots),!0===t.timestampsInSnapshots?du("The setting 'timestampsInSnapshots: true' is no longer required and should be removed."):!1===t.timestampsInSnapshots&&du("Support for 'timestampsInSnapshots: false' will be removed soon. You must update your code to handle Timestamp objects."),this.timestampsInSnapshots=null===(n=t.timestampsInSnapshots)||void 0===n||n,da("settings","number","cacheSizeBytes",t.cacheSizeBytes),void 0===t.cacheSizeBytes)this.cacheSizeBytes=Qu.mh;else{if(t.cacheSizeBytes!==_c&&t.cacheSizeBytes<Qu.Ih)throw new xi(Mi.INVALID_ARGUMENT,"cacheSizeBytes must be at least "+Qu.Ih);this.cacheSizeBytes=t.cacheSizeBytes}da("settings","boolean","experimentalForceLongPolling",t.experimentalForceLongPolling),this.forceLongPolling=void 0!==t.experimentalForceLongPolling&&t.experimentalForceLongPolling}function Xc(t,e,n,i){this.firestore=t,this.timestampsInSnapshots=e,this.Y_=n,this.converter=i}function Kc(t,e){if(void 0===e)return{merge:!1};if(ba(t,e,["merge","mergeFields"]),da(t,"boolean","merge",e.merge),n=t,void 0!==(i=e.mergeFields)&&function(t,e,n,i){if(!(n instanceof Array))throw new xi(Mi.INVALID_ARGUMENT,"Function "+t+"() requires its "+e+" option to be an array, but it was: "+ma(n));for(var r=0;r<n.length;++r)if(!i(n[r]))throw new xi(Mi.INVALID_ARGUMENT,"Function "+t+"() requires all "+e+" elements to be a string or a FieldPath, but the value at index "+r+" was: "+ma(n[r]))}(n,"mergeFields",i,function(t){return"string"==typeof t||t instanceof Oa}),void 0!==e.mergeFields&&void 0!==e.merge)throw new xi(Mi.INVALID_ARGUMENT,"Invalid options passed to function "+t+'(): You cannot specify both "merge" and "mergeFields".');var n,i;return e}function $c(t,e){return void 0===e?{}:(ba(t,e,["serverTimestamps"]),ya(t,0,"serverTimestamps",e.serverTimestamps,["estimate","previous","none"]),e)}function Zc(t,e){la(t,"object",1,e),e&&(ba(t,e,["source"]),ya(t,0,"source",e.source,["default","server","cache"]))}function Jc(t,e,n){if(e instanceof Lc){if(e.firestore!==n)throw new xi(Mi.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return e}throw Ea(t,"DocumentReference",1,e)}function tf(t,e,n){var i;return t?(i=t.toFirestore(e),n="toFirestore() in "+n):i=e,[i,n]}var ef,nf=Ta(Rc,"Use firebase.firestore() instead."),rf=Ta(kc,"Use firebase.firestore().runTransaction() instead."),of=Ta(Oc,"Use firebase.firestore().batch() instead."),sf=Ta(Lc,"Use firebase.firestore().doc() instead."),uf=Ta(Vc),af=Ta(Cc),hf=Ta(Pc),cf=Ta(Uc),ff=Ta(Mc,"Use firebase.firestore().collection() instead."),lf={Firestore:nf,GeoPoint:Xa,Timestamp:Bi,Blob:ka,Transaction:rf,WriteBatch:of,DocumentReference:sf,DocumentSnapshot:uf,Query:hf,QueryDocumentSnapshot:af,QuerySnapshot:cf,CollectionReference:ff,FieldPath:Oa,FieldValue:Wa,setLogLevel:Rc.setLogLevel,CACHE_SIZE_UNLIMITED:_c},pf=(Af.prototype.du=function(t){},Af.prototype.Cu=function(){},Af),df=(Ef.prototype.du=function(t){this.ed.push(t)},Ef.prototype.Cu=function(){window.removeEventListener("online",this.Xf),window.removeEventListener("offline",this.Zf)},Ef.prototype.sd=function(){window.addEventListener("online",this.Xf),window.addEventListener("offline",this.Zf)},Ef.prototype.Jf=function(){pu("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(var t=0,e=this.ed;t<e.length;t++)(0,e[t])(0)},Ef.prototype.td=function(){pu("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(var t=0,e=this.ed;t<e.length;t++)(0,e[t])(1)},Ef.nd=function(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener},Ef),yf=(bf.prototype.Da=function(t){this.od=t},bf.prototype.ga=function(t){this.ad=t},bf.prototype.onMessage=function(t){this.ud=t},bf.prototype.close=function(){this.hd()},bf.prototype.send=function(t){this.rd(t)},bf.prototype.ld=function(){this.od()},bf.prototype._d=function(t){this.ad(t)},bf.prototype.fd=function(t){this.ud(t)},bf),vf={BatchGetDocuments:"batchGet",Commit:"commit"},gf="gl-js/ fire/"+Di,mf=(wf.prototype.wd=function(t,e){if(e)for(var n in e.o)e.o.hasOwnProperty(n)&&(t[n]=e.o[n]);t["X-Goog-Api-Client"]=gf},wf.prototype.Qa=function(a,i,r){var h=this,c=this.Td(a);return new Promise(function(o,s){var u=new Li;u.listenOnce(ki.COMPLETE,function(){try{switch(u.getLastErrorCode()){case Ri.NO_ERROR:var t=u.getResponseJson();pu("Connection","XHR received:",JSON.stringify(t)),o(t);break;case Ri.TIMEOUT:pu("Connection",'RPC "'+a+'" timed out'),s(new xi(Mi.DEADLINE_EXCEEDED,"Request time out"));break;case Ri.HTTP_ERROR:var e=u.getStatus();if(pu("Connection",'RPC "'+a+'" failed with status:',e,"response text:",u.getResponseText()),0<e){var n=u.getResponseJson().error;if(n&&n.status&&n.message){var i=(r=n.status.toLowerCase().replace("_","-"),0<=Object.values(Mi).indexOf(r)?r:Mi.UNKNOWN);s(new xi(i,n.message))}else s(new xi(Mi.UNKNOWN,"Server responded with status "+u.getStatus()))}else pu("Connection",'RPC "'+a+'" failed'),s(new xi(Mi.UNAVAILABLE,"Connection failed."));break;default:vu()}}finally{pu("Connection",'RPC "'+a+'" completed.')}var r});var t=Object.assign({},i);delete t.database;var e=JSON.stringify(t);pu("Connection","XHR sending: ",c+" "+e);var n={"Content-Type":"text/plain"};h.wd(n,r),u.send(c,"POST",e,n,15)})},wf.prototype.ja=function(t,e,n){return this.Qa(t,e,n)},wf.prototype.Ca=function(t,e){var n,i,r=[this.dd,"/","google.firestore.v1.Firestore","/",t,"/channel"],o=Si(),s={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:"projects/"+this.ci.projectId+"/databases/"+this.ci.database},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling};this.wd(s.initMessageHeaders,e),"undefined"!=typeof window&&(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(d())||"object"==typeof navigator&&"ReactNative"===navigator.product||0<=d().indexOf("Electron/")||0<=(i=d()).indexOf("MSIE ")||0<=i.indexOf("Trident/")||0<=d().indexOf("MSAppHost/")||"object"==typeof(n="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0)&&void 0!==n.id||(s.httpHeadersOverwriteParam="$httpHeaders");var u=r.join("");function a(t,e){h.listen(t,function(t){try{e(t)}catch(t){setTimeout(function(){throw t},0)}})}pu("Connection","Creating WebChannel: "+u+" "+s);var h=o.createWebChannel(u,s),c=!1,f=!1,l=new yf({rd:function(t){f?pu("Connection","Not sending because WebChannel is closed:",t):(c||(pu("Connection","Opening WebChannel transport."),h.open(),c=!0),pu("Connection","WebChannel sending:",t),h.send(t))},hd:function(){return h.close()}});return a(Oi.EventType.OPEN,function(){f||pu("Connection","WebChannel transport opened.")}),a(Oi.EventType.CLOSE,function(){f||(f=!0,pu("Connection","WebChannel transport closed"),l._d())}),a(Oi.EventType.ERROR,function(t){f||(f=!0,pu("Connection","WebChannel transport errored:",t),l._d(new xi(Mi.UNAVAILABLE,"The operation could not be completed")))}),a(Oi.EventType.MESSAGE,function(t){var e;if(!f){var n=t.data[0];gu(!!n);var i=n.error||(null===(e=n[0])||void 0===e?void 0:e.error);if(i){pu("Connection","WebChannel received error:",i);var r=i.status,o=function(){var t=ps[r];if(void 0!==t)return Ns(t)}(),s=i.message;void 0===o&&(o=Mi.INTERNAL,s="Unknown error status: "+r+" with message "+i.message),f=!0,l._d(new xi(o,s)),h.close()}else pu("Connection","WebChannel received:",n),l.fd(n)}}),setTimeout(function(){l.ld()},0),l},wf.prototype.Td=function(t){var e=vf[t];return this.dd+"/v1/projects/"+this.ci.projectId+"/databases/"+this.ci.database+"/documents:"+e},wf);function wf(t){this.ci=t.ci;var e=t.ssl?"https":"http";this.dd=e+"://"+t.host,this.forceLongPolling=t.forceLongPolling}function bf(t){this.rd=t.rd,this.hd=t.hd}function Ef(){var t=this;this.Xf=function(){return t.Jf()},this.Zf=function(){return t.td()},this.ed=[],this.sd()}function Af(){}function If(){this.$o="undefined"!=typeof atob}au.dn((Object.defineProperty(If.prototype,"document",{get:function(){return"undefined"!=typeof document?document:null},enumerable:!0,configurable:!0}),Object.defineProperty(If.prototype,"window",{get:function(){return"undefined"!=typeof window?window:null},enumerable:!0,configurable:!0}),If.prototype.q_=function(t){return Promise.resolve(new mf(t))},If.prototype.k_=function(){return new(df.nd()?df:pf)},If.prototype.B_=function(t){return new ou(t,{fi:!0})},If.prototype.wn=function(t){return JSON.stringify(t)},If.prototype.atob=function(t){return atob(t)},If.prototype.btoa=function(t){return btoa(t)},new If)),(ef=Nf).INTERNAL.registerComponent(new E("firestore",function(t){return e=t.getProvider("app").getImmediate(),n=t.getProvider("auth-internal"),new Rc(e,n,new fc);var e,n},"PUBLIC").setServiceProps(Object.assign({},lf))),ef.registerVersion("@firebase/firestore","1.14.2")}).apply(this,arguments)}catch(t){throw console.error(t),new Error("Cannot instantiate firebase-firestore.memory.js - be sure to load firebase-app.js first.")}});
//# sourceMappingURL=firebase-firestore.memory.js.map
